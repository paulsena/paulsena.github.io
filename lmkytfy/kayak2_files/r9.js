(function(m){var l="ui-dialog-content",f="ui-dialog-no-title",n="ui-popover-arrow",j="ui-popover",r="ui-popover-left",q="ui-popover-right",g="ui-popover-top",b="ui-popover-bottom-center",a="ui-popover-top-center",d="ui-tooltip",k="ui-tooltip-popover",p=null,c="r9tt-";function o(){if(p!==null){clearInterval(p)}}function h(){p=setTimeout(jq.ui.r9popover.close,200)}m.widget("ui.r9dialog",m.ui.dialog,{options:{autoFocus:true,neverFocus:false,position:["center",100],positionOffsetY:0,modal:true,minHeight:50,resizable:false,width:"auto",showCloseX:true,title:null,hideTitle:false,isFixed:false},_autoFocus:function(){if(!this.options.neverFocus){if(this.options.autoFocus){m.ui.dialog.prototype._autoFocus.call(this)}else{this.uiDialog.focus()}}},_create:function(){m.ui.dialog.prototype._create.apply(this);this.uiDialog.wrapInner('<div class="ui-dialog-liner" />');if(this.options.isFixed){this.uiDialog.css("position","fixed");this._position(this.options.position)}if(this.options.hideTitle){this.uiDialog.addClass(f)}},open:function(){if(this._isOpen){return}m.ui.dialog.prototype.open.apply(this);if(!this.options.showCloseX){this.uiDialog.find(".ui-dialog-titlebar-close").hide()}else{jq(".ui-widget-overlay").click(function(){jq("."+l).r9dialog("close")})}return this}});m.widget("ui.r9popover",m.ui.r9dialog,{options:{at:"auto",draggable:false,position:"body",clazz:"",multiPopovers:false,showCloseX:true},_create:function(){var s={right:q,top:g,"bottom center":b,"top center":a};if(!this.options.multiPopovers){this._destroyAll()}var t=m.ui.dialog.overlay.oldInstances.length;if(t){m.ui.dialog.overlay.oldInstances[t-1].height(m(document).height())}m.ui.r9dialog.prototype._create.apply(this);this.uiDialog.addClass(j).addClass(s[this.options.at]||r);if(this.options.clazz!=""){this.uiDialog.addClass(this.options.clazz)}this.uiPopoverArrow=jq("<div/>",{"class":n}).insertAfter(this.element);if(this.options.title.length===0){this.uiDialogTitlebar.find(".ui-dialog-title").remove()}},_destroyAll:function(){m.ui.r9popover.destroy()},_onOverlayClick:function(){jq("."+l).r9popover("close")},_position:function(s){isVisible=this.uiDialog.is(":visible");if(!isVisible){this.uiDialog.show()}var t=jq.isArray(s);this.uiDialog.css({left:0,top:0}).position({my:((this.options.at=="right")?"right":"left")+" top",at:this._positionAt(),offset:this._positionOffset(),of:t?jq.Event("click",{pageX:s[0],pageY:s[1]}):jq(s||m.ui.r9popover.prototype.options.position),collision:this.options.at=="auto"?"flip":"none"});if(this.options.at=="auto"&&!t&&(jq(s||m.ui.r9popover.prototype.options.position).offset().left>this.uiDialog.offset().left)){this.uiDialog.removeClass(r).addClass(q)}if(!isVisible){this.uiDialog.hide()}},_positionAt:function(){var s=this.options.at;if(s=="bottom center"){return"top center"}else{if(s=="top center"){return"bottom center"}else{if(s=="top"){return"left bottom"}else{return((s=="right")?"left":"right")+" center"}}}},_positionOffset:function(){if(this.options.at=="bottom center"){return"-"+(this.uiDialog.width()/2)+" -"+(this.uiPopoverArrow.height()+this.uiDialog.height()+this.options.positionOffsetY)}if(this.options.at=="top center"){return"-"+(this.uiDialog.width()/2)+" "+(this.uiPopoverArrow.height()+this.options.positionOffsetY)}else{if(this.options.at=="top"){return"-"+(this.uiPopoverArrow.width()/2)+" "+this.uiPopoverArrow.height()}else{return(this.options.at=="right"?"-":"")+this.uiPopoverArrow.width()+" -"+(this.uiPopoverArrow.height()/2+this.uiPopoverArrow.position().top)}}},open:function(){if(this._isOpen){return}m.ui.dialog.prototype.open.apply(this);this.element.show();if(!this.options.showCloseX){this.uiDialog.find(".ui-dialog-titlebar-close").hide()}if(this.options.modal){jq(".ui-widget-overlay").addClass("ui-popover-overlay").click(this._onOverlayClick)}return this}});m.widget("ui.r9tooltip",{timer:null,_create:function(){var s=this;this.element.hover(function(){o();var t={modal:false,position:s.element,clazz:k,width:s.options.width,hideTitle:s.options.hideTitle,at:s.options.at,showCloseX:s.options.showCloseX};var u=jq("#"+c+s.options.ttid);var v=s.options.content;if(v.length==0&&s.options.textAttribute.length>0){v=s.element.attr(s.options.textAttribute).split("|")[1]}if(s.options.ttid.length>0&&u.size()>0){if(u.hasClass(j)){u.r9popover("open")}else{u.r9popover(t);u.show();u.parent().parent().hover(o,h)}}else{var w=s.options.title;if(w.length==0&&s.options.textAttribute.length>0){w=s.element.attr(s.options.textAttribute).split("|")[0]}var x={title:w,width:s.options.width};if(s.options.ttid.length>0){x.id=c+s.options.ttid}jq("<div/>",x).append(v).addClass(s.options.ttclass).appendTo("body").r9popover(t).parent().parent().hover(o,h)}s.options.callback()},h)},options:{title:"",textAttribute:"",content:"",ttclass:"",ttid:"",width:"auto",hideTitle:false,at:"auto",showCloseX:true,callback:function(){}}});m.ui.r9popover.destroy=function(){m.ui.r9popover.get().r9popover("destroy")};m.ui.r9popover.get=function(){return m("."+j).find("."+l)};m.ui.r9tooltip.destroy=function(){m("."+k).find("."+l).r9popover("destroy")};m.ui.r9popover.close=function(){m.ui.r9popover.get().r9popover("close")};m.widget("ui.r9LinkedInput",{options:{linkclass:"",linktooltip:"",selectOnOpen:false,click:m.noop,change:m.noop,autoSize:true},_create:function(){if(this.element.prop("tagName")=="SELECT"||this.element.prop("tagName")=="INPUT"){var s=this;var t=this.link=jq("<a id='"+this.element.attr("id")+"-link' title='"+this.options.linktooltip+"' class='actionlink linkFromInput "+((this.element.prop("tagName")=="SELECT")?"selectLinkFromInput ":"")+this.options.linkclass+"' href='javascript:void(0)'>"+jq("<div/>").text(this.getText()).html()+"</a>").insertAfter(this.element.hide());t.bind("click",function(u){if(s.options.autoSize){s.element.width(jq(this).outerWidth())}t.hide();s.element.show();if(s.options.selectOnOpen){s.element.select()}s.options.click()});this.element.bind("change blur",function(v){var u=true;if(s.options.change.call(this,v)){u=false}if(u){t.text(s.getText()).show();if(s.options.autoSize){s.element.width(t.width())}s.element.hide()}else{if(s.options.selectOnOpen){s.element.select()}}})}},getText:function(){if(this.element.prop("tagName")=="SELECT"){return this.element.children(":selected").text()}else{return this.element.val()}},_destroy:function(){this.link.remove();this.element.show()}})})(jq);jq.fn.hintInputBox=function(a){var b={message:"",blurClass:"blur"};var a=jq.extend(b,a);return this.each(function(){var d=jq(this);var f=jq(this.form);var g=jq(window);function c(){if(d.val()===a.message&&d.hasClass(a.blurClass)){d.val("").removeClass(a.blurClass)}}d.blur(function(){if(this.value===""){d.addClass(a.blurClass).val(a.message)}}).focus(c).blur();f.submit(c);g.unload(c)})};(function(a){a.ellipsisTooltip=function(b){this.init(b||{});return this};a.extend(a.ellipsisTooltip,{checkIfPossible:function(){return a.fn.textOverflow!==undefined&&a.fn.tipTip!==undefined},prototype:{settings:{activation:"hover",position:"top",edgeOffset:3,delay:0,fadeIn:200,fadeOut:200,content:"",ellipseString:"&#x2026;"},init:function(b){this.settings=a.extend({},this.settings,b)},processNode:function(b){b=a(b);var d=a.support.textOverflow?b.width():null;var c=b.text();if(a.support.textOverflow){if(this.getTextWidth(b)<d+1){return}}else{b.textOverflow(this.settings.ellipseString);if(!b.text().match(/âŠ$/)){return}}b.tipTip(a.extend(this.settings,{content:c}))},getTextWidth:function(c){var d=c.clone();d.css({width:"auto",display:"none","max-width":"none"});d.appendTo(c.parent());var b=d.width();d.remove();return b}}});a.fn.ellipsisTooltip=function(b){if(a.ellipsisTooltip.checkIfPossible()){return this.each(function(){var c=new a.ellipsisTooltip(b);c.processNode(this)})}return this}})(window.jq||window.jQuery);(function(a){a.emailValidator=function(b){this.init(b||{});return this};a.extend(a.emailValidator,{prototype:{settings:{activation:"blur",validateInvalid:true,warnTypos:true,boldSuggestions:true,at:"auto",callback:null},init:function(b){this.settings=a.extend({},this.settings,b)},registerEvents:function(c){var b=this;var c=a(c);if(!c.data("emailValidatorInit")){c.bind(b.settings.activation,function(){if(!c.data("no-popup")&&c.is(":visible")){b.checkEmail(this)}else{c.data("no-popup",false)}});c.change(function(){c.data("emailValidatorWarned",false)});c.data("emailValidatorInit",true)}},checkEmail:function(c){var b=this;var f=jq(c);if(f.data("emailValidatorWarned")){return}if(!f.val().length){return}var d="email="+encodeURIComponent(f.val());jq.ajax({type:"POST",dataType:"json",url:"/k/run/spellcheckemail",data:d,success:function(g){if(typeof b.settings.callback=="function"){b.settings.callback.call(b,c,g)}else{b.callback(c,g)}}});f.data("emailValidatorWarned",true)},callback:function(b,c){if((!c.validAddress&&this.settings.validateInvalid)||(c.warnTypo&&this.settings.warnTypos)&&jq(b).is(":visible")){this.showErrorMessage(b,c.errorMessage,c.errorTitle)}else{jq("#emailValidatorWarnBox").r9popover("destroy").remove()}},showErrorMessage:function(c,b,d){jq("<div title='"+d+"' id='emailValidatorWarnBox' class='emailValidatorWarn'>"+b+"</div>").r9popover({autoFocus:false,position:jq(c),width:250,modal:false,at:this.settings.at,dialogClass:"emailValidatorWarnBoxDlg",minHeight:130});if(this.settings.boldSuggestions){jq(".emailValidatorWarn span").css("font-weight","bold")}}}});a.fn.emailValidator=function(b){return this.each(function(){var c=new a.emailValidator(b);c.registerEvents(this)});return this}})(jq);(function(b){var a={extend:function(){var g=Array.prototype.slice.call(arguments);if(g.length){var d=a;if(typeof g[0]=="string"){var j=g.shift();if(!g.length){return a}var f=j.split(".");for(var h=0;h<f.length;h++){d[f[h]]=d[f[h]]||{};d=d[f[h]]}}var c=false;if(typeof g[0]=="boolean"){c=g.shift()}g.unshift(d);if(c){g.unshift(true)}b.extend.apply(b,g)}return a}};window.R9=a})(window.jq||window.jQuery);this.console=this.console||{log:function(){}};R9.extend("Analytics",{API:function(a){this.initialize(a)}});R9.extend("Analytics.API",{handlers:{pageView:[],event:[],autoEvent:[]},registerPlugin:function(d,c){var b=R9.Analytics.API.handlers;var a=b[d];if(typeof a!="undefined"){a.push(c)}}});R9.extend("Analytics.API.prototype",{initialize:function(a){this._options=a},trackPageView:function(c,d){var a=R9.globals.analytics||{};if(a.doNotTrack){return}var b=this._makePageData(c);this._handle(R9.Analytics.API.handlers.pageView,b,d)},trackEvent:function(b,c){var a=this._makeEventData(b);this._handle(R9.Analytics.API.handlers.event,a,c)},trackAutoEvent:function(b,c){var a=this._makeEventData(b);a.auto=true;this._handle(R9.Analytics.API.handlers.autoEvent,a,c)},setSubPageId:function(a){R9.globals.analytics.subPageId=a},_handle:function(c,g,h){var b=c.length;var a=[];var f;for(var d=0;d<b;d++){f=jq.Deferred();a.push(f);c[d](g,(function(){var j=f;return function(){j.resolve()}})())}if(h){jq.when.apply(jq,a).done(h)}},_makeEventData:function(a){if(typeof a==="string"){a={desc:a}}var b=this._makeCommonData(a);var c=null;if(R9.currentSearch){c=R9.currentSearch.getSearchId()}if(!c){c=window.SearchID}if(c){b.searchid=c}if(a){b.desc=a.desc;b.params=a.params;b.searchid=b.searchid||a.searchid}return b},_makePageData:function(a){var b=this._makeCommonData(a);return b},_makeCommonData:function(b){var c={};var a=R9.globals.analytics||{};if(!b){c.vertical=a.vertical||R9.globals.vertical;c.locale=R9.globals.locale.loc;c.affiliate=R9.globals.affiliate;c.affiliateskin=R9.globals.affiliateskin||R9.globals.brand;c.experiment=R9.globals.experiment;c.pageId=a.pageId;c.subPageId=a.subPageId;c.presentation=a.presentation||R9.globals.presentation;c.pixelContext=a.pixelContext||{}}else{c.vertical=b.vertical||a.vertical||R9.globals.vertical;c.locale=b.locale||R9.globals.locale.loc;c.affiliate=b.affiliate||R9.globals.affiliate;c.affiliateskin=b.affiliateskin||b.brand||R9.globals.affiliateskin||R9.globals.brand;c.experiment=b.experiment||R9.globals.experiment;c.pageId=b.pageId||a.pageId;c.subPageId=b.subPageId||a.subPageId;c.presentation=b.presentation||a.presentation||R9.globals.presentation;c.pixelContext=a.pixelContext||{}}return c}});(function(){var k="dimension1";var q="dimension2";var p="dimension3";var a="dimension4";var r="dimension5";var o="dimension6";var h="dimension7";var m="dimension8";var d="dimension10";var l="dimension11";function g(u,v){var t={};t[k]=u.vertical;t[q]=u.pageId;t[p]=u.subPageId;t[a]=u.locale;t[r]=u.affiliate;t[h]=u.affiliateskin;t[o]=u.experiment;t[m]=u.presentation;t[d]=u.pixelContext.destination&&u.pixelContext.destination.cityId;t[l]=u.pixelContext.hotelId;t.title=document.title;t.location=document.location.href;t.hitCallback=v;return t}function c(u,v){var t={};t[k]=u.vertical;t[q]=u.pageId;t[p]=u.subPageId;t[a]=u.locale;t[r]=u.affiliate;t[h]=u.affiliateskin;t[o]=u.experiment;t[m]=u.presentation;t.eventCategory=u.desc;if(u.auto){t.eventAction=u.action||"auto";t.nonInteraction=1}else{t.eventAction=u.action||"click"}t.title=document.title;t.location=document.location.href;t.hitCallback=v;return t}function s(u,t){u("set","contentGroup1",t[k]);u("set","contentGroup2",t[k]+"/"+t[q]);if(t[p]){u("set","contentGroup3",t[k]+"/"+t[q]+"/"+t[p])}}var j=function(u,v){if(R9.globals.analytics&&R9.globals.analytics.google&&R9.globals.analytics.google.trackPageView=="true"){n(R9.globals.analytics.utoken);var t=g(u,v);if(t){s(__gaTracker,t);__gaTracker("send","pageview",t)}}else{v&&v()}};var b=function(u,v){if(R9.globals.analytics&&R9.globals.analytics.google&&R9.globals.analytics.google.trackEvent=="true"){n(R9.globals.analytics.utoken);var t=c(u,v);if(t){s(__gaTracker,t);__gaTracker("send","event",t)}}else{v&&v()}};var f=false;function n(t){if(f){return}if(t){__gaTracker("create","UA-42209185-8",{userId:t})}else{__gaTracker("create","UA-42209185-8","auto")}__gaTracker("require","displayfeatures");__gaTracker("require","ecommerce");f=true}R9.Analytics.API.registerPlugin("pageView",j);R9.Analytics.API.registerPlugin("event",b);(function(v,w,A,z,y,u,t){v.GoogleAnalyticsObject=y;v[y]=v[y]||function(){(v[y].q=v[y].q||[]).push(arguments)};v[y].l=1*new Date();var x=setInterval(function(){if(!R9||!R9.globals||!R9.globals.uiconfig||!R9.config||!R9.config.getBoolean){return}clearInterval(x);if(!R9.config.getBoolean("ui.ga.forceOff",false)){u=w.createElement(A);t=w.getElementsByTagName(A)[0];u.async=1;u.src=z;t.parentNode.insertBefore(u,t)}else{v[y]=function(){if(arguments&&(arguments.length>2)&&arguments[2]&&(typeof(arguments[2].hitCallback)==="function")){arguments[2].hitCallback()}}}},100)})(window,document,"script","","__gaTracker")}());(function(){function c(g,h){var f={};f.type="POST";f.url="/vs/"+(g.auto?"auto/":"")+g.vertical+"/"+g.pageId+"/"+(g.subPageId?(g.subPageId+"/"):"")+g.desc;f.url=f.url.replace(/\/+/g,"/");f.data=g.params||{};f.data.action="vs";f.data.searchid=g.searchid;f.success=h;return f}function d(g,h){var f={};f.type="POST";f.url="/vs/page/"+g.vertical+"/"+g.pageId+(g.subPageId?("/"+g.subPageId):"");f.data=g.params||{};f.data.action="vs";f.data.searchid=g.searchid;f.success=h;return f}var b=function(g,h){if(R9.globals.analytics&&R9.globals.analytics.vslog&&R9.globals.analytics.vslog.trackPageView=="true"){var f=d(g,h);if(f){jq.ajax(f)}}else{h&&h()}};var a=function(g,h){if(R9.globals.analytics&&R9.globals.analytics.vslog&&R9.globals.analytics.vslog.trackEvent=="true"){var f=c(g,h);if(f){jq.ajax(f)}}else{h&&h()}};R9.Analytics.API.registerPlugin("pageView",b);R9.Analytics.API.registerPlugin("event",a);R9.Analytics.API.registerPlugin("autoEvent",a)}());R9.Analytics.api=new R9.Analytics.API({});(function(a){R9.extend("Alien.Moment",{setupLocale:function(b,g,d){var j,h;try{if(!b||!g){return}j=b.loc.replace("_","-").toLowerCase();try{g.locale(j);h=g.locale()}catch(f){try{if(h!=j){j=b.lc;g.locale(j);h=g.locale()}}catch(c){}}if(d){g.locale(h,d)}}catch(f){}}})})(jq||jQuery);(function(a){R9.extend(true,{Ajax:function(c,b){if(typeof c=="string"){this.options.url=c}else{b=b||c||{}}var d=this;this.options.success=function(f){d.handleSuccess(f)};this.options.error=function(){d.handleError()};this.options=a.extend(true,{},this.options,b||{});this.setResponse()}});R9.extend("Ajax",true,{execute:function(d,c){var b=new R9.Ajax(d,c);return b.execute()}});R9.extend("Ajax.prototype",true,{ajax:null,response:null,options:{type:"POST",beforePublish:null,afterPublish:null,errorDialog:null},execute:function(){this.ajax=a.ajax(this.options);return this},handleSuccess:function(b){this.setResponse(b);this.executePrePublishScripts();if(this.getResponse().status>0){this.showError()}else{this.publishDomNodes()}this.executePostPublishScripts();return this},handleError:function(){this.showError();return this},showError:function(){return this},publishDomNodes:function(){var h;var c;var g;var d=this.getResponse().nodes;var b=a("body");for(var f in d){if(!d.hasOwnProperty(f)){continue}g=a("<div></div>").append(d[f]).children();c="#"+f;h=a(c);if(h.length){if(g.is(c)){h.replaceWith(g)}else{h.html(g)}continue}if(!g.is(c)){g=a('<div id="'+f+'"></div>').append(g)}b.append(g)}return this},executePrePublishScripts:function(){R9.utils.evaluateScript(this.getResponse().preScript);if(this.options.beforePublish){this.options.beforePublish.call(this)}return this},executePostPublishScripts:function(){R9.utils.evaluateScript(this.getResponse().postScript);if(this.options.afterPublish){this.options.afterPublish.call(this)}return this},setResponse:function(b){this.response=a.extend({status:1,message:"",nodes:{},preScript:"",postScript:"",payload:{}},b||{});return this},getResponse:function(){return this.response},getErrorDialog:function(){if(this.errorDialog==null){this.errorDialog=this.setErrorDialog(R9.ErrorDialog.getInstance())}return this.errorDialog},setErrorDialog:function(b){this.errorDialog=b;return this.errorDialog}})})(jq||jQuery);(function(f){var g={};var a={};var c={};var d=null;var b=0;function j(l){if(!l){var k=(++b);return g[k]==null?k:j()}if(g[l]!=null){R9.utils.log("Duplicate instance creation was attempted. ID -> ",l);var k=(++b);return g[k]==null?k:j()}return l}R9.extend({ViewState:function(l,k){this.instanceId=j(l);this.setOptions(k);this.lastURLViewState=this.options.currentUrlState;g[this.instanceId]=this}});R9.extend("ViewState",{getInstance:function(n,k){if((!n&&!k)||(typeof n=="object"&&!k)){d=d||j()}var m=k;var l=d||n;if(d!=null){m=n}if(g[l]==null){g[l]=new R9.ViewState(l,m||{})}else{if(m!=null){g[l].setOptions(m)}}return g[l]},getStateString:function(k){return R9.ViewState.getInstance(k).getStateString()},saveState:function(l,k){return R9.ViewState.getInstance(k).saveState(false,l)},getUrlStateString:function(k){return this.getInstance(k).getUrlStateString()},isPageReloadState:function(){return true},isLegacyLocationURL:function(){return window.location.pathname.indexOf("/r/")>=0}});R9.extend("ViewState.prototype",{instanceId:null,lastURLViewState:"",options:{currentUrlState:"",stateDelimiter:";",vertical:null,searchBaseUrl:null,urlStateRequestKey:"urlViewState",saving:{url:"/s/sparkle",searchIdKey:"searchid",searchType:"type",requestType:"POST",dataType:"json",actionKey:"action",actionValue:"viewState",ignoreWindowScrollPositionOnce:false,requestKey:"viewState",resetValue:"RESET"},viewStatesKeys:{windowScroll:"ws",clickedResultIdListKey:"t",lastClickedResultIdKey:"lt",hotelDetailsOpenedIndex:"hdoix",hotelDetailsOpenedId:"hdoid",hotelDetailsOpenedTab:"hdot",hotelMiniDetailsOpenedId:"hmdoid",hotelMiniDetailsOpenedTab:"hmdot",hotelMiniDetailsOpenedIdPage:"hmdoip",hotelMapFilterOpenedId:"hmfoid",showLayoverFilter:"lay",resultPageNumber:"pn",showMatrix:"mtx",showPlusMinusThree:"fflx",mapViewPortCenter:"mvpc",mapZoomLevel:"mzl",landingTimeSliders:"lts",takeOffTimeSliders:"tots",flightDetailsOpenedIndexes:"fodi",carDetailsOpenedIndexes:"codi",hotelMapMiniDetailsId:"hmmd",multiCityFlightFilterLeg:"mcleg",chosenDepartureIndex:"cdidx",activeDestinationAirport:"frdest"},urlViewStateKeys:{resultViewMode:"vw",mapTypeId:"mtid"},noPushState:false},setOptions:function(k){this.options=f.extend(true,{},this.options,k||{})},add:function(k,l){if(a[this.instanceId]==null){a[this.instanceId]={}}if(k){a[this.instanceId][k]=l}else{R9.utils.log("State name cannot be empty: ",k)}return this},addUrlState:function(k,l){if(c[this.instanceId]==null){c[this.instanceId]={}}if(k){c[this.instanceId][k]=l}else{R9.utils.log("State name cannot be empty: ",k)}return this},get:function(k){if(k){if(a[this.instanceId]!=null&&a[this.instanceId][k]!=null){return a[this.instanceId][k]}if(c[this.instanceId]!=null&&c[this.instanceId][k]!=null){return c[this.instanceId][k]}}return null},remove:function(k){if(k&&a[this.instanceId]!=null&&a[this.instanceId][k]!=null){delete a[this.instanceId][k]}if(k&&c[this.instanceId]!=null&&c[this.instanceId][k]!=null){delete c[this.instanceId][k]}return this},restore:function(k){try{if(typeof k=="string"){k=f.parseJSON(k)}if(typeof a[this.instanceId]=="object"){f.extend(a[this.instanceId],k)}else{a[this.instanceId]=k}}catch(l){R9.utils.log("Failed to parse JSON string: ",l)}return this},restoreUrlStates:function(k){try{if(typeof k=="string"){k=f.parseJSON(k)}c[this.instanceId]=k}catch(l){R9.utils.log("Failed to parse JSON string: ",l)}return this},reset:function(){a[this.instanceId]=null;return this},getStateString:function(){this.refreshRequiredViewStates();var k=f.extend({},c[this.instanceId]||{},a[this.instanceId]||{});if(!f.isArray(k.ws)&&typeof k.ws!=="undefined"){delete k.ws}return h.stringify(k)},getUrlStateString:function(){return this.options.currentUrlState},saveState:function(l,n){var m={};m[this.options.saving.actionKey]=this.options.saving.actionValue;m[this.options.saving.searchIdKey]=window.SearchID;m[this.options.saving.searchType]=R9.globals.vertical;m[this.options.saving.requestKey]=this.getStateString();var k=this;f.ajax(this.options.saving.url,{type:this.options.saving.requestType,dataType:this.options.saving.dataType,data:m,success:function(o){if(o&&parseInt(o.status,10)>0){k.restoreUrlStates(o.stateValues);k.updateUrlState(o.state)}if(l||parseInt(o.reset,10)==1){k.reset()}if(typeof n=="function"){n()}},error:function(){}});return this},updateUrlState:function(o){var q=this.options.vertical&&(this.options.searchBaseUrl||R9.ViewState.isLegacyLocationURL())&&this.lastURLViewState!=o;if(!q){return this}this.options.currentUrlState=o;if(this._handleLegacyURLUpdate(o)){return this}this.lastURLViewState=o;var n=this.options.searchBaseUrl||"";var p=this.getUrlStateString();if(p){n+=this.options.stateDelimiter+p}var l=window.location.pathname.indexOf("/"+this.options.vertical);var k=window.location.hash.indexOf("/"+this.options.vertical);if(l<0&&k<0){return this}if(R9.ViewState.isPageReloadState()){var m="/"+this.options.vertical+"/"+n;if(R9.Tabs&&R9.Tabs.SearchTabs){R9.Tabs.SearchTabs.changeCurrentTabUrl(m);if(history.pushState!==undefined){history.replaceState(history.state,document.title,m)}else{R9App.AppInstance.updateBrowserLocationWithoutNavigation(m)}}else{window.location.pathname=m}}return this},refreshRequiredViewStates:function(){if(this.options.saving.ignoreWindowScrollPositionOnce){this.options.saving.ignoreWindowScrollPositionOnce=false;return this}this.add(this.options.viewStatesKeys.windowScroll,[this.getScrollPositionHorizontalWindow(),this.getScrollPositionVerticalWindow()]);return this},getScrollPositionHorizontal:function(l){var k=f(l);if(!k.length){return 0}return f(l).get(0).scrollLeft},getScrollPositionVertical:function(l){var k=f(l);if(!k.length){return 0}return f(l).get(0).scrollTop},getScrollPositionHorizontalWindow:function(){if(!f.support.tbody){return document.documentElement.scrollLeft}return window.scrollX||window.pageXOffset||0},getScrollPositionVerticalWindow:function(){if(!f.support.tbody){return document.documentElement.scrollTop}return window.scrollY||window.pageYOffset||0},addResultClicked:function(m){value=this.getNormalizedIntegerValue(m);if(value>=0){this.add(this.options.viewStatesKeys.lastClickedResultIdKey,value);var l=f.isArray(this.get(this.options.viewStatesKeys.clickedResultIdListKey))?this.get(this.options.viewStatesKeys.clickedResultIdListKey):[];if(f.inArray(value,l)<0){l.push(value)}this.add(this.options.viewStatesKeys.clickedResultIdListKey,l);var k=f("#tbd"+m);k.parent().children(".lastclicked").removeClass("lastclicked");k.addClass("clicked lastclicked")}return this},addHotelDetailsOpenedValues:function(m,l,k){m=this.getNormalizedIntegerValue(m);this.addResultClicked(m);this.add(this.options.viewStatesKeys.hotelDetailsOpenedIndex,m);l=this.getNormalizedIntegerValue(l);if(l>=0){this.add(this.options.viewStatesKeys.hotelDetailsOpenedId,l);this.addHotelDetailsOpenTabValue(k)}return this},addHotelDetailsOpenTabValue:function(k){this.add(this.options.viewStatesKeys.hotelDetailsOpenedTab,k);return this},addHotelMiniDetailsOpenedValues:function(m,l,k){m=this.getNormalizedIntegerValue(m);this.addResultClicked(m);this.add(this.options.viewStatesKeys.hotelDetailsOpenedIndex,m);l=this.getNormalizedIntegerValue(l);if(l>=0){var n=this.get(this.options.viewStatesKeys.hotelMiniDetailsOpenedIdPage)||new Object();n[l]=k;this.add(this.options.viewStatesKeys.hotelMiniDetailsOpenedIdPage,n)}return this},getHotelMiniDetailsOpened:function(){var k=this.get(this.options.viewStatesKeys.hotelMiniDetailsOpenedIdPage);return k},removeHotelMiniDetailsOpenedValues:function(){this.remove(this.options.viewStatesKeys.hotelMiniDetailsOpenedIdPage);return this},removeSingleHotelMiniDetailsOpenedValues:function(k){k=this.getNormalizedIntegerValue(k);if(k>=0){var l=this.get(this.options.viewStatesKeys.hotelMiniDetailsOpenedIdPage)||new Object();if(l[k]!=null){delete l[k]}this.add(this.options.viewStatesKeys.hotelMiniDetailsOpenedIdPage,l)}return this},removeHotelDetailsOpenedValues:function(){this.remove(this.options.viewStatesKeys.hotelDetailsOpenedId);this.remove(this.options.viewStatesKeys.hotelDetailsOpenedTab);return this},addResultViewModeValue:function(l,k){this.addUrlState(this.options.urlViewStateKeys.resultViewMode,l);this.options.noPushState=k;return this},addActiveDestinationAirport:function(k){this.add(this.options.viewStatesKeys.activeDestinationAirport,k);return this},addResultPageNumber:function(k){k=parseInt(k,10);k=isNaN(k)||k<=0?0:k-1;this.add(this.options.viewStatesKeys.resultPageNumber,k);this.resetViewStatesOnPageChange();return this},resetViewStatesOnPageChange:function(){this.resetOpenedFlightDetails();this.resetOpenedCarDetails();return this},resetViewStatesOnFilters:function(){this.addResultPageNumber(0);this.resetOpenedFlightDetails();this.resetOpenedCarDetails();return this},resetViewStatesOnSort:function(){this.addResultPageNumber(0);this.resetOpenedFlightDetails();this.resetOpenedCarDetails();return this},addMapTypeId:function(k){this.addUrlState(this.options.urlViewStateKeys.mapTypeId,k);return this},addMapCenterPoint:function(l,k){if(l!=null&&k!=null){this.add(this.options.viewStatesKeys.mapViewPortCenter,{lat:l,lng:k})}return this},addMapZoomLevel:function(k){if(k){this.add(this.options.viewStatesKeys.mapZoomLevel,k)}return this},addToOpenedDetailsList:function(n,k){k=this.getNormalizedIntegerValue(k);if(k<0){return}var o=f.isArray(this.get(n))?this.get(n):[];if(f.inArray(k,o)<0){o.push(k);this.addResultClicked(k)}var l;var m=k*-1;for(l=0;l<o.length;l++){if(o[l]==m){o.splice(l,1);break}}this.add(n,o);return this},removeFromOpenedDetailsList:function(n,k){k=this.getNormalizedIntegerValue(k);if(k<0){return}var l;var o=f.isArray(this.get(n))?this.get(n):[];for(l=0;l<o.length;l++){if(o[l]==k){o.splice(l,1);break}}var m=k*-1;if(f.inArray(m,o)<0){o.push(m)}this.add(n,o);return this},resetOpenedDetailsList:function(k){this.add(k,this.options.saving.resetValue);return this},addOpenedFlightDetails:function(k){return this.addToOpenedDetailsList(this.options.viewStatesKeys.flightDetailsOpenedIndexes,k)},removeOpenedFlightDetails:function(k){return this.removeFromOpenedDetailsList(this.options.viewStatesKeys.flightDetailsOpenedIndexes,k)},resetOpenedFlightDetails:function(){return this.resetOpenedDetailsList(this.options.viewStatesKeys.flightDetailsOpenedIndexes)},addOpenedCarDetails:function(k){return this.addToOpenedDetailsList(this.options.viewStatesKeys.carDetailsOpenedIndexes,k)},removeOpenedCarDetails:function(k){return this.removeFromOpenedDetailsList(this.options.viewStatesKeys.carDetailsOpenedIndexes,k)},resetOpenedCarDetails:function(){return this.resetOpenedDetailsList(this.options.viewStatesKeys.carDetailsOpenedIndexes)},addHotelMapMiniDetailsId:function(k){k=this.getNormalizedIntegerValue(k);if(k>=0){this.add(this.options.viewStatesKeys.hotelMapMiniDetailsId,k)}return this},removeHotelMapMiniDetailsId:function(){this.add(this.options.viewStatesKeys.hotelMapMiniDetailsId,-1);return this},addFlightLayoverAirportsState:function(k){if(typeof k=="undefined"){k=true}this.add(this.options.viewStatesKeys.showLayoverFilter,k);return this},addFlightMultiCityFilterLegState:function(k){if(typeof k!="undefined"){this.add(this.options.viewStatesKeys.multiCityFlightFilterLeg,k)}return this},setIsAirlineFilterInAirlineView:function(k){if(typeof k!="undefined"){this.add(this.options.viewStatesKeys.airlineFilterIsAirlineView,k)}return this},addFlightLandingTimeSlidersFilterState:function(k){if(typeof k=="undefined"){k=true}this.add(this.options.viewStatesKeys.landingTimeSliders,k);return this},addFlightTakeOffTimeSlidersFilterState:function(k){if(typeof k=="undefined"){k=true}this.add(this.options.viewStatesKeys.takeOffTimeSliders,k);return this},addShowMatrixViewState:function(k){if(typeof k=="undefined"){k=false}this.add(this.options.viewStatesKeys.showMatrix,k);return this},addShowPlusMinusThreeViewState:function(k){if(typeof k=="undefined"){k=false}this.add(this.options.viewStatesKeys.showPlusMinusThree,k);return this},setIgnoreWindowScrollPositionOnce:function(){this.options.saving.ignoreWindowScrollPositionOnce=true;return this},getNormalizedIntegerValue:function(k){k=parseInt(k,10);if(typeof k!="number"){k=-1}return k},addHotelMapFilterOpenedId:function(k){this.add(this.options.viewStatesKeys.hotelMapFilterOpenedId,k);return this},removeHotelMapFilterOpenedId:function(k){if(this.get(this.options.viewStatesKeys.hotelMapFilterOpenedId)==k){this.add(this.options.viewStatesKeys.hotelMapFilterOpenedId,"none_opened")}return this},_handleLegacyURLUpdate:function(m){if(!R9.ViewState.isLegacyLocationURL()){return false}var l=window.location.pathname;var o=l.indexOf(this.options.stateDelimiter+this.lastURLViewState);if(o>=0){l=l.substring(0,o)}if(!m){window.location.pathname=l;return true}var k="";var n=this.getUrlStateString();if(n){k+=this.options.stateDelimiter+n}window.location.pathname=l+k;return true},addChosenDepartureIndex:function(k){if(typeof k!="undefined"){this.add(this.options.viewStatesKeys.chosenDepartureIndex,k)}return this},removeChosenDepartureIndex:function(){this.add(this.options.viewStatesKeys.chosenDepartureIndex,-1);return this}});var h=window.JSON;if(typeof h==="undefined"){h={}}if(typeof h.stringify==="undefined"){f.extend(h,{stringify:function(m){var k=[];switch(typeof m){case"string":return'"'+m.replace(/(["\\\/\b\f\n\r\t]{1})/g,"{1}")+'"';case"number":case"boolean":return m.toString();case"undefined":return"undefined";case"object":if(f.isArray(m)){for(var l=0;l<m.length;l++){k.push(h.stringify(m[l]))}return"["+k.join(",")+"]"}if(m==null){return"null"}for(var n in m){if(!m.hasOwnProperty(n)){continue}k.push('"'+n.toString()+'":'+h.stringify(m[n]))}return"{"+k.join(",")+"}"}return""}})}})(jq||jQuery);(function(a){R9.extend("utils",{log:function(){if(typeof console=="undefined"||console==null){return}if(console.exception!=null){console.exception.apply(window,arguments)}else{if(console.error!=null){console.error(Array.prototype.slice.call(arguments))}if(console.trace!=null){console.trace()}}},formToObject:function(c){var d={},b=a(c).serializeArray();a.each(b,function(){if(typeof d[this.name]!="undefined"){d[this.name]=d[this.name]+","+this.value}else{d[this.name]=this.value}});return d},slugify:function(b){return b.replace(/[^A-Za-z0-9\-_]/g,"")},roundTo:function(c,b){if(!c||isNaN(parseInt(c,10))){return 0}var d=Math.pow(10,parseInt(b,10)||0);return Math.round(c*d)/d},roundToNearest:function(f,c,b){if(b==null){b=true}var d=Math.floor(f/c);if((f%c)>0){if(b){return((d+1)*c)}else{return(d*c)}}else{return f}},evaluateScript:function(d){var b=null;try{switch(typeof d){case"string":b=d;break;case"number":d=this;default:b=d.innerText||d.textContent;break}if(!b){return}b=b.replace(/([^\r])\n/,"$1\r\n");a.globalEval(b)}catch(c){this.log(c,b)}},applyMethod:function(b,c,d){var f=b&&b[c];if(typeof f==="function"){return f.apply(b,d)}return null}})})(jq||jQuery);(function(a){R9.extend("config",{getString:function(c,b){if(!window.R9||!R9.globals||!R9.globals.uiconfig||typeof R9.globals.uiconfig[c]=="undefined"){return b}else{return R9.globals.uiconfig[c]}},getBoolean:function(d,b){var c=R9.config.getString(d);return c?"true"===c.toLowerCase():b},getInt:function(d,b){var c=R9.config.getString(d);return c?parseInt(c):b}})})(jq||jQuery);(function(a){var b=1000*60*60*24;R9.extend("Utils.Date",{getDaysInMonth:function(c){if(!c){return 0}return 32-new Date(c.getFullYear(),c.getMonth(),32).getDate()},formatToDatetime:function(g,f){if(!g){return null}var c=(g.getMonth()+1).toString();if(c.length==1){c="0"+c}var h=g.getDate().toString();if(h.length==1){h="0"+h}if(typeof f==="undefined"){f="-"}return[g.getFullYear().toString(),c,h].join(f)},parseFromDatetime:function(h,g){if(typeof g==="undefined"){g="-"}var j=["^((?:20|19)[0-9]{2})","(0?[1-9]|1[012])","(0?[1-9]|[12][0-9]|3[01])$"].join(g);var k=new RegExp(j);var f=k.exec(h);if(f){var n=parseInt(f[1],10);var c=(parseInt(f[2],10)-1)||0;var l=parseInt(f[3],10);return new Date(n,c,l)}return null},getDayDifference:function(f,c){if(!f||!c){return 0}var g=new Date(f.getFullYear(),f.getMonth(),f.getDate());var d=new Date(c.getFullYear(),c.getMonth(),c.getDate());return Math.floor((g.getTime()-d.getTime())/b)},getMonthDifference:function(d,c){if(!d||!c){return 0}return(12*d.getFullYear()+d.getMonth())-(12*c.getFullYear()+c.getMonth())}})})(jq||jQuery);(function(b){var a=false;R9.extend("Widgets",{Tooltip:function(d,c){this.element=b(d);this.element.data(this.widgetName,this);this.setOptions(c,true)}});R9.extend("Widgets.Tooltip",{validateElement:function(c){return b(c).data(this.prototype.widgetName)===undefined},getInstance:function(f,d){if(!this.validateElement(f)){var c=b(f).data(this.prototype.widgetName);if(d){return c.setOptions(d)}return c}return new R9.Widgets.Tooltip(f,d)},removeWidget:function(c){if(!this.validateElement(c)){this.getInstance(c).removeWidget()}}});R9.extend("Widgets.Tooltip.prototype",{element:null,widgetNamespace:"r9-tooltip",widgetBaseClass:"r9-tooltip",widgetName:"tooltip",options:{delay:200,fadeIn:200,fadeOut:200,edgeOffset:3,baseClass:null,content:null,position:"top",activation:"hover",showImmediately:false,subNameSpace:"",onOpen:null,onClose:null},_timer:null,_originalTitle:null,init:function(){this._removeAllWidgetBindings();var d=this;switch(this.options.activation){case"click":var c=false;this.element.on("click."+this.widgetName,function(f){if(a===false){c=false}if(c===false){d.open(f)}else{d.close(f)}c=!c;a=c});if(this.options.showImmediately){this.element.trigger("click."+this.widgetName)}break;case"focus":this.element.on("focus."+this.widgetName,function(f){d.open(f)});this.element.on("blur."+this.widgetName,function(f){d.close(f)});if(this.options.showImmediately){this.element.trigger("focus."+this.widgetName)}break;case"hover":default:this.element.on("mouseenter."+this.widgetName,function(f){d.open(f)});this.element.on("mouseleave."+this.widgetName,function(f){d.close(f)});if(this.options.showImmediately){this.element.trigger("mouseenter."+this.widgetName)}break}return this},setOptions:function(c,d){if(c){this.options=b.extend({},this.options,c)}if(c||d){this.init()}return this},open:function(g){var f=this.getContent(g);if(!f){return this}var k=this._getWrapperElement();var c=this._getContainerElement();var j=this._getArrowElement();c.html(f);this._resetElements(k,c,j);var h=this._getPositionMap(k,j);this._updateArrowElement(h,j);this._updateWrapperElement(h,k);this._updateContainerElement(h,c);if(this._timer){clearTimeout(this._timer)}if(this.options.delay){var d=this;this._timer=setTimeout(function(){d._open(k)},this.options.delay)}else{this._open(k)}return this},close:function(){if(this._timer){clearTimeout(this._timer)}var d=this._getWrapperElement();d.stop(true,true);var c=this;if(this.options.fadeOut){d.fadeOut(this.options.fadeOut,function(){c._close()})}else{d.hide();this._close()}return this},getContent:function(c){var d=this.element.attr("title");if(d){this._originalTitle=d;this.element.attr("title","")}if(this.options.content){if(typeof this.options.content=="function"){return this.options.content.call(this,c)}return this.options.content}if(this._originalTitle){return this._originalTitle}if(this.element.data("title")!=null){return this.element.data("title")}return this.element.text()},removeWidget:function(){this._removeAllWidgetBindings();this.element.removeData(this.widgetName);this.close();return this},_getWrapperElement:function(){var c=b("#"+this._getIdValue("-wrapper"));if(!c.length){c=this._createDOMElement("-wrapper");b("body").append(c)}return c},_getContainerElement:function(){var c=b("#"+this._getIdValue("-container"));if(!c.length){c=this._createDOMElement("-container");this._getWrapperElement().append(c)}return c},_getArrowElement:function(){var c=b("#"+this._getIdValue("-arrow"));if(!c.length){c=this._createDOMElement("-arrow");this._getWrapperElement().append(c)}return c},_createDOMElement:function(d){var c=b("<div></div>").attr("id",this._getIdValue(d));this._setStyleClasses(c,d);return c},_removeAllWidgetBindings:function(){this.element.off("click."+this.widgetName).off("focus."+this.widgetName).off("blur."+this.widgetName).off("mouseenter."+this.widgetName).off("mouseleave."+this.widgetName);return this},_getOffsetInformation:function(f,k,h){var g=this.element.outerWidth();var d=this.element.outerHeight();var j=this.element.offset();var c=f==="width"?h.outerWidth():h.outerHeight();return{arrowSize:Math.round(c/2),elementWidth:g,elementHeight:d,wrapperWidth:k.outerWidth(),wrapperHeight:k.outerHeight(),offset:{top:Math.floor(j.top),left:Math.floor(j.left)}}},_getPositionMap:function(d,c){d.attr("style","").css({top:"-1000px",left:"-5000px",display:"block"});switch(this.options.position){case"bottom":return this._getBottomPositioning(d,c);case"left":return this._getLeftPositioning(d,c);case"right":return this._getRightPositioning(d,c);case"top":default:return this._getTopPositioning(d,c)}},_getCommonPositioningMap:function(){return{newArrowTop:0,newArrowLeft:0,newWrapperTop:0,newWrapperLeft:0,wrapperClass:""}},_getTopPositioning:function(k,g){var j=this._getOffsetInformation("height",k,g);var h=Math.floor(j.elementWidth/2);var d="-top";var f=j.wrapperHeight;var c=j.offset.top-this.options.edgeOffset-j.arrowSize-j.wrapperHeight;if(c<=0){d="-bottom";c=j.offset.top+j.elementHeight+this.options.edgeOffset+j.arrowSize;f=j.arrowSize*-1}if(!b.support.leadingWhitespace){f-=1}return b.extend(this._getCommonPositioningMap(),{newArrowTop:f,newArrowLeft:Math.floor(j.wrapperWidth/2)-j.arrowSize,newWrapperTop:c,newWrapperLeft:j.offset.left+h-Math.floor(j.wrapperWidth/2),wrapperClass:d})},_getBottomPositioning:function(k,g){var j=this._getOffsetInformation("height",k,g);var h=Math.floor(j.elementWidth/2);var d="-bottom";var f=j.arrowSize*-1;var c=j.offset.top+j.elementHeight+this.options.edgeOffset+j.arrowSize;if(c+j.wrapperHeight>=b(window).height()){d="-top";c=j.offset.top-this.options.edgeOffset-j.arrowSize-j.wrapperHeight;f=j.wrapperHeight}return b.extend(this._getCommonPositioningMap(),{newArrowTop:f,newArrowLeft:Math.floor(j.wrapperWidth/2)-j.arrowSize,newWrapperTop:c,newWrapperLeft:j.offset.left+h-Math.floor(j.wrapperWidth/2),wrapperClass:d})},_getLeftPositioning:function(l,h){var k=this._getOffsetInformation("width",l,h);var j=Math.floor(k.elementHeight/2);var d=Math.floor(k.wrapperHeight/2);var g="-left";var f=k.wrapperWidth;var c=k.offset.left-this.options.edgeOffset-k.arrowSize-k.wrapperWidth;if(c<=0){g="-right";c=k.offset.left+k.elementWidth+this.options.edgeOffset+k.arrowSize;f=k.arrowSize*-1}return b.extend(this._getCommonPositioningMap(),{newArrowTop:d-k.arrowSize,newArrowLeft:f,newWrapperTop:k.offset.top+j-d,newWrapperLeft:c,wrapperClass:g})},_getRightPositioning:function(c,l){var d=this._getOffsetInformation("border-right-width",c,l);var j=Math.floor(d.elementHeight/2);var h=Math.floor(d.wrapperHeight/2);var f="-right";var g=d.arrowSize*-1;var m=d.offset.left+d.elementWidth+this.options.edgeOffset+d.arrowSize;if(m+d.wrapperWidth>=b(window).width()){var k=d.offset.left-this.options.edgeOffset-d.arrowSize-d.wrapperWidth;if(k>=0){f="-left";m=k;g=d.wrapperWidth}}return b.extend(this._getCommonPositioningMap(),{newArrowTop:h-d.arrowSize,newArrowLeft:g,newWrapperTop:d.offset.top+j-h,newWrapperLeft:m,wrapperClass:f})},_setStyleClasses:function(d,f,c){d.attr("class","");this._addStyleClasses(d,f,c);return this},_addStyleClasses:function(d,f,c){if(f){d.addClass(this.widgetBaseClass+f);if(c){d.addClass(this.widgetBaseClass+f+c)}if(this.options.baseClass){d.addClass(this.options.baseClass+f);if(c){d.addClass(this.options.baseClass+f+c)}}}return this},_updateWrapperElement:function(c,d){this._addStyleClasses(d,"-wrapper",c.wrapperClass);d.attr("style","").css({top:c.newWrapperTop+"px",left:c.newWrapperLeft+"px"});if(b.browser.msie&&this.options.position==="left"){d.css("min-width",d.width()+"px")}return this},_updateArrowElement:function(d,c){this._addStyleClasses(c,"-arrow",d.wrapperClass);c.css({top:d.newArrowTop+"px",left:d.newArrowLeft+"px"});return this},_updateContainerElement:function(d,c){this._addStyleClasses(c,"-container",d.wrapperClass);return this},_getIdValue:function(c){return this.widgetNamespace+this.options.subNameSpace+c},_open:function(c){c.stop(true,true);if(this.options.onOpen){if(this.options.fadeIn){c.fadeIn(this.options.fadeIn,function(){that.options.onOpen.call(that,event)})}else{this.options.onOpen.call(that,event)}return this}if(this.options.fadeIn){c.fadeIn(this.options.fadeIn)}else{c.show()}return this},_close:function(){if(this._originalTitle){this.element.attr("title",this._originalTitle);this._originalTitle=null}if(this.options.onClose){this.options.onClose.call(this,event)}return this},_resetElements:function(f,c,d){this._setStyleClasses(f,"-wrapper");this._setStyleClasses(c,"-container");this._setStyleClasses(d,"-arrow");return this}})})(jq||jQuery);(function(a){a.fn.tipTip=function(b){return this.each(function(){return R9.Widgets.Tooltip.getInstance(this,b)})}})(jq||jQuery);(function(h,g){var c={auto:true,delay:6000,button:true,icon:null,escaped:false};function b(){var j={};for(var l=0;l<arguments.length;l++){for(var k in arguments[l]){if(arguments[l].hasOwnProperty(k)){j[k]=arguments[l][k]}}}return j}function f(l){var k=l.containerElement||document.body;var j=k.querySelector(":scope > .r9-toast-container");if(!j){j=document.createElement("div");j.className="r9-toast-container";k.appendChild(j)}return j}function a(m,l){var k=f(l);var j={element:document.createElement("div"),options:b(c,l)};j.element.classList.add("r9-toast-bubble");j.element.classList.add("is-solid");var n=document.createElement("div");n.classList.add("r9-toast-message");if(j.options.escaped){n.innerHTML=m}else{n.appendChild(document.createTextNode(m))}j.element.appendChild(n);if(j.options.icon){j.element.classList.add("has-icon");j.element.classList.add("icon-"+j.options.icon)}if(j.options.button){j.closeButton=document.createElement("div");j.closeButton.classList.add("r9-toast-close");j.closeButton.onclick=function(){d(j)};j.element.appendChild(j.closeButton)}if(j.options.auto){setTimeout(function(){d(j)},j.options.delay)}k.appendChild(j.element);j.element.classList.add("is-visible")}function d(j){j.element.classList.remove("is-visible");setTimeout(function(){j.element.classList.remove("is-solid")},400);setTimeout(function(){try{var k=j.element.parentNode;j.element.parentNode.removeChild(j.element)}catch(l){}},800)}h.Widgets.Toaster={};h.Widgets.Toaster.addToast=a})(R9,jq);(function(c,b){try{c.querySelector(":scope body")}catch(a){["querySelector","querySelectorAll"].forEach(function(f){var d=b[f];b[f]=function(h){if(/(^|,)\s*:scope/.test(h)){var j=this.id;this.id="ID_"+Date.now();h=h.replace(/((^|,)\s*):scope/g,"$1#"+this.id);var g=c[f](h);this.id=j;return g}else{return d.call(this,h)}}})}})(window.document,Element.prototype);(function(){var a=new Date();a.setFullYear(a.getFullYear()+1);jq.datepicker.setDefaults({altFormat:"D M d yy",closeText:"Close",currentText:"Current",dateFormat:"mm/dd/yy",dayNames:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),dayNamesMin:"S,M,T,W,T,F,S".split(","),dayNamesShort:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),firstDay:parseInt("1")-1,maxDate:a,minDate:new Date(),monthNames:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),monthNamesShort:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),prevText:"Prev",nextText:"Next",showAnim:"",showMonthAfterYear:false})})();jq.r9datepicker={parseDate:function(a){return jq.datepicker.parseDate("mm/dd/yy",a)}};jq.fn.r9datepicker=function(l){l.allowEmpty=(l.allowEmpty===false)?false:true;var h=l.defaultDate,b=l.dateFormat||"mm/dd/yy",c="mm/dd/yyyy";if(h){this.val(jq.datepicker.formatDate(b,h,l));jq(l.altField).text(jq.datepicker.formatDate(l.altFormat||"D M d yy",h,l))}else{if(this.val()===""){jq(l.altField).text(c)}}var k=l.beforeShow;var a=l.onClose;var f=l.onSelect;var g=this;var j=function(d,o,m,n){jq(g).trigger(d,[n]);if(o){o(n,m)}};l.beforeShow=function(d,m){j("sbopen",k,d,m)};l.onClose=function(m,d){j("sbclose",a,m,d)};l.onSelect=function(m,d){j("sbset",f,m,d)};return this.attr({autocomplete:"off",autocapitalize:"off",autocorrect:"off"}).datepicker(l)};R9=R9||{};R9.dp=(function(){function a(f,d){return(c(d)-c(f))/86400000}function b(f,g){var d=f[g];delete f[g];return d}function c(f){return Date.UTC(f.getFullYear(),f.getMonth(),f.getDate())}return{doublePicker:function(t,r){var g=t.defaultDate,d=r.defaultDate,k=jq(t.altField),h=jq(r.altField),p=b(t,"onSelect")||jq.noop,n=b(r,"onSelect")||jq.noop,o=jq(b(t,"selector")),m=jq(b(r,"selector")),s=t.resetAfterDays||30,f=t.minRangeDays||0,l=t.numberOfMonths||2,j=r.numberOfMonths||2,q=t.pop2==undefined?true:t.pop2;o.r9datepicker(jq.extend({beforeShowDay:function(u){return[true,(u&&d&&u.getTime()==d.getTime())?"ui-datepicker-marked-day":""]},numberOfMonths:l,onSelect:function(x,w){g=o.datepicker("getDate");var v=d&&a(g,d);if(!d||v>s||v<f){m.datepicker("setDate",null).datepicker("option","defaultDate",g);h.text("mm/dd/yyyy")}p.call(this,x,w);if(q){if(m.is(":visible")&&m.css("visibility")!="hidden"&&!m.is("[disabled]")&&!m.is("[readonly]")){function u(){m.focus()}window.setTimeout(u,50)}}}},t));m.r9datepicker(jq.extend({beforeShowDay:function(u){return[true,(g&&u&&g.getTime()==u.getTime())?"ui-datepicker-marked-day":""]},numberOfMonths:j,onSelect:function(w,v){d=m.datepicker("getDate");var u=g&&a(g,d);if(!g||u<f){o.datepicker("setDate",null).datepicker("option","defaultDate",d);k.text("mm/dd/yyyy")}n.call(this,w,v);m.r9datepicker("hide")}},r))}}})();R9.extend("Social",{deleteControlCookie:function(){document.cookie="ssocontrol=; expires=Thu, 01 Jan 1970 00:00:00 GMT"},doNotLoadThirdPartyScripts:function(){if(document.location.href.match("/hotelreservation")!=null||document.location.href.match("/flightreservation")!=null||document.location.href.match("/carreservation")!=null||document.location.href.match("/bookings/")!=null||document.location.href.match("/trips/")!=null){return true}return false},doNotLoadSocialResources:function(){if(R9.config&&R9.globals&&R9.globals.uiconfig){return R9.config.getBoolean("ui.social.forceOff",false)}return false}});R9.extend("Social.FB",{ensureAPILoaded:function(a){if(R9.Social.doNotLoadSocialResources()){return}if(!window.FB){jq.getScript("//connect.facebook.net/en_US/sdk.js",function(){FB.init({appId:R9.globals.facebookAppId,cookie:false,status:false,xfbml:false,version:"v2.2"});jq(document).trigger("r9.facebook.api.loaded");if(typeof a==="function"){a()}})}else{if(typeof a==="function"){a()}}},login:function(a){jq.get("/vs/fd/topstrip/facebooklogin?action=vs");a=jq.extend({error:jq.noop,perms:"email,user_location",success:jq.noop},a);FB.login(function(b){if(b.authResponse){jq.get("/vs/fd/topstrip/facebooklogin/accept?action=vs");a.success(b.authResponse.accessToken,b.authResponse.userID)}else{jq.get("/vs/fd/topstrip/facebooklogin/reject?action=vs");a.error()}},{scope:a.perms});return false},link:function(b,a){if(FB.getAuthResponse()!=null){FB.logout(function(){AjaxReg.ui.fbLinkWarning(b,a)});return false}else{return R9.Social.FB.login({success:function(c,d){AjaxReg.facebook.link(b,c,d)},perms:a||""})}},verifyLoginStatus:function(){if(R9.Social.doNotLoadThirdPartyScripts()){return}if(document.cookie.indexOf("ssocontrol=fbstatus")!=-1){var a=function(){FB.getLoginStatus(function(b){if(b.authResponse==null){window.location="/k/ident/signout?redir=/"}})};R9.Social.FB.ensureAPILoaded(a)}else{if(document.cookie.indexOf("ssocontrol=fblogout")!=-1){R9.Social.FB.ensureAPILoaded(function(){FB.getLoginStatus(function(b){if(b.authResponse){FB.logout(function(c){R9.Social.deleteControlCookie()})}else{R9.Social.deleteControlCookie()}})})}}}});R9.extend("Social.Google",{initializing:false,ensureAPILoaded:function(a){if(R9.Social.doNotLoadSocialResources()){return}if(!window.gapi&&!this.initializing){this.initializing=true;jq.getScript("https://apis.google.com/js/api:client.js",function(){jq(document).trigger("r9.google.api.loaded");gapi.load("auth2",function(){auth2=gapi.auth2.init({client_id:R9.globals.googleClientId,cookiepolicy:R9.globals.googleCookiePolicy,scope:"profile email"});this.initializing=false;if(typeof a==="function"){a()}})})}else{if(typeof a==="function"){a()}}},login:function(a){gapi.auth2.getAuthInstance().signIn().then(function(b){a(b.getAuthResponse())});return false},logout:function(a){gapi.auth2.getAuthInstance().signOut()},link:function(a){gapi.auth2.getAuthInstance().signIn().then(function(c){var b=c.getAuthResponse();AjaxReg.google.link(a,b.access_token)})},verifyLoginStatus:function(){if(R9.Social.doNotLoadThirdPartyScripts()){return}return}});R9.extend("Social.Google.Now",{getTokenStatus:function(){if(R9.Social.doNotLoadSocialResources()){return}if(document.cookie.indexOf("nowrequest=true")!=-1){jq.ajax({type:"POST",dataType:"json",url:"/k/run/googleauth/nowtoken/web/status",headers:{"X-CSRF":R9.globals.formtoken},success:function(a){if(!a.hasToken&&a.emailAddress!=undefined){R9.Social.Google.Now.tryTokenUpdate(a.emailAddress)}}})}},tryTokenUpdate:function(a){jq.getScript("https://apis.google.com/js/platform.js?e=PlatformEnableGapiNow",function(){gapi.load("now",function(){gapi.now.getCode([a],{client_id:R9.globals.googleClientId}).then(function(b){jq.ajax({type:"POST",url:"/k/run/googleauth/nowtoken/web/update",headers:{"X-CSRF":R9.globals.formtoken},data:"code="+b.code})},function(b){})})})}});(function(a){R9.extend("XDM",{getScriptSync:function(b){jq.ajax({url:b,dataType:"script",async:false,cache:false})},init:function(){if(!this.xdmRemote){if(typeof easyXDM=="undefined"){this.getScriptSync("/res/js/alien/easyXDM.2.4.19.3.min.js?v=36fea83de0c619505eda7ba421550c19fd2b520d-1")}if(!jq.isPlainObject(window.JSON)){this.getScriptSync("/res/js/mweb/json2.js?v=bfbfbe1f23f464fdc68b5b7f7eaa2453ddfcfaf8-1")}var d="/k/run/auth/xdm/",c=d+"name",b=window.AjaxReg!==undefined?window.AjaxReg.remoteHost:R9.globals.remoteHost;this.xdmRemote=new easyXDM.Rpc({local:c,remote:b+d+"remoteMethods",remoteHelper:b+c,swf:b+"/res/images/swf/easyxdm.2.4.19.3.swf?v=4c1f8f9a5365b1f81c5962d6328a2a648a9f1891-1"},{remote:{postAjax:{},postJSON:{},loadAjax:{}}})}},remotePostAjax:function(c,f,h,b,d){try{this.init();this.xdmRemote.postAjax(c,f,h,b)}catch(g){if(typeof d==="function"){d(g)}}},remotePostJSON:function(c,f,h,b,d){try{this.init();this.xdmRemote.postJSON(c,f,h,b)}catch(g){if(typeof d==="function"){d(g)}}},remoteShowAjax:function(d,g,b,j,c,f){try{this.init();this.xdmRemote.loadAjax(d,g,b,j,c)}catch(h){if(typeof f==="function"){f(h)}}},xdmRemote:null})})(jq||jQuery);(function(c){var b=false;R9.extend("Maps.Google",{channel:"",url:"/gmap?libraries=places,geometry&description=R9.Maps.Google",load:function(h,g){var f=this;if(b){h&&h()}else{var d=[{name:(g&&g!="")?R9.Maps.Google.url+"&channel="+g:R9.Maps.Google.url,callbackInQuery:true}];a(d,function(){f.channel=g;b=true;h&&h()})}},isLoaded:function(){return b}});function a(d,g){d=d.reverse();f();function f(){if(d.length>0){var h=d.pop();R9.Common.Communication.ScriptLoader.load(h.name,f,h.callbackInQuery||false)}else{g&&g()}}}})(jq||jQuery);(function(a){R9.extend("Widgets",{Slider:function(c,b){this.elementNode=c;this.element=a(this.elementNode);if(!this.validateElement()){return this}this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.Slider.prototype",{elementNode:null,element:null,elementWidth:0,elementPositionLeft:0,activeRange:null,handles:[],activeHandle:null,activeHandleIndex:null,startValues:null,mouseMoveDelegate:a.noop,mouseUpDelegate:a.noop,options:{start:a.noop,stop:a.noop,slide:a.noop,min:0,max:100,step:1,values:[],range:true,logarithmic:false,snapToValue:false},init:function(){var b=this.element.data("r9RangeSlider");if(b!=null){this.options.values=b.getValues()}this.element.data("r9RangeSlider",this);var d=this;this.handles=this.element.children(".r9-rangeSlider-handle");this.activeRange=this.element.find(".r9-rangeSlider-activeRange");this.handles.off(".r9RangeSlider").on("mousedown.r9RangeSlider touchstart.r9RangeSlider",function(f){d.mouseDown(f);f.preventDefault();f.stopPropagation(true)});var c=this.options.values;if(!c||c.length<1){c=this.options.range?[this.options.min,this.options.max]:[this.options.min]}this.setValues(c);setTimeout(function(){d.drawActiveRange()},60)},validateElement:function(){return this.element.length>0&&this.element.hasClass("r9-rangeSlider")},mouseDown:function(d){this.activeHandle=d.target;this.activeHandleIndex=null;this.elementWidth=this.element.outerWidth();this.elementPositionLeft=this.element.offset().left;for(var b=0;b<this.handles.length;b++){if(this.activeHandle==this.handles[b]){this.activeHandleIndex=b}}a(this.activeHandle).addClass("r9-rangeSlider-handle-active");var c=this;this.mouseMoveDelegate=function(f){c.mouseMove(f)};this.mouseUpDelegate=function(f){f.stopPropagation(true);c.mouseUp(f)};a(document).bind("mousemove.r9RangeSlider touchmove.r9RangeSlider",this.mouseMoveDelegate).bind("mouseup.r9RangeSlider touchend.r9RangeSlider",this.mouseUpDelegate);this.startValues=[];for(var b=0;b<this.options.values.length;b++){this.startValues[b]=this.options.values[b]}this.options.start(d,this.options.values)},mouseUp:function(c){a(this.activeHandle).removeClass("r9-rangeSlider-handle-active");this.activeHandle=null;this.activeHandleIndex=null;a(document).unbind("mousemove.r9RangeSlider touchmove.r9RangeSlider",this.mouseMoveDelegate).unbind("mouseup.r9RangeSlider touchend.r9RangeSlider",this.mouseUpDelegate);var d=false;if(this.startValues){for(var b=0;b<this.options.values.length;b++){if(this.options.values[b]!=this.startValues[b]){d=true;break}}}else{d=true}this.options.stop(c,this.options.values,d)},mouseMove:function(f){f.preventDefault();f.stopPropagation();var d=f.originalEvent;if(d.touches&&d.touches.length>0){f.pageX=d.touches[0].pageX}else{if(d.changedTouches&&d.changedTouches.length>0){f.pageX=d.changedTouches[0].pageX}}var b=Math.min(this.elementWidth,Math.max(0,f.pageX-this.elementPositionLeft));var g=this.valueForPosition(b/this.elementWidth,this.activeHandleIndex);a(this.activeHandle).css("left",(this.positionForValue(g)*100)+"%").css("z-index","3");for(var c=0;c<this.handles.length;c++){if(this.handles[c]==this.activeHandle){this.options.values[c]=g}}this.drawActiveRange();this.options.slide(f,this.options.values)},getValues:function(){return this.options.values.slice(0)},getValue:function(){return(this.options.values.length>0)?this.options.values[0]:0},setValues:function(c){this.options.values=[];for(var f=0;f<c.length;f++){var g=this.trimAlignValue(c[f]);var b=this.positionForValue(g)*100;var d=2;if(c.length>1&&((f==0&&b>=90)||(f==c.length-1&&b<=10))){d=3}this.options.values.push(g);a(this.handles[f]).css("left",b+"%").css("z-index",d)}this.drawActiveRange();this.options.slide(null,this.options.values)},triggerStop:function(){this.options.stop({},this.options.values,true)},setValue:function(c){var b=this.options.values.slice(0);b[0]=c;this.setValues(b)},getOption:function(b){return this.options[b]},setOption:function(c,d){if(typeof c=="object"){var b=c;for(var c in b){if(b.hasOwnProperty(c)){this.options[c]=b[c]}}}else{this.options[c]=d}this.setValues(this.options.values)},positionForValue:function(f){var c;if(this.options.logarithmic){var d=Math.log(this.options.min);var b=Math.log(this.options.max);var g=(b-d)/1;c=(Math.log(f)-d)/g}else{c=(f-this.options.min)/(this.options.max-this.options.min)}return c.toFixed(5)},valueForPosition:function(c,h){var f;if(this.options.logarithmic&&c!==1){var d=Math.log(this.options.min);var b=Math.log(this.options.max);var g=b-d;f=Math.exp(d+g*c)}else{f=this.options.min+((this.options.max-this.options.min)*c)}f=this.trimAlignValue(f);if(h>0){f=Math.max(f,this.options.values[h-1])}if((h+1)<this.handles.length){f=Math.min(f,this.options.values[h+1])}return f},drawActiveRange:function(){var b=false;var d=0;var c=a(this.handles[this.handles.length-1]).css("left");if(this.options.range){d=a(this.handles[0]).css("left")}if(c&&c.indexOf("%")!=-1||d&&d.indexOf("%")!=-1){b=true}a(this.activeRange).css({left:d,width:(parseInt(c)-parseInt(d))+(b?"%":"")})},trimAlignValue:function(f){if(f<=this.options.min){return this.options.min}if(f>=this.options.max){return this.options.max}var b;if(this.options.snapToValue){b=Math.ceil(Math.pow(10,Math.floor((Math.log(f)/Math.log(10)))-1))}else{b=(this.options.step>0)?this.options.step:1}var d=f%b;var c=f-d;if(Math.abs(d)*2>=b){c+=(d>0)?b:(-b)}f=parseFloat(c.toFixed(5));f=Math.min(f,this.options.max);f=Math.max(f,this.options.min);return f}})})(jq||jQuery);(function(a){R9.extend("Widgets",{NumberBox:function(c,b){this.inputNode=a(c).find("input")[0];this.jqNode=a(c);if(!this.isValidElement()){return this}this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.NumberBox.prototype",{widgetName:"r9NumberBox",inputNode:null,jqNode:null,options:{min:0,max:6,defaultValue:0,callback:a.noop,validator:a.noop},boxValue:0,incrButton:null,decrButton:null,isValidElement:function(){return this.jqNode&&this.jqNode.children().hasClass("incrementor")&&this.jqNode.children().hasClass("decrementor")&&this.jqNode.children().hasClass("numberHolder")},canChange:function(b){return(this.options.validator)?this.options.validator.call(this,b):true},increment:function(){if(this.boxValue<this.options.max&&this.canChange(1)){this.boxValue+=1;this.updateView();this.options.callback.call(this,1);return true}else{this.incrButton.addClass("NumberBox-disabled");return false}},decrement:function(){if(this.boxValue>this.options.min&&this.canChange(-1)){this.boxValue-=1;this.updateView();this.options.callback.call(this,-1);return true}else{this.decrButton.addClass("NumberBox-disabled");return false}},updateView:function(){this.inputNode.value=this.boxValue;if(this.boxValue==this.options.max){this.incrButton.addClass("NumberBox-disabled")}else{if(this.boxValue==this.options.min){this.decrButton.addClass("NumberBox-disabled")}else{this.incrButton.removeClass("NumberBox-disabled");this.decrButton.removeClass("NumberBox-disabled")}}},getValue:function(){return this.boxValue},setValue:function(c,b){c=parseInt(c);if(isNaN(c)||this.boxValue===c){return false}var d=c-this.boxValue;if(!b&&!this.canChange(d)){return false}this.boxValue=c;this.updateView();if(this.options.callback){this.options.callback.call(this,d)}return true},init:function(){this.boxValue=(this.inputNode.value!="")?parseInt(this.inputNode.value,10):0;this.incrButton=this.jqNode.find(".incrementor");this.decrButton=this.jqNode.find(".decrementor");this.jqNode.data(this.widgetName,this);if(this.options.defaultValue>0){this.setValue(this.options.defaultValue)}a(this.inputNode).prop("readonly",true);this.inputNode.value=this.boxValue;var b=this;this.incrButton.unbind("click").click(function(c){b.increment();jq(b.jqNode).trigger("increment");return false});this.decrButton.unbind("click").click(function(c){b.decrement();jq(b.jqNode).trigger("decrement");return false})}})})(jq||jQuery);(function(a){a.fn.NumberBox=function(b){if(typeof b=="undefined"){return a(this).data("r9NumberBox")}else{return this.each(function(){new R9.Widgets.NumberBox(this,b)})}}})(jq||jQuery);(function(a){a.fn.r9RangeSlider=function(c){if(typeof c=="string"&&c=="values"){for(var d=0;d<this.length;d++){var b=a(this[d]).data("r9RangeSlider");if(b){return b.getValues()}}return[]}if(typeof c=="undefined"){for(var d=0;d<this.length;d++){var b=a(this[d]).data("r9RangeSlider");if(b){return b}}return null}return this.each(function(){new R9.Widgets.Slider(this,c)})}})(jq||jQuery);(function(a){R9.extend("Widgets",{Checkbox:function(c,b){this.elementNode=c;this.element=a(this.elementNode);this.icon=a(R9.Widgets.Checkbox.findIconNode(this.elementNode));if(!this.validateElement()){return}this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.Checkbox",{isCheckbox:function(b){return b&&b.nodeName&&b.nodeName.toLowerCase()=="input"&&b.type.toLowerCase()=="checkbox"},isWidgetControlled:function(b){return a(b).hasClass(R9.Widgets.Checkbox.prototype.widgetBaseClass+"-input")},refresh:function(b,c){var d=a(c);d[b.checked?"addClass":"removeClass"](R9.Widgets.Checkbox.prototype.widgetBaseClass+"-icon-checked");d[b.disabled?"addClass":"removeClass"](R9.Widgets.Checkbox.prototype.widgetBaseClass+"-icon-disabled")},findIconNode:function(b){return a(b).closest("[id$='-icon']")},findElementNode:function(b){return document.getElementById(b.id.substring(0,b.id.lastIndexOf("-icon")))}});R9.extend("Widgets.Checkbox.prototype",{widgetName:"checkbox",widgetBaseClass:"r9-checkbox",elementNode:null,element:null,icon:null,options:{click:null,change:null},init:function(){this.bindInputClickEvent();this.bindInputEvent("change",this.handleElementChangeEvent);this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("blur",this.handleElementBlurEvent);this.element.data(this.widgetName,this)},validateElement:function(){return R9.Widgets.Checkbox.isCheckbox(this.elementNode)&&R9.Widgets.Checkbox.isWidgetControlled(this.elementNode)},bindInputEvent:function(b,d){var c=this;b+="."+this.widgetName;this.element.unbind(b).bind(b,function(f){d.call(c,this,R9.Widgets.Checkbox.findIconNode(this),f)})},bindInputClickEvent:function(){if(!a.support.changeBubbles){if(typeof a._data(this.elementNode,"_change_data")=="undefined"){a._data(this.elementNode,"_change_data",this.elementNode.checked)}}this.bindInputEvent("click",this.handleElementClickEvent)},handleElementClickEvent:function(b,c,d){if(this.options.click){this.options.click.apply(this,arguments)}if(!a.support.changeBubbles){if(a._data(b,"_change_data")==b.checked){a(b).trigger("change")}}},handleElementChangeEvent:function(b,c,d){if(this.handleJQueryOnChangeHookForIE(b,c,d)){return}R9.Widgets.Checkbox.refresh(b,c);if(this.options.change){this.options.change.apply(this,arguments)}},handleElementFocusEvent:function(b,c,d){if(b.disabled){return}a(c).addClass(this.widgetBaseClass+"-state-focus");if(this.options.focus){this.options.focus.apply(this,arguments)}},handleElementBlurEvent:function(b,c,d){if(b.disabled){return}a(c).removeClass(this.widgetBaseClass+"-state-focus");if(this.options.blur){this.options.blur.apply(this,arguments)}},handleJQueryOnChangeHookForIE:function(b,c,d){if(!a.support.changeBubbles){if(typeof d=="object"){var f=d.originalEvent||null;if(f&&f.type!=null&&(f.type.match(/(^|\.)click(\.|$)/)&&f.srcElement==c||f.type=="beforeactivate"||f.type=="beforedeactivate")){d.type=f.type;a(b).trigger(d);return true}}}return false}})})(jq||jQuery);(function(a){R9.extend("Widgets",{CheckboxGroup:function(c,b){this.elementNode=c;this.element=a(this.elementNode);this.icon=null;if(!this.validateElement()){return}this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.CheckboxGroup.prototype",true,R9.Widgets.Checkbox.prototype,{widgetName:"checkboxGroup",options:{inputSelector:'input[type="checkbox"]',labelSelector:"label.r9-checkbox-label",iconSelector:"a."+R9.Widgets.Checkbox.prototype.widgetBaseClass+"-icon"},init:function(){this.bindInputEvent("click",this.handleElementClickEvent);this.bindInputEvent("change",this.handleElementChangeEvent);this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("blur",this.handleElementBlurEvent);this.bindInputEvent("mousedown",this.handleElementMouseDownEvent);this.bindLabelEvent("mousedown",this.handleElementMouseDownEvent);this.element.data(this.widgetName,this)},validateElement:function(){return this.element.data(this.widgetName)===undefined},bindInputEvent:function(b,d){var c=this;b+="."+this.widgetName+"Input";this.element.undelegate(this.options.inputSelector,b).delegate(this.options.inputSelector,b,function(f){d.call(c,this,R9.Widgets.Checkbox.findIconNode(this),f)})},bindLabelEvent:function(b,d){var c=this;b+="."+this.widgetName+"Label";this.element.undelegate(this.options.labelSelector,b).delegate(this.options.labelSelector,b,function(g){var f=a("#"+a(this).attr("for")).get(0);d.call(c,f,g)})},handleElementClickEvent:function(b,c,d){if(this.options.click){this.options.click.apply(this,arguments)}},handleElementMouseDownEvent:function(b,c,d){if(this.options.mousedown){this.options.mousedown.apply(this,arguments)}},handleJQueryOnChangeHookForIE:function(b,c,d){if(!a.support.changeBubbles){if(typeof d=="object"){var f=d.originalEvent||null;if(f&&f.type!=null&&(f.type.match(/(^|\.)click(\.|$)/)||f.type=="beforeactivate"||f.type=="beforedeactivate")){d.type=f.type;this.trigger(b,d)}}}return false},trigger:function(b,c){if(typeof c=="object"){c.liveFired=undefined}a(b).trigger(c)}})})(jq||jQuery);(function(a){(function(c){var b=c.fn.prop;c.fn.prop=function(d,f){var g=b.apply(this,arguments);if(typeof f!="undefined"&&(d=="checked"||d=="disabled")){this.each(function(){if(R9.Widgets.Checkbox.isCheckbox(this)&&R9.Widgets.Checkbox.isWidgetControlled(this)){R9.Widgets.Checkbox.refresh(this,R9.Widgets.Checkbox.findIconNode(this))}})}return g}})(a);a.fn.newCheckbox=function(b){return this.each(function(){new R9.Widgets.Checkbox(this,b)})};a.fn.checkboxGroup=function(b){return this.each(function(){new R9.Widgets.CheckboxGroup(this,b)})}})(jq||jQuery);(function(a){R9.extend("Widgets",{TextInput:function(c,b){this.elementNode=c;this.element=a(this.elementNode);if(!this.validateElement()){return}this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.TextInput",{isTextInput:function(b){return b&&b.nodeName&&b.nodeName.toLowerCase()=="input"&&b.type.toLowerCase()=="text"},isWidgetControlled:function(b){return(typeof document.createElement("input").placeholder=="undefined")}});R9.extend("Widgets.TextInput.prototype",{widgetName:"textinput",widgetBaseClass:"r9-textinput",widgetPlaceholderClass:"r9-textinput-placeholder-active",elementNode:null,element:null,options:{click:null,change:null},init:function(){this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("smartyfocus",this.handleElementFocusEvent);this.bindInputEvent("blur",this.handleElementBlurEvent);this.bindFormSubmission();this.element.data(this.widgetName,this);if(!this.element.is(":focus")){this.handleElementBlurEvent(this.elementNode)}},validateElement:function(){return R9.Widgets.TextInput.isTextInput(this.elementNode)&&R9.Widgets.TextInput.isWidgetControlled(this.elementNode)&&this.element.data(this.widgetName)===undefined},bindInputEvent:function(b,d){var c=this;b+="."+this.widgetName;this.element.unbind(b).bind(b,function(f){d.call(c,this,f)})},bindFormSubmission:function(){var d=this;var b="submit."+d.widgetName+d.element.attr("id");var c="form-pre-submit."+d.widgetName+d.element.attr("id");this.element.parents("form").off(b).on(b,function(f){if(d.element.val()==d.element.attr("placeholder")){d.clearPlaceholderText(d.element)}});this.element.parents("form").off(c).on(c,function(f){if(d.element.val()==d.element.attr("placeholder")){d.clearPlaceholderText(d.element)}})},handleElementFocusEvent:function(b,c){if(b.disabled){return}if(a(b).val()==a(b).attr("placeholder")){this.clearPlaceholderText(a(b))}if(this.options.focus){this.options.focus.apply(this,arguments)}},handleElementBlurEvent:function(b,c){if(b.disabled){return}if(a.trim(a(b).val()).length==0){this.setPlaceholderText(b)}if(this.options.blur){this.options.blur.apply(this,arguments)}},clearPlaceholderText:function(b){var c=this;b.removeClass(c.widgetPlaceholderClass).val("")},setPlaceholderText:function(b){var c=this;a(b).addClass(c.widgetPlaceholderClass).val(a(b).attr("placeholder"))}})})(jq||jQuery);(function(a){a.fn.textInput=function(b){return this.each(function(){new R9.Widgets.TextInput(this,b)})}})(jq||jQuery);(function(a){a.fn.textInput=function(b){return this.each(function(){new R9.Widgets.TextInput(this,b)})}})(jq||jQuery);(function(a){R9.extend("Widgets",{Switch:function(c,b){this.elementNode=c;this.element=a(this.elementNode);if((b&&!b.dontValidate)&&!this.validateElement()){return}this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.Switch",{isSwitch:function(b){return b&&b.nodeName&&b.nodeName.toLowerCase()=="input"&&b.type.toLowerCase()=="checkbox"},isWidgetControlled:function(b){return a(b).hasClass(R9.Widgets.Switch.prototype.widgetBaseClass+"-input")},findLabelNode:function(b){return jq(b).siblings(".r9-switch-label")},refresh:function(g){var f=R9.Widgets.Switch.prototype,d="."+f.widgetCover,c=f.widgetOnState,b="."+f.widgetWrapper;var k=a(g).parent(b),h=k.find(d),j=g.checked?k.outerWidth()-h.outerWidth():0;k[g.checked?"addClass":"removeClass"](c);h.css("margin-right",j)}});R9.extend("Widgets.Switch.prototype",true,R9.Widgets.Checkbox.prototype,{widgetName:"switch",widgetBaseClass:"r9-switch",widgetCover:"r9-switch-cover",widgetLabelNodeClass:"r9-switch-label",widgetWrapper:"r9-switch-wrapper",widgetOffText:"r9-switch-offText",widgetOnText:"r9-switch-onText",widgetOnState:"r9-switch-state-on",stepSize:4,options:{change:null,click:null},init:function(){if(R9.Common.Utils.Browsers.isMobileSafari()){this.options.nodraw=true}this.bindInputEvent("change",this.handleElementChangeEvent);this.bindInputEvent("click",this.handleElementClickEvent);this.element.data(this.widgetName,this);R9.Widgets.Switch.refresh(this.elementNode)},bindInputEvent:function(c,f){var b="input."+this.widgetBaseClass+"-input";c+="."+this.widgetName;var d=this;this.element.off(c).on(c,function(g){f.call(d,this,R9.Widgets.Switch.findLabelNode(this),g)})},handleElementClickEvent:function(b,c,d){if(this.options.click){this.options.click.apply(this,arguments)}if(!a.support.changeBubbles){if(a._data(b,"_change_data")==b.checked){a(b).trigger("change")}}},handleElementChangeEvent:function(b,c,d){if(this.handleJQueryOnChangeHookForIE(b,c,d)){return}this._slide();if(this.options.change){this.options.change.apply(this,arguments)}},validateElement:function(){return R9.Widgets.Switch.isSwitch(this.elementNode)&&R9.Widgets.Switch.isWidgetControlled(this.element)&&this.element.data(this.widgetName)===undefined},_toggleOnOff:function(b,d,c){this.element.siblings("."+this.widgetLabelNodeClass).text(b.val()).parent("."+this.widgetWrapper).removeClass(c||"").addClass(d||"").end();this.element.val(b.val())},_slide:function(){var l=this,h,j,k,p=a(this.element.siblings("."+this.widgetCover)),o=Math.round(this.options.stepSize||this.stepSize);k=p.css("margin-right"),j=+(k?k.replace("px",""):0);var n=(j===0),g=p.parent("."+this.widgetWrapper).outerWidth()-p.outerWidth(),b=g;h=n?0:j;var f=b%o,d=f?(n?f:-f):0;function c(){var r=".",s,q;if(n){r+=l.widgetOnText;s="r9-switch-state-on";q=""}else{r+=l.widgetOffText;s="";q="r9-switch-state-on"}l._toggleOnOff(l.element.siblings(r),s,q)}function m(){var r=0,q=false;if(b<0){c();return}if(l.options.nodraw){p.css("margin-right",n?g:0);c();return}p.css("margin-right",h);if(n){r=g-h;if(h+o>=g){q=true;h+=r}else{h+=o}}else{r=h-0;if(h-o<=0){q=true;h-=r}else{h-=o}}b-=(q&&Math.abs(r)>0)?Math.abs(r):o;setTimeout(function(){m()},10)}m()}})})(jq||jQuery);(function(a){R9.extend("Widgets",{ToggleSwitch:function(c,b){this.elementNode=c;this.element=jq(this.elementNode);this.options=jq.extend({},this.options,b);this.init()}});R9.extend("Widgets.ToggleSwitch",{registry:{},isToggleSwitch:function(b){return jq(b).hasClass(R9.Widgets.ToggleSwitch.prototype.widgetBaseClass)},isOn:function(b){return jq(b).is(":checked")&&jq(b).parent().hasClass(R9.Widgets.ToggleSwitch.prototype.widgetCheckedClass)},toggleCss:function(g){var c=R9.Widgets.ToggleSwitch.registry[jq(g).attr("name")];var f=[];if(c.length>0){for(var d=0;d<c.length;d++){f[d]=c[d].options.click;c[d].options.click=function(){}}R9.Widgets.ToggleSwitch.toggle(g);for(var b=0;b<c.length;b++){c[b].options.click=f[b]}}},toggle:function(b){b=(b[0]=="#")?b=b.substring(1):b;jq("label[for='"+b+"']").click()},updateRegistry:function(f,g){var d=R9.Widgets.ToggleSwitch.registry[g];var c=false;for(var b=0;b<d.length;b++){if(f.elementNode===d[b].elementNode){d[b]=f;c=true}}if(!c){d.push(f)}}});R9.extend("Widgets.ToggleSwitch.prototype",{that:this,widgetName:"toggleswitch",widgetBaseClass:"toggleswitch-checkbox",widgetCheckedClass:"toggleswitch-checked",options:{click:function(){},switchOnLogPath:null,switchOffLogPath:null},init:function(){var b=this.element.closest("."+this.widgetName);var c=this.element.attr("name");if(typeof R9.Widgets.ToggleSwitch.registry[c]==="undefined"){R9.Widgets.ToggleSwitch.registry[c]=Array()}R9.Widgets.ToggleSwitch.updateRegistry(this,c);b.on("click",this,this.handleClickEvent)},handleClickEvent:function(c){if(c.target.type!=="checkbox"){var b=c.data;var d=(!jq(this).hasClass("toggleswitch-checked"))?"on":"off";c.data.toggleSwitch(b,d)}},toggleSwitch:function(b,g){var h=b.element.attr("name");var d=R9.Widgets.ToggleSwitch.registry[h];for(var c=0;c<d.length;c++){var f=d[c];if(f.options.click){f.options.click.apply(d[c])}if(g==="on"){if(b.elementNode!==f.elementNode){f.element.attr("checked","checked")}f.element.closest("."+this.widgetName).addClass("toggleswitch-checked");f.logSwitchChange(true)}else{if(b.elementNode!==f.elementNode){f.element.removeAttr("checked")}f.element.closest("."+this.widgetName).removeClass("toggleswitch-checked");f.logSwitchChange(false)}}},logSwitchChange:function(b){if(b&&this.options.switchOnLogPath){R9.Analytics.api.trackEvent(this.options.switchOnLogPath)}else{if(!b&&this.options.switchOffLogPath){R9.Analytics.api.trackEvent(this.options.switchOffLogPath)}}}})})(window.jq||window.jQuery);(function(a){(function(c){var b=c.fn.prop;c.fn.prop=function(d,f){var g=b.apply(this,arguments);if(typeof f!="undefined"&&(d=="checked"||d=="disabled")){this.each(function(){if(R9.Widgets.Switch.isSwitch(this)&&R9.Widgets.Switch.isWidgetControlled(this)){R9.Widgets.Switch.refresh(this,R9.Widgets.Switch.findIconNode(this))}})}return g}})(a);a.fn.r9Switch=function(b){return this.each(function(){new R9.Widgets.Switch(this,b)})}})(jq||jQuery);(function(a){R9.extend("Widgets",{Dropdown:function(c,b){this.elementNode=c;this.element=a(this.elementNode);this.status=a(R9.Widgets.Dropdown.findStatusNode(this.elementNode));this.wrapper=a(R9.Widgets.Dropdown.findWrapperNode(this.elementNode));if(!this.validateElement()){return}this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.Dropdown",{isDropdown:function(b){return b&&b.nodeName&&b.nodeName.toLowerCase()=="select"},isDropdownOption:function(b){return b&&b.nodeName&&b.nodeName.toLowerCase()=="option"},isWidgetControlled:function(b){return a(b).hasClass(R9.Widgets.Dropdown.prototype.widgetBaseClass+"-select")},isWidgetControlledOption:function(b){return R9.Widgets.Dropdown.isWidgetControlled(b.parentNode)},refresh:function(d,j,b){var j=a(j);if(d.disabled){j.addClass(R9.Widgets.Dropdown.prototype.widgetBaseClass+"-wrapper-disabled")}else{j.removeClass(R9.Widgets.Dropdown.prototype.widgetBaseClass+"-wrapper-disabled")}var c=d.selectedIndex;if(c<0){c=0}var g=d.options[c];var b=a(b);var h=a(d).data(R9.Widgets.Dropdown.prototype.widgetName);var f=h?h.options.status:null;if(f){f(d,j,b,g)}else{b.text(g.title||g.text||g.value);d.title=g.title||g.text||g.value}},findStatusNode:function(b){return a(b).closest("a").find("[id$='-status']")},findOptionStatusNode:function(b){return document.getElementById(b.parentNode.id+"-status")},findWrapperNode:function(b){return document.getElementById(b.id+"-wrapper")},findOptionWrapperNode:function(b){return document.getElementById(b.parentNode.id+"-wrapper")},findOptionSelectNode:function(b){return b.parentNode}});R9.extend("Widgets.Dropdown.prototype",{widgetName:"dropdown",widgetBaseClass:"r9-dropdown",elementNode:null,element:null,status:null,wrapper:null,refreshTimer:null,lastSelectedIndex:-1,options:{click:null,change:null,status:null},init:function(){this.bindSelectEvent("click",this.handleElementClickEvent);this.bindSelectEvent("change",this.handleElementChangeEvent);this.bindSelectEvent("keydown",this.handleElementKeydownEvent);this.bindSelectEvent("keyup",this.handleElementKeyupEvent);this.bindSelectEvent("focus",this.handleElementFocusEvent);this.bindSelectEvent("blur",this.handleElementBlurEvent);this.element.data(this.widgetName,this)},validateElement:function(){return R9.Widgets.Dropdown.isDropdown(this.elementNode)&&R9.Widgets.Dropdown.isWidgetControlled(this.element)},bindSelectEvent:function(b,d){var c=this;b+="."+this.widgetName;this.element.unbind(b).bind(b,function(f){d.call(c,this,R9.Widgets.Dropdown.findWrapperNode(this),R9.Widgets.Dropdown.findStatusNode(this),f)})},handleElementClickEvent:function(c,f,b,d){if(this.options.click){this.options.click.apply(this,arguments)}R9.Widgets.Dropdown.refresh(c,f,b);this.stopRefreshLoop(c,f,b)},handleElementChangeEvent:function(c,f,b,d){if(this.options.change){this.options.change.apply(this,arguments)}R9.Widgets.Dropdown.refresh(c,f,b);this.stopRefreshLoop(c,f,b)},handleElementKeydownEvent:function(c,f,b,d){this.startRefreshLoop(c,f,b)},handleElementKeyupEvent:function(c,f,b,d){R9.Widgets.Dropdown.refresh(c,f,b);this.stopRefreshLoop(c,f,b)},handleElementFocusEvent:function(c,f,b,d){if(c.disabled){return}a(f).addClass(this.widgetBaseClass+"-state-focus")},handleElementBlurEvent:function(c,f,b,d){if(c.disabled){return}a(f).removeClass(this.widgetBaseClass+"-state-focus");R9.Widgets.Dropdown.refresh(c,f,b);this.stopRefreshLoop(c,f,b)},startRefreshLoop:function(c,f,b){var d=this;this.lastSelectedIndex=c.selectedIndex;this.refreshTimer=setInterval(function(){d.doRefresh(c,f,b)},100)},stopRefreshLoop:function(c,d,b){if(this.refreshTimer!=null){clearTimeout(this.refreshTimer);this.refreshTimer=null;this.lastSelectedIndex=-1}},doRefresh:function(c,d,b){if(c.selectedIndex!=this.lastSelectedIndex){this.lastSelectedIndex=c.selectedIndex;R9.Widgets.Dropdown.refresh(c,d,b)}}})})(jq||jQuery);(function(a){R9.extend("Widgets",{DropdownGroup:function(c,b){this.elementNode=c;this.element=a(this.elementNode);this.icon=null;if(!this.validateElement()){return}this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.DropdownGroup.prototype",true,R9.Widgets.Dropdown.prototype,{widgetName:"dropdownGroup",options:{inputSelector:"select"},init:function(){this.bindSelectEvent("click",this.handleElementClickEvent);this.bindSelectEvent("change",this.handleElementChangeEvent);this.bindSelectEvent("keydown",this.handleElementKeydownEvent);this.bindSelectEvent("keyup",this.handleElementKeyupEvent);this.bindSelectEvent("focus",this.handleElementFocusEvent);this.bindSelectEvent("blur",this.handleElementBlurEvent);this.element.data(this.widgetName,this)},validateElement:function(){return this.element.data(this.widgetName)===undefined},bindSelectEvent:function(b,d){var c=this;this.element.undelegate(this.options.inputSelector,b).delegate(this.options.inputSelector,b,function(f){d.call(c,this,R9.Widgets.Dropdown.findWrapperNode(this),R9.Widgets.Dropdown.findStatusNode(this),f)})}})})(jq||jQuery);(function(a){R9.extend("Widgets",{DropdownDialog:function(c,b){this.elementNode=c;this.element=a(this.elementNode);this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.DropdownDialog.prototype",{element:null,elementNode:null,content:null,trigger:null,placeholder:null,label:null,icon:null,isOpen:false,widgetName:"dropdownDialog",widgetBaseClass:"r9-dropdownDialog",options:{autoOpen:false,iconClass:"",showIcon:true,contentClass:"",wrapperClass:"",triggerClass:"",content:null,onInit:null,onOpen:null,onClose:null,text:"",placeholder:""},init:function(){this.element.data(this.widgetName,this);this.createWrapper();this.createTrigger();this.createContent();this.bindEvents();if(this.options.autoOpen){this.toggleContent(true)}if(this.options.onInit){this.options.onInit(this)}},bindEvents:function(){var c=this;var b=a("body");function d(g){var f=a(g.target);var h=f.closest("."+c.widgetBaseClass+"-wrapper");if(c.element[0]!=h[0]&&c.isOpen){c.close()}}b.on("click",d);a(c.trigger).click(function(f){c.toggleContent()})},createWrapper:function(){this.element.addClass(this.widgetBaseClass+"-wrapper "+this.options.wrapperClass);if(this.element.hasClass(this.widgetBaseClass+"-open")){this.isOpen=true}},createContent:function(){var b=this.element.find("."+this.widgetBaseClass+"-content");if(b.length){this.content=b}else{this.content=a("<div>",{"class":this.widgetBaseClass+"-content"})}if(this.options.content){a(this.options.content).appendTo(this.content)}if(!b.length){this.element.append(this.content)}},createTrigger:function(){var b=this.element.find("."+this.widgetBaseClass+"-trigger");if(b.length){this.trigger=b}else{this.trigger=a("<a>",{"class":this.widgetBaseClass+"-trigger "+this.options.triggerClass})}this.label=this.trigger.find("."+this.widgetBaseClass+"-label");if(!this.label.length){this.label=a("<span>",{"class":this.widgetBaseClass+"-label"});this.trigger.prepend(this.label)}this.placeholder=this.trigger.find("."+this.widgetBaseClass+"-placeholder");if(!this.placeholder.length){this.placeholder=a("<span>",{"class":this.widgetBaseClass+"-placeholder",text:this.options.placeholder});this.trigger.append(this.placeholder)}if(this.options.showIcon){this.icon=this.trigger.find("."+this.widgetBaseClass+"-icon");if(!this.icon.length){this.icon=a("<span>",{"class":this.widgetBaseClass+"-icon "+this.options.iconClass});this.trigger.append(this.icon)}}if(this.options.text){this.updateLabel(this.options.text)}else{if(this.label.text()){this.updateLabel(this.label.text())}}if(!b.length){this.element.append(this.trigger)}},open:function(){this.isOpen=true;this.element.addClass(this.widgetBaseClass+"-open");if(this.options.onOpen){this.options.onOpen(this)}},close:function(){var b=this.isOpen;this.isOpen=false;this.element.removeClass(this.widgetBaseClass+"-open");if(this.options.onClose){this.options.onClose(b,this)}},toggleContent:function(b){if(b==true){this.open()}else{if(b==false){this.close()}else{if(this.isOpen){this.close()}else{this.open()}}}},updateLabel:function(b){this.label.html(b);if(b+""!="0"&&!b){this.trigger.removeClass(this.widgetBaseClass+"-hasValue")}else{this.trigger.addClass(this.widgetBaseClass+"-hasValue")}},hasValue:function(){return this.trigger.hasClass(this.widgetBaseClass+"-hasValue")}})})(jq||jQuery);(function(){R9.extend("Widgets",{Flippy:function(b,a){this.elementNode=b;this.element=jq(this.elementNode);this.options=jq.extend({},this.options,a);this.init()}});R9.extend("Widgets.Flippy.prototype",{widgetName:"flippy",widgetBaseClass:"r9-flippy",elementNode:null,element:null,chars:null,alphabet:["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z",":","-","(","&nbsp;"],options:{wrapperClass:null,flipDelay:100,startDelay:2000,startOnInit:true,onStart:null,onFinish:null,newValue:null},init:function(){var a=this;this.chars=this.element.children(".%s-char".format(this.widgetBaseClass));if(this.options.wrapperClass){this.element.addClass(this.options.wrapperClass)}if(this.options.startOnInit){a.start()}},start:function(){var a=this;if(typeof this.options.onStart==="function"){this.options.onStart()}if(jq.isArray(this.options.newValue)){}else{var c=a.options.newValue.split("");for(var b=1;c.length<=a.chars.length;b++){c.push("&nbsp;")}jq.each(c,function(d,f){setTimeout(function(){a.createChar(d,f)},a.options.startDelay+(a.options.flipDelay*d))})}},createChar:function(d,h,f){var c=this;var g;h=h.replace(/[\ +]/g,"&nbsp;").toUpperCase();if(d>c.chars.length){var b=jq("<span>",{"class":"%s-char".format(c.widgetBaseClass)});if(f){b.addClass(f)}b.append(jq("<span>",{"class":"%s-char-top".format(c.widgetBaseClass)}));b.append(jq("<span>",{"class":"%s-char-split".format(c.widgetBaseClass)}));b.append(jq("<span>",{"class":"%s-char-content".format(c.widgetBaseClass),html:"&nbsp;"}));g=c.chars.parent().append(b)}else{g=c.chars.eq(d).find(".%s-char-content".format(c.widgetBaseClass))}var j=g.text().trim().toUpperCase();var a=false;if(j.length==0){a=true}jq.each(c.alphabet,function(k,l){if(a){setTimeout(function(){g.html(l)},c.options.flipDelay*k)}if(j==l){a=true}else{if(l==h){a=false}}})}})})(jq||jQuery);(function(a){(function(c){var b=c.fn.val;c.fn.val=function(f){var g=b.apply(this,arguments);if(typeof f!="undefined"){c(this).each(function(){if(R9.Widgets.Dropdown.isDropdown(this)&&R9.Widgets.Dropdown.isWidgetControlled(this)){R9.Widgets.Dropdown.refresh(this,R9.Widgets.Dropdown.findWrapperNode(this),R9.Widgets.Dropdown.findStatusNode(this))}})}return g};var d=c.fn.prop;c.fn.prop=function(f,g){var h=d.apply(this,arguments);if(typeof g!="undefined"){if(f=="disabled"){c(this).each(function(){if(R9.Widgets.Dropdown.isDropdown(this)&&R9.Widgets.Dropdown.isWidgetControlled(this)){R9.Widgets.Dropdown.refresh(this,R9.Widgets.Dropdown.findWrapperNode(this),R9.Widgets.Dropdown.findStatusNode(this))}})}else{if(f=="selected"){c(this).each(function(){if(R9.Widgets.Dropdown.isDropdownOption(this)&&R9.Widgets.Dropdown.isWidgetControlledOption(this)){R9.Widgets.Dropdown.refresh(R9.Widgets.Dropdown.findOptionSelectNode(this),R9.Widgets.Dropdown.findOptionWrapperNode(this),R9.Widgets.Dropdown.findOptionStatusNode(this))}})}}}return h}})(a);a.fn.dropdown=function(b){return this.each(function(){new R9.Widgets.Dropdown(this,b)})};a.fn.dropdownGroup=function(b){return this.each(function(){new R9.Widgets.DropdownGroup(this,b)})}})(jq||jQuery);(function(a){R9.extend("Widgets",{RadiobuttonSet:function(c,b){this.elementNode=c;this.element=a(this.elementNode);if((b&&!b.dontValidate)&&!this.validateElement()){return}this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.RadiobuttonSet",{isRadiobuttonSet:function(b){return b&&b.nodeName&&b.nodeName.toLowerCase()==="span"},isWidgetControlled:function(b){return a(b).hasClass(R9.Widgets.RadiobuttonSet.prototype.widgetBaseClass)},findLabelNode:function(b){return document.getElementById(b.id+"-label")},findRadiobuttonSetNode:function(b){return(b!=null)?b.parentNode:null},refresh:function(b){b.find("input."+R9.Widgets.RadiobuttonSet.prototype.widgetBaseClass).each(function(){var c=a(R9.Widgets.RadiobuttonSet.findLabelNode(this));var d=a(this);if(d.prop("checked")){c.addClass(R9.Widgets.RadiobuttonSet.prototype.widgetBaseClass+"-label-checked")}else{c.removeClass(R9.Widgets.RadiobuttonSet.prototype.widgetBaseClass+"-label-checked")}if(d.prop("disabled")){c.addClass(R9.Widgets.RadiobuttonSet.prototype.widgetBaseClass+"-label-disabled")}else{c.removeClass(R9.Widgets.RadiobuttonSet.prototype.widgetBaseClass+"-label-disabled")}})},applyCallback:function(h,g,b,c){if(!h){return}if(a.isFunction(h)){h.apply(g,b);return}var d=h[c.target.value];if(a.isFunction(d)){d.apply(g,b)}}});R9.extend("Widgets.RadiobuttonSet.prototype",{widgetName:"radiobuttonset",widgetBaseClass:"r9-radiobuttonset",elementNode:null,element:null,options:{change:null,click:null},init:function(){this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("blur",this.handleElementBlurEvent);this.bindInputEvent("change",this.handleElementChangeEvent);this.bindInputEvent("click",this.handleElementClickEvent);this.element.data(this.widgetName,this);R9.Widgets.RadiobuttonSet.refresh(this.element)},bindInputEvent:function(c,f){var b="input."+this.widgetBaseClass;c+="."+this.widgetName;var d=this;this.element.undelegate(b,c).delegate(b,c,function(g){f.call(d,this,R9.Widgets.RadiobuttonSet.findLabelNode(this),g)})},validateElement:function(){return R9.Widgets.RadiobuttonSet.isRadiobuttonSet(this.elementNode)&&R9.Widgets.RadiobuttonSet.isWidgetControlled(this.element)&&this.element.data(this.widgetName)===undefined},handleElementFocusEvent:function(d,b,c){if(d.disabled){return}a(b).addClass(R9.Widgets.RadiobuttonSet.prototype.widgetBaseClass+"-label-focused")},handleElementBlurEvent:function(d,b,c){if(d.disabled){return}a(b).removeClass(R9.Widgets.RadiobuttonSet.prototype.widgetBaseClass+"-label-focused")},handleElementChangeEvent:function(d,b,c){if(d.disabled){return}if(!a.support.changeBubbles){R9.Widgets.RadiobuttonSet.applyCallback(this.options.click,this,arguments,c)}R9.Widgets.RadiobuttonSet.applyCallback(this.options.change,this,arguments,c);R9.Widgets.RadiobuttonSet.refresh(this.element)},handleElementClickEvent:function(d,b,c){if(d.disabled){return}R9.Widgets.RadiobuttonSet.applyCallback(this.options.click,this,arguments,c);R9.Widgets.RadiobuttonSet.refresh(this.element)}})})(jq||jQuery);(function(a){(function(b){var c=b.fn.prop;b.fn.prop=function(d,f){var g=c.apply(this,arguments);if(typeof f!="undefined"&&(d=="disabled"||d=="checked")){b(this).each(function(){if(R9.Widgets.RadiobuttonSet.isRadiobuttonSet(R9.Widgets.RadiobuttonSet.findRadiobuttonSetNode(this))){var h=R9.Widgets.RadiobuttonSet.findRadiobuttonSetNode(this);if(R9.Widgets.RadiobuttonSet.isWidgetControlled(h)){R9.Widgets.RadiobuttonSet.refresh(b(h))}}})}return g}})(a);a.fn.radiobuttonset=function(b){return this.each(function(){new R9.Widgets.RadiobuttonSet(this,b)})}})(jq||jQuery);(function(a){R9.extend("Widgets",{Dialog:function(d,b){if(d.constructor===Array){for(var c=0;c<d.length;c++){if(d[c].tagName&&d[c].tagName==="DIV"){this.elementNode=d[c];break}}}else{this.elementNode=d}this.element=a(this.elementNode);this.options=a.extend({},this.options,b);this.init();return this}});R9.extend("Widgets.Dialog.prototype",{element:null,elementNode:null,positionUpdater:null,dialogWrapper:null,closeButton:null,buttonSetWrapper:null,buttonSet:null,viewPort:null,contentContainer:null,modalLayer:null,widgetName:"dialog",widgetBaseClass:"r9-dialog",spinnerClass:"r9-spinner",popoverBaseClass:"r9-popover",arrow:null,offsets:{right:{x:"right",y:null,height:-36,width:24},left:{x:"left",y:null,height:-36,width:-24},top:{x:null,y:"top",height:-24,width:null},bottom:{x:null,y:"bottom",height:24,width:null}},title:null,header:null,isTouchDevice:false,options:{id:null,title:null,defaultPadding:false,buttons:[],modal:true,allowMultipleDialogs:false,modalOpacity:null,wrapperClass:"",modalBackgroundClass:"",closeButtonClass:"",viewPortClass:"",contentClass:"",titleClass:"",minWidth:275,maxWidth:null,minHeight:100,spinner:false,open:null,display:function(){this.viewPort.show()},opened:null,close:null,removeOnClose:true,useMaxHeight:false,allowUserScroll:false,closeOnEscape:true,closeOnModalClick:true,position:null,direction:"right",top:null,centerModal:true,adjustToScreenHeight:false,referencePoint:null},init:function(){if(!this.options.allowMultipleDialogs&&a(document).data(this.widgetName)){var b=a(document).data(this.widgetName);if(typeof b.close==="function"){a(document).data(this.widgetName).close()}else{b.hide()}}this.element.data(this.widgetName,this);a(document).data(this.widgetName,this);if(this.options.referencePoint!=null){a(document).data(this.widgetName+"-"+this.options.referencePoint,this)}this.isTouchDevice=R9.ui.isTouchDevice();if(this.options.modal){this.createDialogWrapper().hideDocumentScrollBar().createModalLayer()}else{if(a.isNumeric(this.options.modalOpacity)){this.createDialogWrapper().createModalLayer()}}this.createViewPort().createHeader().createContentContainer().createButtonWrapper().createButtons();if(this.options.position){this.createArrow()}if(this.options.allowUserScroll){this.scrollingDialog()}this.build().calculateViewPortWidth().position().bindEvents().open()},build:function(){if(this.options.modal||a.isNumeric(this.options.modalOpacity)){this.dialogWrapper.append(this.modalLayer)}if(this.options.position){this.viewPort.append(this.arrow)}this.header.append(this.title);this.header.append(this.closeButton);this.viewPort.append(this.header);this.contentContainer.append(this.element);this.viewPort.append(this.contentContainer);if(this.options.buttons.length){this.buttonSetWrapper.append(this.buttonSet);this.viewPort.append(this.buttonSetWrapper)}if(this.options.modal||a.isNumeric(this.options.modalOpacity)){a("body").append(this.dialogWrapper.append(this.viewPort.hide()))}else{a("body").append(this.viewPort.hide())}return this},bindEvents:function(){var b=this;if(this.options.modal||a.isNumeric(this.options.modalOpacity)){this.modalLayer.on("click",function(){if(b.options.closeOnModalClick){b.close()}})}this.closeButton.on("click",function(){b.close()});this.positionUpdater=setInterval(function(){b.windowResize()},(1000/60));a(window).on("resize",a.proxy(this.eventWindowResize,b));return this},windowResize:function(c){var b=this;b.calculateViewPortWidth();b.position()},open:function(){if(this.options.open){this.options.open.call(this)}this.options.display.call(this);if(this.options.closeOnEscape){var b=this;var c=function(d){if(d.keyCode===27){a(document).unbind("keyup",c);b.close()}};a(document).bind("keyup",c)}if(this.options.opened){this.options.opened.call(this)}},close:function(){if(this.options.removeOnClose){if(this.dialogWrapper){this.dialogWrapper.remove();this.dialogWrapper=null}if(this.viewPort){this.viewPort.remove();this.viewPort=null}}else{this.reset()}clearInterval(this.positionUpdater);a(window).off("resize",this.eventWindowResize);this.showDocumentScrollbar();if(this.options.close){this.options.close.call(this)}if(a(document).data(this.widgetName)){a(document).removeData(this.widgetName)}},eventWindowResize:function(){this.windowResize()},reset:function(){var b="";a(":focus").blur();if(this.options.modal||a.isNumeric(this.options.modalOpacity)){b=a(this.element).closest(".r9-dialog-wrapper");a(b).find(".r9-dialog-modalBackground").remove()}else{b=a(this.element).closest(".r9-dialog-viewPort")}a(b).find(".r9-dialog-header").remove();a(b).find("[class^='r9-dialog-']").unwrap();a(this.element).unwrap();if(this.dialogWrapper){this.dialogWrapper=null}},createDialogWrapper:function(){this.dialogWrapper=a(document.createElement("div")).addClass(this.widgetBaseClass+"-wrapper "+this.options.wrapperClass);this.dialogWrapper=a.extend(this.dialogWrapper,this);return this},createModalLayer:function(){this.modalLayer=a(document.createElement("div")).addClass(this.widgetBaseClass+"-modalBackground "+this.options.modalBackgroundClass);if(this.options.modalOpacity!=null){if(a.browser!==undefined&&a.browser.msie){this.modalLayer.css("filter","alpha(opacity="+(this.options.modalOpacity*100)+")")}else{this.modalLayer.css({background:"rgba(0,0,0,"+(1-this.options.modalOpacity)+")"})}}return this},createViewPort:function(){this.viewPort=a(document.createElement("div")).addClass(this.widgetBaseClass+"-viewPort "+((this.options.spinner)?this.spinnerClass:"")+" "+((this.options.defaultPadding)?this.widgetBaseClass+"-defaultPadding ":"")+this.options.viewPortClass);if(this.options.id){this.viewPort.attr("id","dialog"+this.options.id)}return this},removeSpinner:function(){if(this.viewPort){this.viewPort.removeClass(this.spinnerClass)}},createButtonWrapper:function(){this.buttonSetWrapper=a(document.createElement("div")).addClass(this.widgetBaseClass+"-buttonwrapper");this.buttonSet=a(document.createElement("div")).addClass(this.widgetBaseClass+"-buttonset");return this},createButtons:function(){var b=this,c=this.options.buttons;this.buttonSetWrapper.remove();this.buttonSet.empty();if(a.isEmptyObject(c)||(a.isArray(c)&&!c.length)){this.viewPort.removeClass(this.widgetBaseClass+"-buttons");return}a.each(c,function(d,f){var g,h;f=a.isFunction(f)?{click:f,text:d}:f;f=a.extend({type:"button","class":"ui-button"},f);g=f.click;f.click=function(){g.apply(b,arguments)};h=f.text;delete f.text;a("<button></button>",f).append(a("<span></span>").text(h)).appendTo(b.buttonSet)});this.viewPort.addClass(this.widgetBaseClass+"-buttons");return this},createArrow:function(){this.arrow=a(document.createElement("div")).addClass(this.popoverBaseClass+"-arrow");this.viewPort.addClass(this.popoverBaseClass+"-viewPort "+this.popoverBaseClass+"-"+this.options.direction);return this},createHeader:function(){this.header=a(document.createElement("div")).addClass(this.widgetBaseClass+"-header");this.closeButton=a(document.createElement("div")).addClass(this.widgetBaseClass+"-closeButton r9-icon-x").addClass(this.options.closeButtonClass);if(a(this.element).attr("title")&&!this.options.title){this.options.title=a(this.element).attr("title")}if(this.options.title){this.createTitle()}return this},createTitle:function(){this.title=a(document.createElement("div")).addClass(this.widgetBaseClass+"-title "+this.options.titleClass).text(this.options.title)},createContentContainer:function(){this.contentContainer=a(document.createElement("div")).addClass(this.widgetBaseClass+"-content "+this.options.contentClass).attr("id","dialogContent"+this.options.id);return this},hideDocumentScrollBar:function(){a("body,html").addClass(getScrollbarSize()>0?"defaultScrollbar":"zeroScrollbar");return this},showDocumentScrollbar:function(){a("body,html").removeClass(getScrollbarSize()>0?"defaultScrollbar":"zeroScrollbar")},position:function(){var b=this;if(!b.options.modal&&b.options.position){b.viewPort.css(b.calculateOffsetCss(a(b.options.position)))}else{var d=parseInt(b.options.width)>a(window).width();var c={};if(b.options.centerModal){c.left="50%";c.marginLeft=-(parseInt(b.options.width)/2)}c.minHeight=(typeof b.options.minHeight==="function")?b.options.minHeight():b.options.minHeight;c.minWidth=(typeof b.options.minWidth==="function")?b.options.minWidth():b.options.minWidth;if(b.options.useMaxHeight){c.height="100%";c.top=0}else{if(b.options.top){c.top=b.options.top}if(b.options.height){b.viewPort.height(b.options.height)}}if(d){a.extend(c,{left:"",marginLeft:"",top:""})}b.viewPort.css(c)}return this},calculateViewPortWidth:function(){var c=this;var b=this.element.width();if(this.options.width){if(parseInt(this.options.width)<=a(window).width()){b=this.options.width}else{b=""}}else{if(b!==0){b+=parseInt(this.element.css("padding-left"),10)+parseInt(this.element.css("padding-right"),10)+parseInt(this.element.css("margin-left"),10)+parseInt(this.element.css("margin-right"),10)+parseInt(this.element.css("borderLeftWidth"),10)+parseInt(this.element.css("borderRightWidth"),10)}if(this.options.maxWidth&&b>this.options.maxWidth){b=this.options.maxWidth}if(this.options.minWidth&&b<this.options.minWidth){b=this.options.minWidth}this.options.width=b}c.viewPort.css("width",b);return this},calculateOffsetCss:function(k){var d=this.getScrollTop();var g=this.getScrollLeft();var c=k.width();var o=k.height();var m=k.get(0).getBoundingClientRect();var h=this.offsets[this.options.direction];var f=(h.x?m[h.x]:m.right-c/2)+(h.width?h.width:-(this.options.minWidth/2));var l=(h.y?m[h.y]:m.bottom-o/2)+h.height;if(this.options.direction==="left"){f-=this.options.minWidth}if(this.options.direction==="top"){l-=this.options.minHeight}if(!this.dialogWrapper){l+=d;f+=g}if(this.options.adjustToScreenHeight){var b=d+a(window).height();var p=l+this.viewPort.height();if(b<p){var n=p-b+5;l=l-n;var j=n+18;this.arrow.css("top",j+"px")}}return{left:f,top:l}},getScrollTop:function(){if(typeof pageYOffset!=="undefined"){return pageYOffset}else{var c=document.body;var b=document.documentElement;b=(b.clientHeight)?b:c;return b.scrollTop}},getScrollLeft:function(){if(typeof pageXOffset!=="undefined"){return pageXOffset}else{var c=document.body;var b=document.documentElement;b=(b.clientWidth)?b:c;return b.scrollLeft}},setTitle:function(b){if(b){if(!this.title){this.options.title=b;this.createTitle()}else{this.title.html(b)}}},scrollingDialog:function(){if(this.options.modal){this.showDocumentScrollbar()}this.dialogWrapper.addClass("fixed-position");var c=this.viewPort;var f=window;var b=this.options.height?this.options.height:c.outerHeight(true);var d=this.options.width?this.options.width:c.outerWidth(true);if(this.options.position!==null){var g=this.calculateOffsetCss(a(this.options.position));c.css({position:"absolute",top:(g.top+a(f).scrollTop()+"px"),left:(g.left+a(f).scrollLeft()+"px"),margin:0})}else{c.css({position:"absolute",top:(((a(f).height()-b)/2)+a(f).scrollTop()+"px"),left:(((a(f).width()-d)/2)+a(f).scrollLeft()+"px"),margin:0})}}})})(jq||jQuery);(function(a){a.fn.Tabs=function(b){return new R9.Widgets.Tabs(this.get(),b).element};R9.extend("Widgets",{Tabs:function(c,b){this.element=a(c);this.options=a.extend({},this.options,b);this.init();return this}});R9.extend("Widgets.Tabs.prototype",{element:null,tabSets:[],options:{tabNavClass:".tabs",tabNavItemClass:".tab",tabPanelsClass:".tab-panels",tabPanelClass:".tab-panel"},init:function(){this.tabSets=[];this.getTabSets().bindEvents()},getTabSets:function(){var b=this;this.element.find(this.options.tabNavClass).each(function(){var g=a(this).data("content");var c=(g)?a(g):a(this).next(b.options.tabPanelsClass);if(!c.length&&g){c=a(this).next(b.options.tabPanelsClass);if(!c.length){console.log("WARNING: Couldn't find content panels for tabs.")}}var d=a(this).find(b.options.tabNavItemClass);var f=c.find(b.options.tabPanelClass);d.each(function(){var l=a(this);var h=l.data("order");var k=a.inArray(l.get(0),d);var j=(h)?a(c).find(b.options.tabPanelClass+"[data-order="+h+"]"):a(f.get(k));if(!j.length&&h){j=a(f.get(k));if(!j.length){console.log("WARNING: Couldn't find content panel for tab.")}}l.data("panel",j)});b.tabSets.push({nav:a(this),panels:c})});return this},bindEvents:function(){var c=this;for(var g=0;g<this.tabSets.length;g++){var f=this.tabSets[g];var d=f.nav.find(this.options.tabNavItemClass);d.each(b,[f]);this.toggleTab(d.first(),f)}function b(h){a(this).on("click",function(){c.toggleTab(a(this),h)})}return this},toggleTab:function(g,f){var d=f.nav.find(this.options.tabNavItemClass);var c=f.panels.find(this.options.tabPanelClass);d.each(function(){a(this).removeClass("selected")});c.each(function(){a(this).removeClass("visible").css({display:"none"})});var b=g.addClass("selected").data("panel").addClass("visible").css({display:"block"})}})})(jq||jQuery);(function(a){R9.extend("Widgets",{UndoBox:function(c,b){this.elementNode=c;this.element=a(this.elementNode);this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.UndoBox.prototype",{widgetName:"undoBox",elementNode:null,element:null,options:{contentDivSelector:"",undoMessageClass:"undoMessage",undoMessage:"",undoLinkClass:"undoLink",undoLinkText:"Undo",doTimeout:true,timeout:60000,undoAction:null,clickAction:null,show:"",hide:""},init:function(){this.element.data(this.widgetName,this);this.build().bindEvents().open();this.setNewTimeout();return this},clearExistingTimeout:function(){if(typeof this.element.data("existingtimeout")!=="undefined"){clearTimeout(this.element.data("existingtimeout"))}return this},setNewTimeout:function(d){this.clearExistingTimeout();if(!this.options.doTimeout){return this}d=d||this.options.timeout;var c=this;var b=setTimeout(function(){c.close()},d);this.element.data("existingtimeout",b);return this},bindEvents:function(){var b=this;a("."+this.options.undoLinkClass,this.element).off("click").on("click",function(){b.action.call(b)});a(this.element).off("click").on("click",function(){if(typeof b.options.clickAction==="function"){b.options.clickAction.apply(b,[b])}});return this},build:function(){var d=a(this.options.contentDivSelector,this.element);if(d.length===0){d=this.element}var c=a(document.createElement("span")).addClass(this.options.undoMessageClass).html(this.options.undoMessage);var b=a(document.createElement("span")).addClass(this.options.undoLinkClass).attr("title",this.options.undoLinkText).html(this.options.undoLinkText);d.html("").append(c).append(b);return this},action:function(){if(typeof this.options.undoAction==="function"){this.options.undoAction();this.close()}return this},open:function(){this.element.show(this.options.show);return this},close:function(){this.element.hide(this.options.hide);return this}})})(jq||jQuery);(function(a){R9.extend("Widgets",{Favorites:function(c,b){this.elementNode=c;this.element=a(this.elementNode);if(!this.validateElement()){return}this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.Favorites.prototype",{widgetName:"r9Favorites",widgetBaseClass:"r9-favorites",elementNode:null,element:null,options:{},init:function(){this.element.data(this.widgetName,this);this.element.delegate(".pinnedItem","mouseover",this.mouseOver);this.element.delegate(".pinnedItem","mouseout",this.mouseOut)},validateElement:function(){return this.element.length>0&&this.element.hasClass(this.widgetBaseClass)&&this.element.data(this.widgetName)===undefined},mouseOver:function(b){var c=b.currentTarget.getAttribute("id").split("-")[1]},mouseOut:function(b){var c=b.currentTarget.getAttribute("id").split("-")[1]},getOption:function(b){return this.options[b]},setOption:function(c,g){var f=this;if(typeof c=="object"){d(c)}else{b(c,g)}this.setValues(this.options.values);function d(j){for(var h in j){if(j.hasOwnProperty(h)){f.options[h]=j[h]}}}function b(h,j){f.options[h]=j}}})})(jq||jQuery);(function(a){R9.extend("Widgets",{FavoritesCount:function(c,b){this.elementNode=c;this.element=a(this.elementNode);if(!this.validateElement()){return this}this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.FavoritesCount.prototype",{widgetName:"r9FavoritesCount",widgetBaseClass:"r9-favoritesCount",elementNode:null,element:null,options:{favorites:null,parentNode:null},init:function(){this.element.data(this.widgetName,this);var b=this;this.updateCount();this.options.favorites.registerListener(R9.Common.Model.Favorites.Events.FAVORITE_ADDED,"ts",function(c,f,d){b.updateCount()});this.options.favorites.registerListener(R9.Common.Model.Favorites.Events.FAVORITE_REMOVED,"ts",function(c,f,d){b.updateCount()})},validateElement:function(){return this.element.length>0&&this.element.hasClass(this.widgetBaseClass)&&this.element.data(this.widgetName)===undefined},updateCount:function(){var b=0;if(this.options.favorites!=null){b=this.options.favorites.count}this.element.text(" ("+b+")")},show:function(){this.options.parentNode.removeClass("hidden")},hide:function(){this.options.parentNode.addClass("hidden")}})})(jq||jQuery);R9.messages=R9.messages||{};R9.messages.like="#msg('hrp.FAVORITES_RESULT_TEXT_TIPTIP')";R9.messages.unlike="#msg('hrp.FAVORITES_RESULT_TEXT_UNLIKE_TIPTIP')";(function(a){R9.extend("Widgets",{Like:function(c,b){this.elementNode=c;this.element=a(this.elementNode);if(!this.validateElement()){return this}this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.Like.prototype",{widgetName:"r9Like",widgetBaseClass:"r9-like",elementNode:null,element:null,options:{liked:false,hotelid:null,favorites:null,anonymous:true},init:function(){this.element.data(this.widgetName,this);for(var b in this.element.data()){if(this.options.hasOwnProperty(b)){if(b==="hotelid"){this.options[b]=this.element.attr("data-hotelid")}else{this.options[b]=this.element.data(b)}}}if(this.options.hotelid!=null&&this.options.favorites.isFavorite(this.options.hotelid)){this.options.liked=true}this.initializeElement();var c=this;this.options.favorites.registerListener(R9.Common.Model.Favorites.Events.FAVORITE_ADDED,"ts",function(d,g,f){if(f.id===c.options.hotelid&&!c.options.liked){c.options.liked=true;c.updateElement()}});this.options.favorites.registerListener(R9.Common.Model.Favorites.Events.FAVORITE_REMOVED,"ts",function(d,g,f){if(f.id===c.options.hotelid&&c.options.liked){c.options.liked=false;c.updateElement()}})},validateElement:function(){return this.element.length>0&&this.element.hasClass(this.widgetBaseClass)&&this.element.data(this.widgetName)===undefined},handleClickEvent:function(c){stopPropagationAndDefault(c);if(this.options.anonymous){var b=this;R9.Analytics.api.trackEvent("favorites/addAnonymous");AjaxReg.regtype="favorites";AjaxReg.ui.login({success:function(){addFavorite(b.options.hotelid,true,function(){location.reload(true);R9Anon=false})}})}else{if(this.options.liked){R9.Analytics.api.trackEvent("favorites/remove");removeFavorite(this.options.hotelid)}else{R9.Analytics.api.trackEvent("favorites/add");addFavorite(this.options.hotelid)}}},updateElement:function(){if(this.options.liked){this.element.addClass("thumbUpBtnActive")}else{this.element.removeClass("thumbUpBtnActive")}},initializeElement:function(){var b=this;this.element.bind("click",function(c){b.handleClickEvent(c)});if(this.options.liked){this.element.addClass("thumbUpBtnActive")}else{this.element.removeClass("thumbUpBtnActive")}}})})(jq||jQuery);(function(a){R9.extend("Widgets",{FavoriteToggle:function(c,b){this.elementNode=c;this.element=a(c);if(!this.validateElement()){return this}this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.FavoriteToggle.prototype",{widgetName:"r9FavoriteToggle",widgetBaseClass:"r9-FavoriteToggle",elementNode:null,element:null,options:{favorites:null,hotelDataKey:"data-hotelid",hotelID:null,userFavorite:null},init:function(){this.element.data(this.widgetName,this);if(!this.options.hotelID){this.options.hotelID=this.element.attr(this.options.hotelDataKey)}this.options.favorites=this.options.favorites||window.favorites;if(!this.options.favorites||!this.options.hotelID){return}this.options.userFavorite=this.options.favorites.isFavorite(this.options.hotelID);this.initializeElement();var c=this;var b=function(d,g,f){if(!f){return}if(f.id===c.options.hotelID){c.options.userFavorite=!c.options.userFavorite;c.updateElement()}};this.options.favorites.registerListener(R9.Common.Model.Favorites.Events.FAVORITE_ADDED,"tfid",b);this.options.favorites.registerListener(R9.Common.Model.Favorites.Events.FAVORITE_REMOVED,"tfid",b)},validateElement:function(){var b=this.element;return b&&(b.length>0)&&b.hasClass(this.widgetBaseClass)&&(b.data(this.widgetName)===undefined)},handleClickEvent:function(b){stopPropagationAndDefault(b);if(this.element.hasClass("userPendingFavorite")){return}this.element.addClass("userPendingFavorite");if(this.options.userFavorite){R9.Analytics.api.trackEvent("favorites/remove");removeFavorite(this.options.hotelID)}else{R9.Analytics.api.trackEvent("favorites/add");addFavorite(this.options.hotelID)}},updateElement:function(){this.element.removeClass("userPendingFavorite");if(this.options.userFavorite){this.element.addClass("userFavorite")}else{this.element.removeClass("userFavorite")}},initializeElement:function(){var b=this;this.element.bind("click",function(c){b.handleClickEvent(c)});this.updateElement()}})})(jq||jQuery);(function(a){R9.extend("Widgets",{Share:function(c,b){this.elementNode=c;this.element=a(this.elementNode);this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.Share.prototype",true,R9.Widgets.RadiobuttonSet.prototype,{widgetName:"r9Share",widgetBaseClass:"r9-radiobuttonset",elementNode:null,element:null,options:{shareUrl:"",facebookCallback:a.noop,twitterCallback:a.noop,mailCallback:a.noop,linkCallback:a.noop,defaultCallback:function(d,b,c){alert("callback not implemented")}},handleElementClickEvent:function(d,b,c){switch(d.value){case"facebook":this.options.facebookCallback(d,b,c);break;case"twitter":this.options.twitterCallback(d,b,c);break;case"mail":this.options.mailCallback(d,b,c);break;case"link":this.options.linkCallback(d,b,c);break;default:this.options.defaultCallback(d,b,c);break}},handleElementChangeEvent:function(){}})})(jq||jQuery);(function(a){a.fn.newDialog=function(b){return new R9.Widgets.Dialog(this.get(),b).element};a.fn.newDropdownDialog=function(b){return new R9.Widgets.DropdownDialog(this.get(),b).element}})(jq||jQuery);(function(a){R9.extend("Widgets.Smarty",{Smarty:function(c,b){this.elementNode=c;this.element=a(this.elementNode);if(!this.validateElement()){return}this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.Smarty.Smarty",{isInput:function(b){return b&&b.nodeName&&b.nodeName.toLowerCase()=="input"},isWidgetControlled:function(b){return a(b).hasClass(R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass+"-input")},getDropdownEl:function(b){return jq(b).find("#smartbox")},getDropdownId:function(b){return"smartbox"}});R9.extend("Widgets.Smarty.Smarty.prototype",{widgetName:"smarty",widgetBaseClass:"r9-smarty",elementNode:null,element:null,dropdown:null,lastValue:null,lastClickOnScrollbar:false,keyTimeout:null,isItemSet:false,options:{minLength:0,appendTo:"body",initialData:null,searchOnFocus:false,showDropdownWhenEmpty:false,dataSource:null,dataType:"text",minWidth:10,maxWidth:1024,position:"left",dropdownClass:null,setItem:null,beforeStart:null,afterDone:null,dropdownListSelector:"ul li[class!='separator']",keyDelay:200,forceSelection:false,makeHTML:null,translateItem:null},init:function(){this.initDropdown();if(!(R9.globals.browserCapabilities.scrollbarRetainsInputFocus)){this.trackScrollbarClick()}this.bindInputEvent("focus",this.handleInputFocusEvent);this.bindInputEvent("blur",this.handleInputBlurEvent);this.bindInputEvent("keydown",this.handleInputKeydownEvent);this.bindInputEvent("textchange",this.handleInputChangeEvent);this.element.attr({autocomplete:"off",autocapitalize:"off",autocorrect:"off"});this.element.data(this.widgetName,this);if(this.element.is(":focus")){this.element.focus()}},unInit:function(){this.unbindInputEvent("focus");this.unbindInputEvent("blur");this.unbindInputEvent("keydown");this.unbindInputEvent("textchange");this.dropdown.off("mousedown.trackScrollbarClick");jq("body").off("click.trackScrollbarClick")},initDropdown:function(){var c=R9.Widgets.Smarty.Smarty.getDropdownEl(this.element);var g=R9.Widgets.Smarty.Smarty.getDropdownId(this.element);var h=jq(c)[0];if(h==null){var b=R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass;if(this.options.dropdownClass){b=b+" "+this.options.dropdownClass}var f={id:g,css:{display:"none",position:"absolute",width:"auto",zIndex:5001}};h=jq("<div></div>",f).appendTo(this.options.appendTo)[0];jq(h).addClass(b)}this.dropdown=jq(h)},validateElement:function(){return R9.Widgets.Smarty.Smarty.isInput(this.elementNode)&&R9.Widgets.Smarty.Smarty.isWidgetControlled(this.element)},trackScrollbarClick:function(){var b=this;b.dropdown.on("mousedown.trackScrollbarClick",function(c){b.lastClickOnScrollbar=true;c.stopPropagation();jq("body").trigger("event",[c])});jq("body").on("click.trackScrollbarClick",function(c){if(R9.Common.Utils.Browsers.isIE()&&b.lastClickOnScrollbar){b.lastClickOnScrollbar=false;b.element.blur()}b.lastClickOnScrollbar=false})},bindInputEvent:function(b,d){var c=this;b+="."+this.widgetName;this.element.off(b).on(b,function(f){return d.call(c,this,f)})},unbindInputEvent:function(b){b+="."+this.widgetName;this.element.off(b)},bindDropdownEvent:function(b,d){var c=this;this.dropdown.off(b,this.options.dropdownListSelector).on(b,this.options.dropdownListSelector,function(f){d.call(c,this,f)})},handleInputKeydownEvent:function(k,c){var f=27,l=9,b=18,n=38,j=40,d=37,h=39,g=13;var m=c.keyCode?c.keyCode:c.which;switch(m){case n:this.highlitePrevItem();return false;case j:this.highliteNextItem();return false;case f:return !this.hideDropdown();case g:return this.selectHighlightedItemWhenSearchCompleted(m);case l:this.selectHighlitedItem(m);break;default:this.abortSearchCompletedEventListeners()}},handleInputChangeEvent:function(d,b){if((!R9.Common.Utils.Browsers.isIE(10)&&!R9.Common.Utils.Browsers.isIE(11))||this.element.is(":focus")){this.abortKeyTimeout();this.abortRequest();this.onInputChange();var c=this;this.keyTimeout=setTimeout(function(){c.keyTimeout=null;c.handleInputValue()},this.options.keyDelay)}},onInputChange:function(){this.isItemSet=false;var b=this.getHighlitedItem();if(b&&!this.itemMatches(b,this.element.val())){this.removeItemHighlite()}if(typeof this.options.clearItem==="function"){this.options.clearItem(this)}try{if(this.element){jq(this.element).removeClass("smarty-complete");jq(this.element).addClass("smarty-incomplete")}}catch(c){}},handleInputValue:function(){if(this.options.showDropdownWhenEmpty||(this.element.size()&&this.element.val().length>0)){this.abortRequest();this.runSearch(true)}else{this.hideDropdown()}},handleInputFocusEvent:function(c,f){jq(c).trigger("smartyfocus");var d=this;if(d.lastClickOnScrollbar){return}var b=function(){if(d.checkAlive()){setTimeout(b,250)}};setTimeout(b,250);this.onBeforeStart();if(this.runSearchOnFocus()){if(this.element.val().length==0&&!this.runNoQuerySearch()){this.showInitialDropdown()}else{this.runSearch(false)}}},runSearchOnFocus:function(){return this.options.searchOnFocus},runNoQuerySearch:function(){return this.options.searchNoQuery},onBeforeStart:function(){if(typeof this.options.beforeStart==="function"){this.options.beforeStart(this)}},handleInputBlurEvent:function(b,d){var c=this;setTimeout(function(){if(c.lastClickOnScrollbar){if(!R9.Common.Utils.Browsers.isIE()){c.element.focus();c.lastClickOnScrollbar=false}return}else{c.stopInputProcessing();if(c.hideDropdown()&&c.options.forceSelection){c.onForceSelection()}c.onAfterDone()}},10)},stopInputProcessing:function(){if(this.isUpdateInProgress()){this.abortKeyTimeout();this.abortRequest();this.removeItemHighlite()}},isUpdateInProgress:function(){return(this.keyTimeout||this.request)},onForceSelection:function(){if(!this.itemSet){var b=this.getHighlitedItem();if(b){this.selectItem(b,null)}}},onAfterDone:function(){if(typeof this.options.afterDone==="function"){this.options.afterDone(this)}},handleItemMouseoverEvent:function(c,b){this.getItemList().removeClass("selected");jq(c).addClass("selected")},handleItemMouseoutEvent:function(c,b){jq(c).removeClass("selected")},handleItemMousedownEvent:function(c,b){b.stopPropagation();jq("body").trigger("event",[b]);this.selectItem(c,null);this.hideDropdown()},selectHighlitedItem:function(f){var g=13;var d=this.getItemList();if(!d){if(f==13){this.noItemToSelect()}return}var b=this.getHighlitedItemIndex();if(b<0){if(f==13){this.noItemToSelect()}return}var c=d[b];if(!c){return}this.selectItem(c,f)},selectHighlightedItemWhenSearchCompleted:function(c){var b=this;if(this.isItemSet){return true}this.selectHighlitedItem(c);this.hideDropdown(true);this.element.one("searchCompleted",function(){b.selectHighlitedItem(c);b.hideDropdown()});return false},noItemToSelect:function(){},selectItem:function(b,c){b=this.translateItem(b);this.setItem(b,c)},translateItem:function(b){if(typeof this.options.translateItem==="function"){return this.options.translateItem(b)}return b},setItem:function(b,d){if(this.element){try{if(b){jq(this.element).addClass("smarty-complete");jq(this.element).removeClass("smarty-incomplete")}else{jq(this.element).addClass("smarty-incomplete");jq(this.element).removeClass("smarty-complete")}}catch(c){}}if(typeof this.options.setItem==="function"){this.isItemSet=true;this.options.setItem(this,b,d)}else{if(b){this.isItemSet=true;this.element.val(jq(b).text())}else{this.isItemSet=false;this.element.val("")}}},showInitialDropdown:function(){var b=this.onInitialData();if(b){this.searchCompleted(b,false)}},onInitialData:function(){var b=null;if(typeof this.options.initialData==="function"){b=this.options.initialData(this)}else{b=this.options.initialData}return b},runSearch:function(b){if(this.element.val().length<this.options.minLength){return}var f=this.element.val();if(this.lastValue==f){return}var c=this.getRequestData();c=this.preprocessRequest(c);var d=this;var g=function(h){d.request=null;d.lastValue=f;h=d.postprocessResponse(h,b);d.searchCompleted(h,b)};if(typeof this.options.dataSource==="function"){this.options.dataSource(c,g)}else{this.request=jq.post(this.options.dataSource,c,g,this.options.dataType)}},preprocessRequest:function(b){return b},getRequestData:function(){return{value:this.element.val(),formtoken:R9.globals.formtoken}},searchCompleted:function(c,b){if(c){this.showDropdown(c,b)}else{this.hideDropdown()}this.element.trigger("searchCompleted",!!c)},abortSearchCompletedEventListeners:function(){this.element.off("searchCompleted")},postprocessResponse:function(c,b){return c},makeHTML:function(b){if(typeof this.options.makeHTML==="function"){return this.options.makeHTML(b)}return b},showDropdown:function(c,k){this.dropdown[0].innerHTML=this.makeHTML(c);var l=R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass;if(this.options.dropdownClass){l=l+" "+this.options.dropdownClass}this.dropdown.attr("class",l);var f=this.dropdown[0].style;var b=this.dropdown.outerWidth(true);var d=false;if(this.options.minWidth&&b<this.options.minWidth){b=Math.max(this.options.minWidth,b);d=true}if(this.options.maxWidth&&b>this.options.maxWidth){b=Math.min(this.options.maxWidth,b);d=true}if(d){f.width=b+"px"}else{f.width="auto"}var g=this.element.offset();var h=jq(this.options.appendTo).offset();var j=g.left-h.left;if(this.options.position==="right"){j+=this.element.width()-b-2}f.left=j+"px";f.top=(g.top+this.element.outerHeight()-h.top)+"px";f.display="inline";this.bindDropdownEvent("mousedown",this.handleItemMousedownEvent);this.bindDropdownEvent("mouseover",this.handleItemMouseoverEvent);this.bindDropdownEvent("mouseout",this.handleItemMouseoutEvent);if(this.getHighlitedItemIndex()!=0){this.removeItemHighlite();if(k&&this.element.val()!=""){this.highlightFirstNonHistoryItem()}}},isDropdownHidden:function(){return this.dropdown.css("display")=="none"},hideDropdown:function(b){if(!b){this.abortKeyTimeout();this.abortRequest()}this.lastValue=null;if(this.isDropdownHidden()){return false}this.dropdown.hide();return true},abortRequest:function(){if(this.request){try{this.request.abort()}catch(b){}this.request=null}},abortKeyTimeout:function(){if(this.keyTimeout){clearTimeout(this.keyTimeout);this.keyTimeout=null}},highliteNextItem:function(){var c=this.getItemList();var b=nsel=this.getHighlitedItemIndex();if(b==-1){nsel=0}else{if(b<c.length-1){nsel=b+1}}if(b!=nsel){jq(c[b]).removeClass("selected");jq(c[b]).trigger("mouseout");jq(c[nsel]).addClass("selected");jq(c[nsel]).trigger("mouseover")}},highlitePrevItem:function(){var c=this.getItemList();var b=nsel=this.getHighlitedItemIndex();if(b==-1){nsel=0}else{if(b>0){nsel=b-1}}if(b!=nsel){jq(c[b]).removeClass("selected");jq(c[b]).trigger("mouseout");jq(c[nsel]).addClass("selected");jq(c[nsel]).trigger("mouseover")}},highlightFirstNonHistoryItem:function(){var d=this.getItemList();for(var b=0;b<d.length;b++){var c=jq(d[b]);if(c.hasClass("hist")){continue}else{c.addClass("selected");return}}jq(d[0]).addClass("selected")},removeItemHighlite:function(){jq(this.getItemList()).removeClass("selected")},getHighlitedItemIndex:function(){var b=this.getItemList();for(i=0;i<b.length;i++){if(jq(b[i]).hasClass("selected")){return i}}return -1},getHighlitedItem:function(){var b=this.getItemList();for(i=0;i<b.length;i++){if(jq(b[i]).hasClass("selected")){return b[i]}}return null},getItemList:function(){return this.dropdown.find(this.options.dropdownListSelector)},itemMatches:function(c,b){if(c){return jq(c).text().toLowerCase().indexOf(b.toLowerCase())>=0}return false},checkAlive:function(){if(!this.element.closest("html").length){this.hideDropdown();this.unInit();return false}else{if(!this.element.is(":visible")){this.hideDropdown();return false}}return true}})})(jq||jQuery);R9.extend("Widgets.Smarty",{FlareSmarty:function(c,b){R9.Widgets.Smarty.Smarty.call(this,c,jq.extend({dataSource:"http://www.kayak.com/f/smarty"},b));var a=this;jq(".mapViewOuter .filterWrapper").scroll(function(){R9.Widgets.Smarty.Smarty.prototype.handleInputBlurEvent.call(a)})}});R9.extend("Widgets.Smarty.FlareSmarty",true,{setRunSearchNextFocus:function(a){R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus=a},runSearchNextFocus:true});R9.extend("Widgets.Smarty.FlareSmarty.prototype",true,R9.Widgets.Smarty.Smarty.prototype,{translateItem:function(d){if(!d){return null}var b=d.id.split("-");var g="";if(b.length>1){g=b[1]}var f=jq(d).find("span.nearbyHotels").length>0?(jq(d).find("span.nearbyHotels").remove(),jq(d).text()):jq(d).text();var f=jq(d).find("span.airportCode, span.region-label").length>0?(jq(d).find("span.airportCode, span.region-label").remove(),jq(d).text()):jq(d).text();var a={type:b[0],id:g,str:f,short_str:jq(d).attr("data-short-name")};if(a.type=="isl"&&b.length>1){var c=b[1].split("/");a.str=c[0]}if(b.length>2){a.hc=b[2]}if(b.length>3){if(a.type==="hotel"){a.hid=b[3]}else{if(a.type==="rest"){a.rtid=b[3]}else{if(a.type==="freereg"){a.frid=b[3]}else{if(a.type==="reg"){a.rid=b[3]}else{if(a.type==="ctry"){a.cid=b[3]}else{if(a.type==="hood"){a.nhid=b[3]}else{a.lmid=b[3]}}}}}}}return a},preprocessRequest:function(b){var c={};if(this.options.extendRequest){if(typeof this.options.extendRequest==="function"){c=this.options.extendRequest(this,b)}else{c=this.options.extendRequest}}var a={};if(this.options.v){a.v=this.options.v}a.f="h";if(this.options.f){a.f=this.options.f}a.where=b.value;a.s=this.getFlareSmartyType();a.lc_cc=R9.globals.locale.lc_cc;a.lc=R9.globals.locale.lc;return jq.extend(a,c)},runSearchOnFocus:function(){var a=R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus;R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus=true;return R9.Widgets.Smarty.Smarty.prototype.runSearchOnFocus.call(this)&&a},onInitialData:function(){var a=R9.Widgets.Smarty.Smarty.prototype.onInitialData.call(this)||this.makeRecentList(null,true);if(a){return a.replace("</ul>",this.generateLoginBar()+"</ul>")}else{if(this.options.smartyControlGroup&&R9.globals.canLogin){return"<ul>"+this.generateLoginBar(false)+"</ul>"}else{return""}}},postprocessResponse:function(d,c){var b=d&&/<li/i.test(d);var f=this.makeRecentList(c?this.element.val().toUpperCase():null,!b);if(!f&&!b){return null}if(b){if(f){d=d.replace("<ul>","<ul>"+f)}var a=this.generateLoginBar(true)}else{d=f;var a=this.generateLoginBar(false)}d=d.replace("</ul>",a+"</ul>");return d},selectItem:function(c,d){if(jq(c).hasClass("hist")&&this.options.smartyControlGroup){var a=jq(c).data("history-idx");var b=this.options.smartyControlGroup.getHistory();this.options.smartyControlGroup.setFieldsFromHistoryItem(b.history[a],false);if(typeof this.tempState!=="undefined"){delete this.tempState}R9.Analytics.api.trackEvent("smartyHistory/click/historyItem")}else{if(jq(c).hasClass("showHistory")){window.location.assign("/history");R9.Analytics.api.trackEvent("smartyHistory/click/seeAllHistory")}else{if(jq(c).hasClass("signup")){AjaxReg.ui.register();R9.Analytics.api.trackEvent("smartyHistory/click/signUp")}else{c=this.translateItem(c);this.setItem(c,d)}}}},makeRecentList:function(d,b){var f=this.options.recentList;var a=null;if(f&&f.length>0){a="";for(var c=0;c<f.length;c++){if(d&&f[c].display.toUpperCase().indexOf(d)==-1){continue}var g=f[c].display;if(d){g=this.highliteText(g,d)}a+="<li id='"+f[c].code+"' class='"+f[c].className+"' data-short-name='"+f[c].shortName+"'>"+g+"</li>"}if(a!=""){a=(b?"<ul>":"")+"<li class='separator'><b>Recently searched:</b></li>"+a+(b?"</ul>":"")}else{a=null}return a}return a},highliteText:function(c,a){a=a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");var b=new RegExp("("+a+")","ig");c=c.replace(b,"<b>$1</b>");return c},getFlareSmartyType:function(){if(this.options.flareSmartyType){return this.options.flareSmartyType}return -1},matchAndBold:function(k,h,g,a){if(!(k&&h)){return h}g=g||"<b>";a=a||"</b>";var l=0;var f=0;var j="";var m=h;var b=k.length;var n=true;k=k.toUpperCase();while(n){if(!(l===0&&(f=h.toUpperCase().indexOf(k,l))===0)){if((f=h.toUpperCase().indexOf(" "+k,l))>-1){f++}else{n=false;break}}var d=h.substring(l,f);var c=h.substring(f,f+b);j+=d+g+c+a;m=h.substring(f+b,h.length);l=f+b}j+=m;return j},handleItemMouseoverEvent:function(d,c){this.getItemList().removeClass("selected");jq(d).addClass("selected");if(jq(d).hasClass("hist")&&this.options.smartyControlGroup&&typeof this.tempState==="undefined"){this.tempState=this.options.smartyControlGroup.saveFieldsToHistoryItem();var a=jq(d).data("history-idx");var b=this.options.smartyControlGroup.getHistory();this.options.smartyControlGroup.setFieldsFromHistoryItem(b.history[a],true)}},handleItemMouseoutEvent:function(b,a){jq(b).removeClass("selected");if(typeof this.tempState!=="undefined"){this.options.smartyControlGroup.setFieldsFromHistoryItem(this.tempState,true);delete this.tempState}},generateLoginBar:function(a){if(!this.options.smartyControlGroup||!R9.globals.canLogin){return""}var b="admin";if(a){b+=" addSeparation"}if(typeof R9Anon!=="undefined"&&R9Anon){return"<li class='signup "+b+"'>Sign up to access recent searches anywhere</li>"}else{return"<li class='showHistory "+b+"'> See all search history</li>"}},generateRecentHeader:function(){R9.Common.SmartyHistory.currentSmarty=this;R9.Common.SmartyHistory.currentSmartyHistory=this.options.smartyControlGroup.getHistory();if(!this.hasClearRecentEvent){this.hasClearRecentEvent=true;this.dropdown.on("mousedown","ul li .clearRecent",function(a){a.stopPropagation();jq("body").trigger("event",[a]);R9.Common.SmartyHistory.SmartyClearHistory()})}return"<li class='separator'><span class='separatorLabel'>Recent</span><a class='clearRecent'>clear history</a></li>"}});R9.extend("Widgets.Smarty",{EmailSmarty:function(b,a){R9.Widgets.Smarty.Smarty.call(this,b,a)}});R9.extend("Widgets.Smarty.EmailSmarty.prototype",true,R9.Widgets.Smarty.Smarty.prototype,{});R9.extend("Widgets.Smarty",{HotelsSmarty:function(b,a){if(R9.config.getBoolean("ui.hotel.smarty-history",false)){R9.Widgets.Smarty.FlareSmarty.call(this,b,jq.extend({minWidth:250,dropdownClass:" smartbox smartbox-hotel smartbox-v2",forceSelection:true,flareSmartyType:29,searchOnFocus:true,extendRequest:{v:"v2"}},a))}else{R9.Widgets.Smarty.FlareSmarty.call(this,b,jq.extend({minWidth:250,dropdownClass:" smartbox smartbox-hotel",forceSelection:true,flareSmartyType:29},a))}}});R9.extend("Widgets.Smarty.HotelsSmarty.prototype",true,R9.Widgets.Smarty.FlareSmarty.prototype,{makeRecentList:function(b,j){if(!this.options.smartyControlGroup){return}var g=this.options.smartyControlGroup.getHistory();b=jq.trim(b);var c=(b=="")?10:5;var h=g.filter(b,c);var k="";for(var f=0;f<h.length;f++){var a=h[f];var d=false;if(f==h.length-1){d=true}k+=this.generateSmartyItem(this.matchAndBold(b,a.location),a.checkinDate,a.checkoutDate,a.idx,a.isPast,d)}if(k!=""){k=(j?"<ul>":"")+this.generateRecentHeader()+k+(j?"</ul>":"")}else{k=null}return k},generateSmartyItem:function(j,l,k,g,a,b){var h=new moment(l);var f=new moment(k);var d=(a)?"past":"";var c=(b)?" last":"";return'<li class="hist '+c+'" data-history-idx="'+g+'"><span class="smartyRecentHotels">'+j+'</span><span class="smartyRecentDate '+d+'">'+h.format(this.options.smartyControlGroup.options.startFormat)+" - "+f.format(this.options.smartyControlGroup.options.endFormat)+"</span></li>"}});R9.extend("Widgets.Smarty",{FlightsSmarty:function(b,a){if(R9.config.getBoolean("ui.flight.smarty-history",false)){R9.Widgets.Smarty.FlareSmarty.call(this,b,jq.extend({minWidth:250,dropdownClass:" smartbox smartbox-air smartbox-v2",forceSelection:true,flareSmartyType:1,searchOnFocus:true,extendRequest:{v:"v2"}},a))}else{R9.Widgets.Smarty.FlareSmarty.call(this,b,jq.extend({minWidth:250,dropdownClass:" smartbox smartbox-air",forceSelection:true,flareSmartyType:1,searchOnFocus:true},a))}}});R9.extend("Widgets.Smarty.FlightsSmarty.prototype",true,R9.Widgets.Smarty.FlareSmarty.prototype,{makeRecentList:function(b,m){if(!this.options.smartyControlGroup){return}var k=this.options.smartyControlGroup.getHistory();var g=this.elementNode.name=="origin";var f=this.elementNode.name=="destination";var d=true;d=this.options.smartyControlGroup.isRoundTrip();b=jq.trim(b);var c=(b=="")?10:5;if(f){var n=jq(this.options.smartyControlGroup.options.originCode).val()}var l=k.filter(b,g,c,d,n);var o="";for(var j=0;j<l.length;j++){var a=l[j];var h=false;if(j==l.length-1){h=true}if(g){o+=this.generateSmartyItem(this.matchAndBold(b,a.departShortName),a.destShortName,a.startDate,a.endDate,a.idx,a.isRoundTrip,a.isPast,h)}else{o+=this.generateSmartyItem(a.departShortName,this.matchAndBold(b,a.destShortName),a.startDate,a.endDate,a.idx,a.isRoundTrip,a.isPast,h)}}if(o!=""){o=(m?"<ul>":"")+this.generateRecentHeader()+o+(m?"</ul>":"")}else{o=null}return o},generateSmartyItem:function(f,d,p,o,n,a,b,c){var m=new moment(p);var l=new moment(o);var k=(b)?"past":"";var j=(c)?" last":"";var g=(a)?"doubleArrow":"singleArrow";var h=(a)?" - "+l.format(this.options.smartyControlGroup.options.endFormat):"";return'<li class="hist '+j+'" data-history-idx="'+n+'"><span class="smartyRecentAirports">'+f+'<span class="arrow '+g+'"></span>'+d+'</span><span class="smartyRecentDate '+k+'">'+m.format(this.options.smartyControlGroup.options.startFormat)+h+"</span></li>"}});R9.extend("Widgets.Smarty",{CarsSmarty:function(b,a){if(R9.config.getBoolean("ui.car.smarty-history",false)){R9.Widgets.Smarty.FlareSmarty.call(this,b,jq.extend({minWidth:250,dropdownClass:" smartbox smartbox-car smartbox-v2",forceSelection:true,flareSmartyType:2,searchOnFocus:true,extendRequest:{v:"v2"}},a))}else{R9.Widgets.Smarty.FlareSmarty.call(this,b,jq.extend({minWidth:250,dropdownClass:" smartbox smartbox-car",forceSelection:true,flareSmartyType:2},a))}}});R9.extend("Widgets.Smarty.CarsSmarty.prototype",true,R9.Widgets.Smarty.FlareSmarty.prototype,{makeRecentList:function(b,m){if(!this.options.smartyControlGroup){return}var j=this.options.smartyControlGroup.getHistory();var f=this.elementNode.name=="location";var d=this.elementNode.name=="location2";var l=true;l=this.options.smartyControlGroup.isOneWay();b=jq.trim(b);var c=(b=="")?10:5;var k=j.filter(b,f,c,l);var n="";for(var h=0;h<k.length;h++){var a=k[h];var g=false;if(h==k.length-1){g=true}if(f){n+=this.generateSmartyItem(this.matchAndBold(b,a.location),a.location2,this.matchAndBold(b,a.airportCode),a.airportCode2,a.cityName,a.cityName2,a.startDate,a.endDate,a.idx,l,a.isPast,g)}else{n+=this.generateSmartyItem(a.location,this.matchAndBold(b,a.location2),a.airportCode,this.matchAndBold(b,a.airportCode2),a.cityName,a.cityName2,a.startDate,a.endDate,a.idx,l,a.isPast,g)}}if(n!=""){n=(m?"<ul>":"")+this.generateRecentHeader()+n+(m?"</ul>":"")}else{n=null}return n},generateSmartyItem:function(g,f,c,b,s,p,q,o,h,m,a,k){var t=new moment(q);var r=new moment(o);var u=(a)?"past":"";var j=(k)?" last":"";if(m){var n=c||s;var l=b||p;return'<li class="hist '+j+'" data-history-idx="'+h+'"><span class="smartyRecentCars">'+n+'<span class="arrow singleArrow"></span>'+l+'</span><span class="smartyRecentDate '+u+'">'+t.format(this.options.smartyControlGroup.options.startFormat)+" - "+r.format(this.options.smartyControlGroup.options.endFormat)+"</span></li>"}else{if(c!==null){var d='<span class="airportCode">'+c+"</span>"+g}else{d=g}return'<li class="hist '+j+'" data-history-idx="'+h+'"><span class="smartyRecentCars">'+d+'</span><span class="smartyRecentDate '+u+'">'+t.format(this.options.smartyControlGroup.options.startFormat)+" - "+r.format(this.options.smartyControlGroup.options.endFormat)+"</span></li>"}}});R9.extend("Widgets.Smarty",{DealsSmarty:function(b,a){R9.Widgets.Smarty.FlareSmarty.call(this,b,jq.extend({minWidth:250,dropdownClass:" smartbox smartbox-deal",forceSelection:true,flareSmartyType:7},a))}});R9.extend("Widgets.Smarty.DealsSmarty.prototype",true,R9.Widgets.Smarty.FlareSmarty.prototype,{});(function(b,a){R9.extend("Widgets.Smarty",{PackageToursSmarty:function(d,c){this.ptOptions=b.extend({},this.ptOptions,c.ptOptions);R9.Widgets.Smarty.FlareSmarty.call(this,d,b.extend({dropdownClass:" smartbox smartbox-packagetour",forceSelection:true,searchOnFocus:true,flareSmartyType:17},c))}});R9.extend("Widgets.Smarty.PackageToursSmarty.prototype",true,R9.Widgets.Smarty.FlareSmarty.prototype,{hiddenInput:null,searchInput:null,suggestionsXml:null,setItemFromSmarty:false,tagsContainer:null,tags:{},tagsIds:[],isSubmitEnabled:false,skipActiveSubmit:false,skipSuggestionsShowing:false,isPlaceHolderSupported:false,ptOptions:{},init:function(){R9.Widgets.Smarty.FlareSmarty.prototype.init.call(this);this.extendOptions();this.tags={};this.tagsIds=[];this.searchInput=b(this.element);this.hiddenInput=b(this.ptOptions.hiddenInput);this.isPlaceHolderSupported=this.checkIsPlaceHolderSupported();this.initTags();this.bindSearchInputEvents()},extendOptions:function(){var c=this;b.extend(true,this.options,{initialData:function(){return c.getSuggestions()},setItem:function(h,j,f){var k=j,m={},l={},g=c.searchInput;var d=function(p){var n=p.name;if(!p||!p.id||!n){return}var q=p.id;var o=c.clearHtml(n);c.addSearchValue(q,o,true)};if(k.isSuggestionParent){g.val("").removeClass("focus");return}c.setItemFromSmarty=true;d(k)}})},makeHTML:function(g){var h=this;var k=g;var f='<?xml version="1.0" encoding="UTF-8"?>';var j=k.replace("</ul></ul>","</ul>").replace(f,"");var c=b(j);c.find("li").each(function(r){var p=b(this);var o=h.getSmartBoxElementData(p,false),t=null;if(!o){return}p.attr("data-attr",JSON.stringify(o));t=b("<div>");var n=o.nearbyHotels;if(n&&0!==n.length){t.append(b("<span>").addClass("nearbyHotels").append(n))}var m=b("<span>",{"class":"fullNameHolder",css:{display:"block",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}}).css("oveflow","hidden");var d=o.name;if(d&&0!==d.length){m.append(b("<span>").addClass("name").append(d))}var l=o.parentPath;if(l&&0!==l.length){var s=b("<span>").addClass("parentPath").append(l);if(o.isSuggestion){m.append(", ")}else{var q=" ";if(o.isHotel||o.isNeighborhood){q=" - "}else{q=", "}m.append(q)}m.append(s)}t.append(m);this.innerHTML=t[0].innerHTML});return f+"\n"+c.wrap("<div>").parent().html()},translateItem:function(c){var d=b(c).attr("data-attr");return b.parseJSON(d)},initTags:function(){var c=this.ptOptions.tags;this.tagsContainer=b(c.tagsContainerSelector);if(!this.tagsContainer.length){return}this.bindTagsContainerEvents();this.bindTagEvents();this.bindTagsKeyboardEvents();this.initPlaceHolderStyles();this.togglePlaceHolder()},bindTagsContainerEvents:function(){var c=this.searchInput;this.tagsContainer.on("click",function(d){if(c&&c.is(":visible")){c.focus()}})},bindTagEvents:function(){var f=this;var c=this.ptOptions.tags;var g=c.tagSelector;var d=c.selectedClass;this.tagsContainer.off("click",g).on("click",g,function(j){j.preventDefault();j.stopPropagation();var h=b(this);if(h.hasClass(d)){h.removeClass(d)}else{h.addClass(d);h.siblings(g).removeClass(d)}f.searchInputFocus()});this.tagsContainer.off("click",c.tagCloseSelector).on("click",c.tagCloseSelector,function(j){var h=b(this).closest(c.tagSelector);f.removeTag(h,true);return false})},searchInputFocus:function(){this.skipSuggestionsShowing=true;if(this.searchInput&&this.searchInput.is(":visible")){this.searchInput.focus()}},searchInputFocusOut:function(){this.searchInput.focusout()},bindTagsKeyboardEvents:function(){var h=this;var f=this.ptOptions.tags;var j=f.tagSelector;var g=f.selectedClass;var d=this.searchInput;var c=this.tagsContainer;d.on("keydown",function(o){if(d.val()){return}if(o.which===13){if(h.isSubmitEnabled){if(h.tagsIds.length>0){h.disableSmartBox()}h.skipActiveSubmit=false;d.closest("form").submit()}h.skipActiveSubmit=true;h.isSubmitEnabled=true;return}if(h.tagsIds.length===0){return}var n;switch(o.which){case 8:var m;n=b(j+"."+g,c);if(n.length){h.removeTag(n,true)}else{m=b(j,c).last();if(!m.length){break}m.addClass(g)}h.hideSmartBox();break;case 46:n=b(j+"."+g,c);if(!n.length){break}h.removeTag(n,true);break;case 27:b(j,c).removeClass(g);break;case 37:n=b(j+"."+g,c);if(n.length){var k=n.prev(j);if(!k.length){if(h.tagsIds.length>1){k=b(j,c).last()}else{break}}n.removeClass(g);k.addClass(g)}else{n=b(j,c).last();if(!n.length){break}n.addClass(g)}break;case 39:n=b(j+"."+g,c);if(!n.length){break}var l=n.next(j);if(!l.length){if(h.tagsIds.length>1){l=b(j,c).first()}else{break}}n.removeClass(g);l.addClass(g);break;default:break}})},maxTagsReached:function(){var d=this.ptOptions.tags;var c=this.getCurrentHiddenData();if(c&&d.maxTags<=c.length){return true}return false},addTag:function(d,c,h){var j=this;var m=this.ptOptions.tags;if(!d||!c){return false}var g=b('[data-id="'+d+'"]',this.tagsContainer);if(g.length>0&&(!this.tags||this.tags===[]||this.tags==={})){return false}if(this.tags[d]!==undefined){g.fadeOut(100,function(){g.fadeIn(100);j.searchInput.val("")});return false}if(this.maxTagsReached()){var f=this.tagsIds[this.tagsIds.length-1];this.removeTagById(f,true,true)}var k=b(m.tagTemplate.replace("[[TEXT]]",c));k.attr("data-id",d);var l=b(m.tagSelector,this.tagsContainer).last();if(l.length){l.after(k)}else{this.tagsContainer.prepend(k)}this.tags[d]=c;this.tagsIds.push(d);if(this.tagsIds.length>=m.maxTags){j.disableSmartBox();this.searchInput.addClass(m.hiddenClass)}this.searchInput.val("");if(h===true&&this.tagsIds.length<m.maxTags){this.searchInputFocus()}else{this.searchInputFocusOut()}this.removeItemHighlite();this.addHiddenData(d,c);return true},getItemText:function(d){var f=b(d);var c="";f.each(function(g){if(this.className==="name"){c=b(this).text();return false}});return c},removeTag:function(c,h,d){var g=this;if(!c.length){return}var f=function(){var j=g.ptOptions.tags;var k=c.attr("data-id");var l=g.tagsIds.indexOf(k);delete g.tags[k];g.tagsIds.splice(l,1);c.remove();g.enableSmartBox();g.tagsContainer.removeClass(j.disabledClass);g.searchInput.removeClass(j.hiddenClass);g.removeHiddenData(k);if(b.isEmptyObject(g.tags)){g.clearSearchValues()}if(h===true){g.searchInputFocus()}};if(d){f()}else{c.fadeOut(200,function(){f()})}},removeTagById:function(h,g,d){var f=this.ptOptions.tags;var c=b(f.tagSelector,this.tagsContainer).filter("[data-id="+h+"]");this.removeTag(c,g,d)},getSuggestions:function(){var k=this;if(this.maxTagsReached()||this.skipSuggestionsShowing||b("#"+this.ptOptions.targetId).is(":visible")||!k.searchInput.is(":visible")||k.searchInput.is(":disabled")){return}if(this.suggestionsXml){return this.suggestionsXml}var d=this.ptOptions.suggestions;var l=d.data;if(!l||l.length===0){return}var h=function(w,s,j){var q=w.id;var u=w.type;var o=b.trim(w.name);var t=b.trim(w.nearbyHotels);var r=w.children;if(o===""){return}var v=b("<li>").html("").attr("id",j+"-PT_"+u+q).addClass(s+" type_"+u);if(t&&0!==t.length){v.append(b("<span>").addClass("nearbyHotels").append(d.nearbyHotelsMsg.replace("[[NEARBY_HOTELS_COUNT]]",t)))}v.append(b("<div>").append(o));if(r&&r.length>0){v.addClass("has_children")}return v};var c=b("<div>");var m=b("<ul>").addClass("suggestions");var g;for(g=0;g<l.length;g++){var n=l[g];var p=h(n,"pt_suggestion parent","pt_suggestion_parent");m.append(p);if(n.children&&n.children.length>0){var f;for(f=0;f<n.children.length;f++){p=h(n.children[f],"pt_suggestion children","pt_suggestion_child");m.append(p)}}}c.html(m);this.suggestionsXml='<?xml version="1.0" encoding="UTF-8"?>'+c.html();return this.suggestionsXml},isSearchInputEmpty:function(){var f=b.trim(this.searchInput.val());var c=b.trim(b("#dstEmptyPlaceHolderText").html());var d=b.trim(b("#dstNotEmptyPlaceHolderText").html());if(!f||f===""||f===c||f===d){return true}return false},initPlaceHolderStyles:function(){var c=this.searchInput;var d=c.siblings(".placeholdertext");d.css({position:"absolute",top:-9999999,left:-9999999999,width:"auto",fontSize:c.css("fontSize"),padding:c.css("padding"),fontFamily:c.css("fontFamily"),fontWeight:c.css("fontWeight"),letterSpacing:c.css("letterSpacing"),whiteSpace:"nowrap"})},checkIsPlaceHolderSupported:function(){return document.createElement("input").placeholder!==undefined},togglePlaceHolder:function(){var d=this.ptOptions;var c=10;var g=40;var j=this.searchInput.siblings(".placeholdertext");var k=b("#dstEmptyPlaceHolderText").html();if(this.hasHiddenData()){k=b("#dstNotEmptyPlaceHolderText").html()}j.html(k);if(this.isPlaceHolderSupported){this.searchInput.prop("placeholder",k)}var f=j.width();f=f<g?g:f;var h=f+c;this.searchInput.css("min-width",h)},disableSmartBox:function(){this.searchInput.attr("disabled","disabled");this.searchInput.hide();b("#"+this.ptOptions.targetId).hide()},hideSmartBox:function(){b("#"+this.ptOptions.targetId).hide()},enableSmartBox:function(){if(this.maxTagsReached()){this.disableSmartBox()}else{this.searchInput.removeAttr("disabled");this.searchInput.css("display","inline")}},issetHiddenValue:function(g){var f=this.getCurrentHiddenData();var c=f.length;var d;for(d=0;d<c;d++){if(g===f[d].id){return d+1}}return false},getCurrentHiddenData:function(){var c=b.trim(this.hiddenInput.val());if(c===""||!b.parseJSON(c)){c=b.parseJSON("[]")}return b.parseJSON(c)},hasHiddenData:function(){var c=this.getCurrentHiddenData();if(c&&c.length>0){return true}return false},createHiddenValue:function(d,c){return{id:d,name:c}},addHiddenData:function(g,d){if(this.issetHiddenValue(g)){return}var f=this.createHiddenValue(g,d);var c=this.getCurrentHiddenData();c.push(f);this.hiddenInput.changeHiddenParam(JSON.stringify(c));if(this.maxTagsReached()){this.disableSmartBox()}else{this.enableSmartBox()}this.togglePlaceHolder();if(typeof this.ptOptions.onHiddenChange==="function"){this.ptOptions.onHiddenChange.call()}},onHiddenChange:function(){this.ptOptions.onHiddenChange.call()},removeHiddenData:function(f){var d=this.issetHiddenValue(f);var c=this.getCurrentHiddenData();if(d){c.splice(d-1,1)}this.hiddenInput.changeHiddenParam(JSON.stringify(c));this.enableSmartBox();this.togglePlaceHolder();if(typeof this.ptOptions.onHiddenChange==="function"){this.ptOptions.onHiddenChange.call()}},addSearchValue:function(f,c,d){return this.addTag(f,c,d)},clearSearchValues:function(){var c=this.ptOptions.tags;b(c.tagSelector,this.tagsContainer).remove();this.tags=[];this.tagsIds=[];this.togglePlaceHolder();this.searchInput.val("").removeClass("focus");this.hiddenInput.changeHiddenParam("[]")},bindSearchInputEvents:function(){var g=this;var f=this.ptOptions;var d=this.searchInput;var c=false;d.on("click",function(h){if(d.is(":disabled")){return false}h.stopPropagation();g.skipSuggestionsShowing=false;if(d&&d.is(":visible")){d.focus()}});d.on("focus",function(h){h.stopPropagation();g.smartBoxFocus();g.isSubmitEnabled=false;g.skipActiveSubmit=false});d.on("focusout",function(h){h.stopPropagation();if(g.setItemFromSmarty){g.setItemFromSmarty=false;g.searchInputFocus()}else{g.smartBoxFocusOut();if(typeof g.ptOptions.onFocusout==="function"){g.ptOptions.onFocusout.call()}}return false});if(typeof b.fn.autoGrowInput==="function"){this.searchInput.autoGrowInput()}d.on("keyup keydown blur update",function(h){g.togglePlaceHolder()});d.on("blur",function(){g.skipActiveSubmit=false})},smartBoxFocus:function(){if(this.isSearchInputEmpty()){this.searchInput.val("");this.searchValue=""}this.searchInput.addClass("focus")},smartBoxFocusOut:function(){if(this.searchInput.val()===""){this.searchInput.removeClass("focus")}this.togglePlaceHolder()},autoAutocomplete:function(d,m){var j=this;var l=d.split(" ");var c=l.length;var h=[];if(this.isSearchInputEmpty()){if(typeof m==="function"){m(h)}return}var k=function(){if(l.length===c&&h.length>0&&typeof m==="function"){m(h)}else{if(l.length>0){var n=l.splice(0,1)[0];g(n)}else{if(typeof m==="function"){m(h)}}}};var f=function(p){var o=b(p);var n=o.find("li:first");if(n.length>0){var q=j.getSmartBoxElementData(b(n),true);if(q){h.push(j.createHiddenValue(q.id,q.name))}}};var g=function(p){var n=j.ptOptions;if(b.trim(p).length===0){k();return}var o={f:"h",lc:n.langCode,lc_cc:n.countryCode,s:17,where:p};if(j.options.extendRequest){o.v=j.options.extendRequest.v}b.ajax({url:n.smartUrl,type:"POST",dataType:"text",data:o,success:function(q){f(q)},complete:function(){k()}})};g(d)},getSmartBoxElementData:function(o,s){var g=o.attr("id");var n=null;var u=null;var f=false;var t=false;var q="";var m="#####";var c="##";var r=o.html();var k=o.find("div");if(k.length>0){r=k.html()}var j=o.find("span.nearbyHotels");if(j.length>0){q=j.html()}if(g.indexOf("pt_suggestion_parent")!==-1){t=true;n=r.split("\n")}else{if(r.indexOf(m)!==-1){f=true;n=r.split(m)}else{if(r.indexOf(c)!==-1){n=r.split(c)}else{n=r.split("\n")}}}if(n.length===0){return u}g=this.extractValidId(g);var d=n[0];var h="";if(n.length>1){h=n[1]}d=this.fixBoldTags(d);h=this.fixBoldTags(h);var l=g.indexOf("H")===0;var p=g.indexOf("S")===0;if(s===true){d=this.clearHtml(d);h=this.clearHtml(h)}return{id:g,name:d,parentPath:h,nearbyHotels:q,isHotel:l,isNeighborhood:p,isSuggestion:f,isSuggestionParent:t}},extractValidId:function(d){if(d.indexOf("-PT_")>=0){var c=d.match(/PT_(?:SPT_)?([A-Z0-9]+)/);if(c&&c.length>1){d=c[1]}}return d},fixBoldTags:function(h){h=b.trim(h);var g=h.toLowerCase().indexOf("<b>");var d=g!==-1;var c=h.toLowerCase().indexOf("</b>");var f=c!==-1;if(f&&(c===0||!d)){h="<b>"+h}else{if(d&&("<b>"===h.substr(-3).toLowerCase()||!f)){h=h+"</b>"}}return h},clearHtml:function(c){c=c.replace(new RegExp("<b>|</b>","gmi"),"");c=c.replace(new RegExp("<div>|</div>","gmi"),"");c=c.replace(new RegExp("&amp;","gmi"),"&");return c}})})(jq||jQuery,window);R9.extend("Widgets.Smarty",{LandmarksSmarty:function(b,a){R9.Widgets.Smarty.FlareSmarty.call(this,b,jq.extend({minWidth:250,dropdownClass:" smartbox",forceSelection:true,flareSmartyType:21,searchOnFocus:true,searchNoQuery:true,showDropdownWhenEmpty:true,searchOnFocus:true,f:"j",v:"v1"},a))}});R9.extend("Widgets.Smarty.LandmarksSmarty.prototype",true,R9.Widgets.Smarty.FlareSmarty.prototype,{geocoder:null,translateItem:function(c){if(!c){return null}var b=jq(c);var a={type:b.attr("data-type"),id:b.attr("id"),str:b.text(),short_str:b.attr("data-short-name"),lat:b.attr("data-lat"),lon:b.attr("data-lon")};return a},onBeforeStart:function(){if(typeof this.options.beforeStart==="function"){this.options.beforeStart(this)}},noItemToSelect:function(){if(typeof this.options.onNoItemToSelect==="function"){this.options.onNoItemToSelect(this)}},runSearch:function(l){if(this.element.val().length<this.options.minLength){return}var c=this.element.val();if(this.lastValue===c){return}this.lastValue=c;var b=this.getRequestData();if(!l){b.value=""}var d=this.preprocessRequest(b);var g=this;var f={};if(c.length>0){R9.Maps.Google.load(null,"landmarks-smarty")}f.useGoogle=R9.Maps.Google.isLoaded()&&c.length>0;var a=function(){if(!f.useGoogle&&f.smarty!=null){var m=g.postprocessResponse(f);g.searchCompleted(m,l)}else{if(f.smarty!=null&&f.google!=null){var m=g.postprocessResponse(f);g.searchCompleted(m,l)}}};var k=function(m){f.smarty=m;a()};this.smartyRequest=jq.post(this.options.dataSource,d,k,this.options.dataType);if(f.useGoogle){if(!this.geocoder){this.geocoder=new google.maps.Geocoder()}var j=this.preprocessGoogleRequest(b);var h=function(n,m){if(m==="OK"){f.google=n;a()}};this.geocoder.geocode(j,h)}},isUpdateInProgress:function(){return(this.keyTimeout||this.smartyRequest||this.googleRequest)},abortRequest:function(){if(this.smartyRequest){try{this.smartyRequest.abort()}catch(a){}this.smartyRequest=null}if(this.googleRequest){try{this.googleRequest.abort()}catch(a){}this.googleRequest=null}},postprocessResponse:function(a){var b;var f;var c;var d;if(a.smarty){f=JSON.parse(a.smarty);c=f.landmarks;d=f}if(c!=null){b=this.makePopularContent(c,this.options.recentLandmarks)}else{if(d||a.google){b=this.makeRegularContent(d,a.google)}}if(!b){b=this.makeEmptyContent()}return b},makeEmptyContent:function(){return this.options.emptyItemContent},makePopularContent:function(g,c){var f=[];if(g&&g.length>0){f.push("<div><div class='smartyheader'>");f.push(this.options.popularLandmarksHeader);f.push("</div></div>");f.push("<ul>");for(var b=0;b<g.length;b++){var d=this.makeSmartyResult(g[b]);if(d){f.push(d)}}f.push("</ul>")}if(c&&c.length>0){f.push("<div><div class='smartyheader'>");f.push(this.options.recentLocationsHeader);f.push("</div></div>");f.push("<ul>");for(var b=0;b<c.length;b++){var a=c[b];var d=this.makeResult(a.type.uiCode,a.id,a.landmarkName,a.latitude,a.longitude);if(d){f.push(d)}}f.push("</ul>")}return f.join("")},makeRegularContent:function(j,h){var g=[];var d=0;var a=10;if(j){for(var c=0;c<a&&c<j.length;c++,d++){var f=this.makeSmartyResult(j[c]);if(f){g.push(f)}}}if(h){a=a-d;for(var c=0;c<a&&c<h.length;c++,d++){var b=this.makeGoogleResult(h[c]);if(b){g.push(b)}}}if(g.length>0){return"<ul>"+g.join("")+"</ul>"}return null},makeSmartyResult:function(b){var a=b.loctype;var g=b.id;var c=b.lat;var f=b.lng;var d=b.displayname;d=this.highliteText(d,this.lastValue);return this.makeResult(a,g,d,c,f)},makeGoogleResult:function(a){if(this.googleHasType(a.types,["street_address","neighborhood","sublocality_level_4","sublocality_level_5"])){var b=a.geometry.location.lat();var d=a.geometry.location.lng();if(this.isInBounds(b,d)){var c=a.formatted_address;c=this.highliteText(c,this.lastValue);return this.makeResult("adr",null,c,b,d)}}return null},makeResult:function(a,f,d,b,c){return"<li data-type='"+a+"' class='"+a+"' "+(f?"id='"+f+"' ":"")+(b?" data-lat='"+b+"' ":"")+(c?" data-lon='"+c+"' ":"")+">"+d+"</li>"},isInBounds:function(a,b){if(this.options.swBounds&&this.options.neBounds){if(a<this.options.swBounds.lat||a>this.options.neBounds.lat){return false}if(b<this.options.swBounds.lon||b>this.options.neBounds.lon){return false}}return true},googleHasType:function(c,d){for(var b=0;b<c.length;b++){for(var a=0;a<d.length;a++){if(c[b]===d[a]){return true}}}return false},preprocessGoogleRequest:function(b){var a={};a.language=R9.globals.locale.lc;a.address=b.value;if(this.options.swBounds&&this.options.neBounds){a.bounds=new google.maps.LatLngBounds(new google.maps.LatLng(this.options.swBounds.lat,this.options.swBounds.lon),new google.maps.LatLng(this.options.neBounds.lat,this.options.neBounds.lon))}return a}});R9.extend("Widgets.Smarty",{TimePickerSmarty:function(b,a){R9.Widgets.Smarty.Smarty.call(this,b,a)}});R9.extend("Widgets.Smarty.TimePickerSmarty.prototype",true,R9.Widgets.Smarty.Smarty.prototype,{handleInputChangeEvent:function(){this.abortKeyTimeout();this.abortRequest();this.onInputChange()},runSearch:function(){this.showInitialDropdown()},showInitialDropdown:function(){var a=this.onInitialData();if(a){this.searchCompleted(a,false);var d=this.element.val();if(this.options.is24hour===false){var h=moment(d,"hh:mm,A")}else{var h=moment(d,"HH:mm")}if(h!=null){var b=parseInt(h.format("HH"));var f=parseInt(h.format("mm"));var j=0;if(f>=30){j=1}var c=this.dropdown.find("li:first-child").outerHeight();var g=this.dropdown.height();this.dropdown.find("ul").scrollTop(Math.max((2*b+j)*c-(g-c)/2,0));this.getItemList().removeClass("selected")}}},hideDropdown:function(){this.abortKeyTimeout();this.abortRequest();this.lastValue=null;if(this.dropdown.css("display")=="none"){return false}this.dropdown.hide();return true},onInputChange:function(){this.isItemSet=false;this.removeItemHighlite()},appendTo:"#tripform"});R9.extend("Widgets.Smarty",{CustomSmarty:function(b,a){R9.Widgets.Smarty.Smarty.call(this,b,a)}});R9.extend("Widgets.Smarty.CustomSmarty.prototype",true,R9.Widgets.Smarty.Smarty.prototype,{runSearch:function(c){if(this.element.val().length<this.options.minLength){return}var f=this.element.val();if(this.lastValue==f){return}this.lastValue=f;var b=f.length;var d=jq(this.onInitialData());d.find("li").each(function(){if(jq(this).html().substr(0,b).toLowerCase()!=f.toLowerCase()){jq(this).remove()}});var a;if(d[0].childElementCount<1){a=""}else{a=d[0].outerHTML}this.searchCompleted(a,c)}});R9.extend("Widgets.Smarty",{TripAddressSmarty:function(b,a){R9.Widgets.Smarty.Smarty.call(this,b,a)}});R9.extend("Widgets.Smarty.TripAddressSmarty.prototype",true,R9.Widgets.Smarty.Smarty.prototype,{runSearch:function(a){if(this.element.val().length<this.options.minLength){return}var d=this.element.val();if(this.lastValue==d){return}var b={address:d};var c=this;var f=function(g){c.request=null;c.lastValue=d;g=c.postprocessResponse(g,a);c.searchCompleted(g,a)};this.request=jq.get(this.options.dataSource,b,f,this.options.dataType)},postprocessResponse:function(b,a){return b.slice(1,b.length-1)},searchCompleted:function(b,a){if(b.length>9){this.showDropdown(b,a)}else{this.hideDropdown()}}});R9.extend("Widgets.Smarty",{NearbySmarty:function(b,a){R9.Widgets.Smarty.FlareSmarty.call(this,b,jq.extend({dropdownClass:" smartbox smartbox-hotel",forceSelection:true,searchOnFocus:true,searchNoQuery:true,flareSmartyType:28,f:"j",v:"v1"},a))}});R9.extend("Widgets.Smarty.NearbySmarty.prototype",true,R9.Widgets.Smarty.FlareSmarty.prototype,{geocoder:null,placesService:null,nearbyPlaceTypes:{airport:"ap",restaurant:"rest"},translateItem:function(b){if(!b){return null}var a={type:jq(b).data("type"),id:b.id,str:jq(b).text(),lat:jq(b).data("lat"),lon:jq(b).data("lon"),ggpid:jq(b).data("ggpid")};return a},runSearch:function(l){if(this.element.val().length<this.options.minLength){return}var c=this.element.val();if(this.lastValue===c){return}this.lastValue=c;var b=this.getRequestData();if(!l){b.value=""}var d=this.preprocessRequest(b);var g=this;var f={};f.setRegularResponse=c.length>0;var a=function(){if(f.smarty!=null){var m=g.postprocessResponse(f,f.setRegularResponse);g.searchCompleted(m,l)}};var k=function(m){f.smarty=m};this.smartyRequest=jq.post(this.options.dataSource,d,k,this.options.dataType);this.nearbyPromise=this.getGoogleSmartyPlaces(b,f);if(f.setRegularResponse){if(!this.geocoder){this.geocoder=new google.maps.Geocoder()}var j=this.preprocessGoogleRequest(b);var h=function(n,m){if(m==="OK"){f.geocoder=n;a()}};this.geocoder.geocode(j,h)}jq.when(this.smartyRequest,this.nearbyPromise).done(function(){a()})},getGoogleSmartyPlaces:function(f,c){var b=jq.Deferred();if(!this.placeService){var g=hotelResultsMap.mapController.getMap().getGMap();this.placeService=new google.maps.places.PlacesService(g)}var d=this.preprocessNearbyRequest(f);var a=function(j,h){if(h==google.maps.places.PlacesServiceStatus.OK){c.nearby=j}b.resolve()};this.placeService.nearbySearch(d,a);return b.promise()},filterOutHotels:function(d){var a=[];var c;if(d){for(var b=0;b<d.length;b++){c=d[b].loctype;if(c!="hotel"){a.push(d[b])}}}return a},postprocessResponse:function(a,c){var b;var g;var f;var d;if(a.smarty){g=JSON.parse(a.smarty);f=g}if(a.nearby&&a.nearby.length>0){d=a.nearby}if(!c&&this.options.popularContent.length>0){b=this.makePopularContent(this.options.popularContent,f,d)}else{if(f||a.geocoder||a.nearby){b=this.makeRegularContent(f,a.geocoder,d)}}if(!b){b=this.makeEmptyContent()}return b},makeResult:function(b,g,f,c,d,a){return"<li data-type='"+b+"' class='"+b+"' "+(g?"id='"+g+"' ":"")+(c?" data-lat='"+c+"' ":"")+(d?" data-lon='"+d+"' ":"")+(a?" data-ggpid='"+a+"' ":"")+">"+f+"</li>"},makeSmartyResult:function(b){var a=b.loctype;var c=b.lat;var f=b.lng;var d=b.displayname;var g;if(!b.id){if(b.ctid){g=b.ctid}}else{g=b.id}if(this.lastValue&&this.lastValue.length>0){d=this.highliteText(d,this.lastValue)}return this.makeResult(a,g,d,c,f,null)},makeGoogleResult:function(a){if(this.googleHasType(a.types,["street_address","neighborhood","sublocality_level_4","sublocality_level_5"])){var b=a.geometry.location.lat();var d=a.geometry.location.lng();if(this.isInBounds(b,d)){var c=a.formatted_address;if(this.lastValue){c=this.highliteText(c,this.lastValue)}return this.makeResult("adr",null,c,b,d,null)}}return null},makeGoogleNearbyResult:function(a){var c;for(var b in this.nearbyPlaceTypes){if(jq.inArray(b,a.types)>-1){c=this.nearbyPlaceTypes[b];break}}var h=a.place_id;var d=a.geometry.location.lat();var g=a.geometry.location.lng();var f=a.name;if(this.lastValue&&this.lastValue.length>0){f=this.highliteText(f,this.lastValue)}return this.makeResult(c,h,f,d,g,h)},makeEmptyContent:function(){return this.options.emptyItemContent},makePopularContent:function(l,f,c){var g=this;var k=[];if(l&&l.length>0){k.push(l)}var b=this.filterOutHotels(f);if(b){k.push("<div><div class='smartyheader'>");k.push(this.options.popularLandmarksHeader);k.push("</div></div>");k.push("<ul>");var j=10;for(var d=0;d<j&&d<b.length;d++){var a=g.makeSmartyResult(b[d]);if(a){k.push(a)}}k.push("</ul>")}if(c){var j=5;k.push("<ul>");for(var d=0;d<j&&d<c.length;d++){var a=g.makeGoogleNearbyResult(c[d]);if(a){k.push(a)}}k.push("</ul>")}var h=k.join("");return h},makeRegularContent:function(g,k,d){var j=[];var c=0;var h=15;if(g){for(var f=0;f<h&&f<g.length;f++,c++){var a=this.makeSmartyResult(g[f]);if(a){j.push(a)}}}if(k){h=h-c;for(var f=0;f<h&&f<k.length;f++,c++){var b=this.makeGoogleResult(k[f]);if(b){j.push(b)}}}if(d){h=h-c;for(var f=0;f<h&&f<d.length;f++,c++){var b=this.makeGoogleNearbyResult(d[f]);if(b){j.push(b)}}}if(j.length>0){return"<ul>"+j.join("")+"</ul>"}return null},isInBounds:function(a,b){if(this.options.swBounds&&this.options.neBounds){if(a<this.options.swBounds.lat||a>this.options.neBounds.lat){return false}if(b<this.options.swBounds.lon||b>this.options.neBounds.lon){return false}}return true},googleHasType:function(c,d){for(var b=0;b<c.length;b++){for(var a=0;a<d.length;a++){if(c[b]===d[a]){return true}}}return false},preprocessGoogleRequest:function(b){var a={};a.language=R9.globals.locale.lc;a.address=b.value;if(this.options.swBounds&&this.options.neBounds){a.bounds=new google.maps.LatLngBounds(new google.maps.LatLng(this.options.swBounds.lat,this.options.swBounds.lon),new google.maps.LatLng(this.options.neBounds.lat,this.options.neBounds.lon))}return a},preprocessNearbyRequest:function(b){var a={};if(b.value.length>0){a.name=b.value}a.types=["airport","restaurant"];if(this.options.swBounds&&this.options.neBounds){a.bounds=new google.maps.LatLngBounds(new google.maps.LatLng(this.options.swBounds.lat,this.options.swBounds.lon),new google.maps.LatLng(this.options.neBounds.lat,this.options.neBounds.lon))}return a}});(function(a){a.fn.r9FlightSmarty=function(b){return this.each(function(){new R9.Widgets.Smarty.FlightsSmarty(this,b)})};a.fn.r9AirportsSmarty=function(b){return this.each(function(){new R9.Widgets.Smarty.FlightsSmarty(this,a.extend({flareSmartyType:13},b))})};a.fn.r9AirlineSmarty=function(b){return this.each(function(){new R9.Widgets.Smarty.FlareSmarty(this,a.extend({dataSource:"/m/smarty",flareSmartyType:"airline"},b))})};a.fn.r9KNSmarty=function(b){return this.each(function(){new R9.Widgets.Smarty.KNSmarty(this,b)})};a.fn.r9HotelSmarty=function(b){return this.each(function(){new R9.Widgets.Smarty.HotelsSmarty(this,b)})};a.fn.r9HotelsOnlySmarty=function(b){return this.each(function(){new R9.Widgets.Smarty.HotelsSmarty(this,a.extend({flareSmartyType:11},b))})};a.fn.r9CitiesOnlySmarty=function(b){return this.each(function(){new R9.Widgets.Smarty.HotelsSmarty(this,a.extend({flareSmartyType:4},b))})};a.fn.r9TripDestinationSmarty=function(b){return this.each(function(){new R9.Widgets.Smarty.FlareSmarty(this,a.extend({dataSource:"http://www.kayak.com/f/smarty",flareSmartyType:6},b))})};a.fn.r9NearbySmarty=function(b){return this.each(function(){new R9.Widgets.Smarty.NearbySmarty(this,b)})};a.fn.r9HotelsAndCitiesSmarty=function(b){return this.each(function(){new R9.Widgets.Smarty.HotelsSmarty(this,a.extend({flareSmartyType:12},b))})};a.fn.r9LandmarksSmarty=function(b){return this.each(function(){new R9.Widgets.Smarty.LandmarksSmarty(this,b)})};a.fn.r9CarSmarty=function(b){return this.each(function(){new R9.Widgets.Smarty.CarsSmarty(this,b)})};a.fn.r9DealSmarty=function(b){return this.each(function(){new R9.Widgets.Smarty.DealsSmarty(this,b)})};a.fn.r9EmailSmarty=function(b){return this.each(function(){new R9.Widgets.Smarty.EmailSmarty(this,a.extend({searchOnFocus:true,showDropdownWhenEmpty:true,dataSource:"/s/run/users/emailsmarty",minWidth:250,setItem:function(f,c,d){if(c){ji=jq(c);if(ji.hasClass("clearaddresses")&&d!=9){jq.post("/s/run/users/clearsmartyemail",{formtoken:R9.globals.formtoken})}else{f.element.val(ji.text())}}else{f.element.val("")}},afterDone:function(c){var d=c.element.val();if(d.length>0){jq.post("/s/run/users/addsmartyemail",{value:d,formtoken:R9.globals.formtoken})}}},b))})};a.fn.r9PackageTourSmarty=function(b){this.each(function(){a(this).data("r9PackageTourSmarty",new R9.Widgets.Smarty.PackageToursSmarty(this,b))});return this};a.fn.r9TimePickerSmarty=function(b){return this.each(function(){new R9.Widgets.Smarty.TimePickerSmarty(this,a.extend({searchOnFocus:true,showDropdownWhenEmpty:true,dropdownClass:"timePickerDropdown",initialData:function(){var n=document.createElement("ul");if(b.is24hour===false){var o=["AM","PM"];var m=["00","30"];var h=[12,1,2,3,4,5,6,7,8,9,10,11];for(var l=0;l<o.length;l++){var p=o[l];for(var d=0;d<h.length;d++){var f=h[d];for(var g=0;g<m.length;g++){var c=m[g];var q=document.createElement("li");jq(q).html(f+":"+c+" "+p);jq(n).append(q)}}}}else{var m=["00","30"];for(var d=0;d<24;d++){for(var g=0;g<m.length;g++){var c=m[g];var q=document.createElement("li");jq(q).html(d+":"+c);jq(n).append(q)}}}return n.outerHTML},setItem:function(h,f,g){if(f){var c=jq(f).text();if(b.is24hour===false){var d=moment(c,"hh:mm A");if(d!=null){h.element.val(d.format("hh:mm A"))}}else{var d=moment(c,"HH:mm");if(d!=null){h.element.val(d.format("HH:mm"))}}}else{h.element.val("")}}},b))})};a.fn.r9CustomSmarty=function(b){return this.each(function(){new R9.Widgets.Smarty.CustomSmarty(this,b)})};a.fn.r9TripAddressSmarty=function(b){return this.each(function(){new R9.Widgets.Smarty.TripAddressSmarty(this,b)})}})(jq||jQuery);(function(a){R9.extend("Widgets",{BaseCalendarWidget:function(){}});R9.extend("Widgets.BaseCalendarWidget",{});R9.extend("Widgets.BaseCalendarWidget.prototype",{buzzGraph:jq("<div>",{"class":"r9-datepicker-buzz-graph"}),buzzGraphFooter:jq("<div>",{"class":"r9-datepicker-buzz-graph-footer"}),makeCalendarHTML:function(j){var d=[];if(this.options.showBuzzGraph){this.buzzGraph.html("");this.buzzGraphFooter.html("")}d.push("<div class='r9-datepicker-pointer'></div>");d.push(this.makeTitleHTML(this.options.title));var c=moment().startOf("day");var h=this.minDate;if(!h){h=c}else{h=moment(h)}var b=j?moment(j):h;if(b==null||!this.isPastDateAllowed()&&b<c){b=c}var g=moment(b).subtract(1,"months");var f=moment(b).add(1,"months");d.push(this.makeMonthCalendarHTML(b,g,"r9-datepicker-month-first",this.options.prevTitle));b.add(1,"months");d.push(this.makeMonthCalendarHTML(b,f,"r9-datepicker-month-last",this.options.nextTitle));d.push("<div class='r9-datepicker-month-break'></div>");if(this.options.showBuzzGraph){d.push(this.buzzGraph.prop("outerHTML"));d.push(this.buzzGraphFooter.prop("outerHTML"))}return d.join("")},makeTitleHTML:function(b){return'<div class="r9-datepicker-title"><span>'+b+'</span><a class="r9-datepicker-title-close">X</a></div>'},makeMonthCalendarHTML:function(h,f,b,g){var c=[];c.push("<div class='r9-datepicker-month "+b+"'>");c.push(this.makeMonthHeaderHTML(h,f,g));c.push(this.makeMonthBodyHTML(h,g));c.push("</div>");return c.join("")},showMonth:function(c){var b=[];b.push("<span class='r9-datepicker-month-name'>");b.push(c.format(this.options.titleMonthFormat).substring(0,1).toUpperCase()+c.format(this.options.titleMonthFormat).substring(1,this.options.titleMonthFormatLen));b.push("</span>");return b.join("")},showYearWithSpecialSymbol:function(f){var b=[];var c;if(R9&&R9.globals){c=R9.globals.reverseDatePickerMonthAndYear}b.push("<span class='r9-datepicker-year'>");b.push(f.format(this.options.titleYearFormat)+c+" ");b.push("</span>");return b.join("")},showMonthAndYear:function(c){var b=[];if(false){b.push(this.showYearWithSpecialSymbol(c));b.push(this.showMonth(c))}else{b.push(this.showMonth(c));b.push(this.showYearWithSpecialSymbol(c))}return b.join("")},makeMonthHeaderHTML:function(k,b,l){var j=[];var f=moment().startOf("month");var g=moment().add(11,"months");var m=(b.isBefore(f))||(b.isAfter(g));var c=this.maxDate;var h=this.minDate;var m=(h&&b.isBefore(h))||(c&&b.isAfter(c))||!this.isPastDateAllowed()&&(b.isBefore(f))||(b.isAfter(g));j.push("<span class='r9-datepicker-month-header'>");j.push("<a title='"+l+"' class='r9-datepicker-switch-month "+(m?"r9-datepicker-disabled":"r9-datepicker-enabled")+"' data-val='"+b.valueOf()+"'>");j.push("<span>");j.push(l);j.push("</span>");j.push("</a>");j.push("<span class='r9-datepicker-month-title'>");j.push(this.showMonthAndYear(k));j.push("</span>");j.push("</span>");return j.join("")},makeMonthBodyHTML:function(h,g){var f=[];var c,b;f.push("<span class='r9-datepicker-month-body'>");f.push(this.makeWeekDaysHTML(h));f.push(this.makeMonthDatesHTML(h,g));f.push("</span>");return f.join("")},makeWeekDaysHTML:function(c){var b=[];b.push("<span class='r9-datepicker-month-days'>");for(i=0+this.getFirstWeekDay();i<7+this.getFirstWeekDay();i++){day=i%7;b.push("<span class='r9-datepicker-day'>");b.push(this.getVeryShortDayName(day));b.push("</span>")}b.push("</span>");return b.join("")},makeMonthDatesHTML:function(x,A){var n=[];n.push("<span class='r9-datepicker-month-dates'>");var B=this.getMonthLeadDays(x);var c=this.getDaysInMonth(x);var f=moment().startOf("day");var t=moment(x).subtract(1,"months").startOf("month");var z=t.daysInMonth();var u=moment(x).add(1,"months").startOf("month");var h=moment(f).add(1,"year");var o=this.maxDate;var y,j,v,r;var k=this.minDate;var b=1;var w,s,g;A=A.toLowerCase();if(this.getStartDate){g=this.getStartDate()}for(i=0;i<42;i++){y=i-B+1;r=moment([x.year(),x.month(),y]);j=i%7;w=Math.ceil((i+1)/7);if(j==0){n.push("<span class='r9-datepicker-month-row' aria-label='Week "+w+"' role='week'>")}if(i<B&&A==="prev"){var q=moment([t.year(),t.month(),(z+i-B+1)]);v="r9-datepicker-item r9-datepicker-othermonth-item";if((r.isBefore(f)||r.isAfter(h))&&!this.isPastDateAllowed()||(k&&r.isBefore(k)||(o&&r.isAfter(o)))){v+=" r9-datepicker-disabled"}else{v+=" r9-datepicker-enabled"}this.addGraphBar(false,q.valueOf());n.push("<span role='gridcell' class='"+v+"' data-val='"+q.valueOf()+"'>");n.push("<span>"+(z+i-B+1)+"</span></span>")}else{if(i>=B+c&&A==="next"){var q=moment([u.year(),u.month(),b]);n.push("<span role='gridcell' class='r9-datepicker-othermonth-item r9-datepicker-item r9-datepicker-enabled' data-val='"+q.valueOf()+"'>");n.push("<span>"+b+++"</span></span>");this.addGraphBar(false,q.valueOf())}else{if((i>=B+c&&A!=="next")){break}else{if(i<B&&A!=="Prev"){n.push("<span role='gridcell' class='r9-datepicker-item r9-datepicker-disabled'><span>&nbsp;</span></span>")}else{v="r9-datepicker-item";var l=false;if((r.isBefore(f)||r.isAfter(h))&&!this.isPastDateAllowed()||(k&&r.isBefore(k)||(o&&r.isAfter(o)))){v+=" r9-datepicker-disabled";l=false}else{v+=" r9-datepicker-enabled";l=true}if(r.isSame(f)){v+=" r9-datepicker-today"}n.push("<span role='gridcell' class='"+v+"' ");this.addGraphBar(l,r.valueOf());n.push("data-val='"+r.valueOf()+"'");n.push("><span>");n.push(y);n.push("</span></span>")}}}}if(j==6){n.push("</span>");if(y===c||b>1){break}}}n.push("</span>");return n.join("")},getFirstWeekDay:function(){return moment().startOf("week").day()},getVeryShortDayName:function(b){return moment().day(b).format("ddd").substring(0,this.options.shortDayNameLen).toUpperCase()},getMonthLeadDays:function(c){var b=this.getFirstMonthDay(c)-this.getFirstWeekDay();if(b<0){b=6}return b},getFirstMonthDay:function(c){var b=moment(c);b.startOf("month");return b.day()},getDaysInMonth:function(b){return b.daysInMonth()},insideLastCalendar:function(c){var b=this.dropdown.find(".r9-datepicker-item-"+c);if(b.closest(".r9-datepicker-month").hasClass("r9-datepicker-month-last")){return true}return false},isPastDateAllowed:function(){if(this.options.allowPastDate!="undefined"){return this.options.allowPastDate}return false},addGraphBar:function(c,d){if(this.options.showBuzzGraph){var b=jq("<div>",{"class":"r9-datepicker-buzz-day "+(c?"r9-datepicker-enabled":"r9-datepicker-disabled"),"data-val":d});b.append(jq("<div>",{"class":"r9-datepicker-buzz-bar"}));this.buzzGraph.append(b)}}})})(jq||jQuery);(function(a){R9.extend("Widgets",{DaterangePicker:function(c,b){this.elementNode=c;this.element=a(this.elementNode);if(!this.validateElement()){return}this.startSection=a(R9.Widgets.DaterangePicker.findStartSection(this.elementNode));this.startDisplay=a(R9.Widgets.DaterangePicker.findStartDisplay(this.elementNode));this.startPlaceholderDisplay=a(R9.Widgets.DaterangePicker.findStartPlaceholderDisplay(this.elementNode));this.endSection=a(R9.Widgets.DaterangePicker.findEndSection(this.elementNode));this.endDisplay=a(R9.Widgets.DaterangePicker.findEndDisplay(this.elementNode));this.endPlaceholderDisplay=a(R9.Widgets.DaterangePicker.findEndPlaceholderDisplay(this.elementNode));this.summaryDisplay=a(R9.Widgets.DaterangePicker.findSummaryDisplay(this.elementNode));this.clearDisplay=a(R9.Widgets.DaterangePicker.findClearDisplay(this.elementNode));this.closeLink=a(R9.Widgets.DaterangePicker.findCloseLink(this.elementNode));this.tabInput=a(R9.Widgets.DaterangePicker.findTabInput(this.elementNode));this.startInput=a(R9.Widgets.DaterangePicker.findStartInput(this.elementNode));this.endInput=a(R9.Widgets.DaterangePicker.findEndInput(this.elementNode));this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.DaterangePicker",{isDatepicker:function(b){return b&&b.nodeName&&b.nodeName.toLowerCase()=="div"},isWidgetControlled:function(b){return a(b).hasClass(R9.Widgets.DaterangePicker.prototype.widgetBaseClass+"-wrapper")},findStartSection:function(b){return a(b).closest("form").find("#"+b.id+"-start")},findStartDisplay:function(b){return a(b).closest("form").find("#"+b.id+"-start-display")},findStartPlaceholderDisplay:function(b){return a(b).closest("form").find("#"+b.id+"-start-placeholder")},findEndSection:function(b){return a(b).closest("form").find("#"+b.id+"-end")},findEndDisplay:function(b){return a(b).closest("form").find("#"+b.id+"-end-display")},findEndPlaceholderDisplay:function(b){return a(b).closest("form").find("#"+b.id+"-end-placeholder")},findSummaryDisplay:function(b){return a(b).closest("form").find("#"+b.id+"-summary-display")},findClearDisplay:function(b){return a(b).closest("form").find("#"+b.id+"-clear")},findCloseLink:function(b){return a(b).closest("form").find("#"+b.id+" .r9-datepicker-title-close")[0]},findStartInput:function(b){return a(b).closest("form").find("#"+b.id+" .r9-datepicker-input.r9-datepicker-start")[0]},findEndInput:function(b){return a(b).closest("form").find("#"+b.id+" .r9-datepicker-input.r9-datepicker-end")[0]},findTabInput:function(b){return a(b).closest("form").find("#"+b.id+"-tab")},getDropdownId:function(b){return"datepicker"},getDropdownEl:function(b){return jq(b).find("#datepicker")}});R9.extend("Widgets.DaterangePicker.prototype",true,R9.Widgets.BaseCalendarWidget.prototype,{widgetName:"datepicker",widgetId:"datepicker",widgetBaseClass:"r9-datepicker",accessibilityBreakpoint:768,elementNode:null,element:null,startSection:null,startDisplay:null,startPlaceholderDisplay:null,endSection:null,endDisplay:null,endPlaceholderDisplay:null,summaryDisplay:null,clearDisplay:null,closeLink:null,startInput:null,endInput:null,tabInput:null,clicks:[],unitFormat:null,unitAdjustment:0,isOldIE:false,preventBlur:false,actOnStart:true,buzzCall:false,options:{accessible:true,appendTo:"body",dateItemsSelector:"span.r9-datepicker-item",shortDayNameLen:1,title:"Prev",prevTitle:"Prev",nextTitle:"Next",offsetWidth:0,titleMonthFormat:"MMMM",titleYearFormat:"YYYY",startFormat:"ddd MMM D",startInputFormat:"YYYY/M/D",endFormat:"ddd MMM D",endInputFormat:"YYYY/M/D",nightsFormat:"0#same day|1#{0} night|2#{0} nights",daysFormat:"0#same day|1#{0} day|2#{0} days",useDaysFormat:false,secondClickHideDelay:200,minRangeDays:0,change:null,show:null,hide:null,minDateFunc:null,focusAfterClick:true,allowPastDate:false,widgetId:null,useLongDisplayFormat:false,singlePickerWithSingleField:false,showBuzzGraph:false,originControl:false,destControl:false,isOneWay:false,datepickerWrapperSelector:".r9-datepicker-wrapper"},getWidgetId:function(){if(this.options&&this.options.widgetId){this.widgetId=this.options.widgetId}return this.widgetId},getDropdownId:function(b){if(this.options&&this.options.widgetId){return this.options.widgetId}else{return R9.Widgets.DaterangePicker.getDropdownId(b)}},getDropdownEl:function(b){if(this.options&&this.options.widgetId){return jq(b).find("#"+this.options.widgetId)}else{return R9.Widgets.DaterangePicker.getDropdownEl(b)}},init:function(){var c=this;if(this.options.useDaysFormat){this.unitFormat=this.options.daysFormat;this.unitAdjustment=1}else{this.unitFormat=this.options.nightsFormat;this.unitAdjustment=0}if(this.options.useLongDisplayFormat){this.options.startFormat=this.options.startInputFormat;this.options.endFormat=this.options.endInputFormat}this.options.offsetWidth=2;this.isOldIE=!jq.support.changeBubbles;this.initDropdown();this.bindEvent(this.tabInput,"focus",this.handleInputFocusEvent);this.bindEvent(this.tabInput,"blur",this.handleInputBlurEvent);this.bindEvent(this.tabInput,"keydown",this.handleInputKeydownEvent);this.bindEvent(this.element,"mousedown",this.handleElementClickEvent);if(!this.endStartIsSameField()){this.bindEvent(this.endSection,"mousedown",this.handleEndClickEvent)}this.bindEvent(this.startSection,"mousedown",this.handleStartClickEvent);this.bindEvent(this.clearDisplay,"mousedown",this.handleClearClickEvent);this.bindEvent(this.closeLink,"mousedown",this.handleClearClickEvent);this.bindEvent(this.dropdown,"mousedown",this.handleDropdownClickEvent);this.bindEvent(this.overlay,"mousedown",this.handleItemClickEvent);this.element.data(this.widgetName,this);this.update();var b=this.element.find(".r9-datepicker-display");if(b!==undefined&&b.length>1){return}this.element.off("mousedown focus").on("mousedown focus",function(d){d.preventDefault();d.stopPropagation();jq(this).find(".r9-datepicker-display").focus();jq("body").trigger("event",[d])});this.bindCommandUtilities();this.start_custom_value=this.end_custom_value="";this.utils=this.options.commands.utilities;this.today=moment().startOf("day").toDate();this.bindAccessibilityEvents();this.updateClicks();this.updateDOM()},validateElement:function(){return R9.Widgets.DaterangePicker.isDatepicker(this.elementNode)&&R9.Widgets.DaterangePicker.isWidgetControlled(this.elementNode)&&this.element.data(this.widgetName)===undefined},bindEvent:function(b,c,f){var d=this;c+="."+this.getWidgetId();b.off(c).on(c,function(g){return f.call(d,this,g)})},bindCommandUtilities:function(){var b=this;this.options.commands={keys:{TAB:9,ENTER:13,UP:38,DOWN:40,LEFT:37,RIGHT:39,DOLLAR:52,CARAT:54},utilities:{changeCalendar:function(g,c){c=c||1;var f=b.dropdown.find(".r9-datepicker-switch-month.r9-datepicker-enabled");if(g==="prev"){f=f.first()}else{f=f.last()}for(var d=Math.abs(c);d>0;d--){b.handleNextPrevClickEvent(f)}return b},isCharacterKeyPress:function(d){var c=b.options.commands.keys;if(typeof d.which=="undefined"){return true}else{if(typeof d.which=="number"&&d.which>0){return !d.ctrlKey&&!d.metaKey&&!d.altKey&&d.keyCode!=c.TAB&&d.keyCode!=c.ENTER&&d.keyCode!=16&&d.keyCode!=c.UP&&d.keyCode!=c.DOWN&&d.keyCode!=c.LEFT&&d.keyCode!=c.RIGHT}}return false},getRowInfo:function(f){var c=b.dropdown.find(".r9-datepicker-item-"+f);var d=c.parent().children().not(".r9-datepicker-disabled");return{len:d.length-1,index:d.index(c)}},isValidDateObject:function(c){if(c instanceof Date){return !isNaN(c.getTime())}else{return this.isValidDate(new Date(c))}},isValidDatePair:function(d,c){return moment(d).isBefore(moment(c))},isValidDate:function(c){return this.isValidDateObject(c)&&(this.isValidDatePair(moment().subtract(1,"d"),moment(c))||b.isPastDateAllowed())},applyEndVal:function(){if(b.end_custom_value===""||!moment(b.end_custom_value,b.options.endInputFormat).isValid()){return}var d=this.formatLocaleDate(b.end_custom_value,b.options.endInputFormat);if(d&&this.isValidDate(d)){var c=b.getStartDate()||b.today;if(this.isValidDatePair(c,d)){b.setEndDate(d)}this.fetchBuzzData();if(b.options.change){b.options.change.call(b)}b.end_custom_value=""}},applyStartVal:function(){if(b.start_custom_value===""||!moment(b.start_custom_value,b.options.startInputFormat).isValid()){return}var c=this.formatLocaleDate(b.start_custom_value,b.options.startInputFormat);if(c&&this.isValidDate(c)){b.setStartDate(c);var d=b.getEndDate()||b.today;if(!this.isValidDatePair(c,d)){b.setEndDate(c)}b.start_custom_value="";this.fetchBuzzData();if(b.options.change){b.options.change.call(b)}}},validate:function(c){c=c||moment().startOf("day").toDate();if(!b.isPastDateAllowed()&&c.getTime()<=b.today.getTime()){return b.today}return c},formatLocaleDate:function(c,f){f=f||b.options.startInputFormat;try{var d=c.split(/\D+/g)[2];if(d.length!==4){c=c.substr(0,c.length-2)+"20"+d}return moment(c,f).toDate()}catch(g){return new Date()}},incrementDay:function(d,f,c){c=c||jq.noop;d=moment(d).add(f||1,"days");c.call(b,this.validate(d.toDate()));return d},decrementDay:function(d,f,c){c=c||jq.noop;d=moment(d).subtract(f||1,"days");c.call(b,this.validate(d.toDate()));return d},dateDiff:function(d,c){var f=d.getTime()-c.getTime();return(f/(24*60*60*1000))}}};this.utils=this.options.commands.utilities;return this},bindAccessibilityEvents:function(){var b=this;this.options.accessible=jq(this.startDisplay).attr("contenteditable")==="true";jq(this.startDisplay).attr({"aria-label":this.options.startLabel||"Start Date"});jq(this.endDisplay).attr({"aria-label":this.options.endLabel||"End Date"});this.blurTarget=null;this.clickTarget=null;jq(document).mousedown(function(c){b.clickTarget=jq(c.target);if(b.isDropdownVisible()){jq(b.blurTarget).blur()}}).mouseup(function(c){b.clickTarget=null});if(!this.endStartIsSameField()){this.bindEvent(this.endDisplay,"focus",this.handleEndDisplayFocusEvent);this.bindEvent(this.endDisplay,"blur",this.handleEndDisplayBlurEvent);this.bindEvent(this.endDisplay,"keydown",this.handleEndDisplayKeydownEvent);this.bindEvent(this.endDisplay,"keyup",this.handleEndDisplayKeyupEvent)}this.bindEvent(this.startDisplay,"focus",this.handleStartDisplayFocusEvent);this.bindEvent(this.startDisplay,"blur",this.handleStartDisplayBlurEvent);this.bindEvent(this.startDisplay,"keydown",this.handleStartDisplayKeydownEvent);this.bindEvent(this.startDisplay,"keyup",this.handleStartDisplayKeyupEvent)},handleClearClickEvent:function(b,c){this.clearDaterange();c.stopPropagation();this.fetchBuzzData();if(this.options.change){this.options.change.apply(this,arguments)}jq("body").trigger("event",[c]);return !this.element.hasClass("r9-datepicker-focus")},handleElementClickEvent:function(c,b){if(!this.isDropdownVisible()){return this.handleStartClickEvent(c,b)}else{return this.handleClickEvent(c,b,this.actOnStart)}},handleStartClickEvent:function(c,b){return this.handleClickEvent(c,b,true)},handleEndClickEvent:function(c,b){return this.handleClickEvent(c,b,false)},handleClickEvent:function(c,f,b){this.actOnStart=b;var g=this.getWrapperElement();var d=this;if(!this.isDropdownVisible()&&this.options.focusAfterClick){setTimeout(function(){if(!d.isDropdownVisible()){g.find(".r9-datepicker-tab").focus()}},1)}else{this.markDropdownElements();this.preventBlur=true}f.stopPropagation();jq("body").trigger("event",[f]);return true},getWrapperElement:function(){return this.element},getStartWrapperElement:function(){return this.element},getEndWrapperElement:function(){return this.element},handleDropdownClickEvent:function(c,b){if(this.isOldIE){this.preventBlur=true}return false},handleInputKeydownEvent:function(c,d){if(c.disabled){return}var j=27,b=9,f=32,h=8;var g=d.keyCode?d.keyCode:d.which;var k=jq(c).parent();switch(g){case b:return true;case j:if(this.isDropdownVisible()){this.hideDropdown(k)}break;case f:if(this.isDropdownVisible()){this.hideDropdown(k)}else{this.actOnStart=true;this.showDropdown(k)}break;case h:this.clearDaterange();this.fetchBuzzData();if(this.options.change){this.options.change.apply(this,arguments)}break}return false},handleInputFocusEvent:function(b,c){if(b.disabled){return}this.preventBlur=false;var d=jq(b).parent();jq(".r9-datepicker-focus").removeClass("r9-datepicker-focus");d.addClass("r9-datepicker-focus");if(!this.isDropdownVisible()){this.showDropdown(d)}if(this.options.focus){this.options.focus.apply(this,arguments)}},handleInputBlurEvent:function(b,c){if(this.preventBlur){this.preventBlur=false;setTimeout(function(){b.focus()},1);return false}if(b.disabled){return true}this.hideDropdown(jq(b).parent());if(this.options.blur){this.options.blur.apply(this,arguments)}return true},handleItemHoverEvent:function(d,c){var b=jq(d);if(b.hasClass("r9-datepicker-enabled")){this.updateDropdownSelection(b)}jq(".r9-datepicker-buzz-day[data-val=%s]".format(b.attr("data-val"))).addClass("hover");return false},handleItemHoverEndEvent:function(c,b){this.updateDropdownSelection(null);jq(".r9-datepicker-buzz-day[data-val=%s]".format(jq(c).attr("data-val"))).removeClass("hover");return false},handleItemClickEvent:function(l,b){if(this.isBeforeStart(l)===true&&this.actOnStart===false){this.preventBlur=true;b.preventDefault();return this}var h=this;var f=jq(l);var k,c,d,j;if(f.hasClass("r9-datepicker-enabled")){var c=parseInt(f.attr("data-val"));var g=this.actOnStart;var d=g?0:1;var j=g?1:0;this.clicks[d]=c;if(this.clicks[0]&&this.clicks[1]){k=moment(this.clicks[1]).diff(this.clicks[0],"days");if(k<this.options.minRangeDays){this.clicks[j]=0}}this.updateDropdownSelection(null);if(this.clicks[0]&&this.clicks[1]){setTimeout(function(){h.hideDropdown(h.element);if(h.options.change){h.options.change.apply(h,[c,g])}if(h.options.nextFieldSelector){jq(h.options.nextFieldSelector).focus()}},this.options.secondClickHideDelay)}else{this.switchActOn()}}this.updateDOM();if(this.isOldIE){this.preventBlur=true}jq(l).trigger("daterangepicker.itemclicked");jq("body").trigger("event",[b]);return false},switchActOn:function(){this.actOnStart=!this.actOnStart;this.markDropdownElements()},computeHighlitedRange:function(c){var b=[this.clicks[0],this.clicks[1]];if(b[0]&&b[1]){return b}if(c==0){b=[0,0]}else{if(this.actOnStart){b=[c,this.clicks[1]]}else{if(this.clicks[0]){b=[this.clicks[0],c]}else{b=[0,0]}}}return b},computeItemState:function(h,d,c,f,g){var b=false;if(h==d){if(this.actOnStart){f.hover=true;f.start=true}else{f.hover=true;f.end=true;f.highlighted=g&&g.highlighted}}else{f.beforeStart=(h<this.clicks[0])&&!this.actOnStart;if(h==this.clicks[0]){f.start=true;f.selected=true}else{if(h==this.clicks[1]){f.selected=true;f.end=true;f.highlighted=g&&g.highlighted;if(g&&g.selected){f.tight=true;g.tight=true;b=true}}}if(h>c[0]&&h<c[1]){f.highlighted=true;if(g&&g.start){g.highlighted=true;b=true}}}return b},updateItem:function(c,f){var b,d;b=[];d=[];if(f.highlighted){b.push("r9-datepicker-item-highlighted")}else{d.push("r9-datepicker-item-highlighted")}if(f.hover){b.push("r9-datepicker-item-hover")}else{d.push("r9-datepicker-item-hover")}if(f.selected){b.push("r9-datepicker-item-selected");c.attr("aria-selected",true)}else{d.push("r9-datepicker-item-selected");c.attr("aria-selected",false)}if(f.start){b.push("r9-datepicker-item-start")}else{d.push("r9-datepicker-item-start")}if(f.beforeStart){b.push("r9-datepicker-before-start")}else{d.push("r9-datepicker-before-start")}if(f.end){b.push("r9-datepicker-item-end")}else{d.push("r9-datepicker-item-end")}if(f.tight){b.push("r9-datepicker-item-tight")}else{d.push("r9-datepicker-item-tight")}c.removeClass(d.join(" "));c.addClass(b.join(" "))},updateDropdownSelection:function(j){if(this.isBeforeStart(j)===true&&this.actOnStart===false){return this}var k=this;var h=[0,0];var d=[0,0];var b=null;var g=null;var c=this.dropdown.find(this.options.dateItemsSelector);var f=0;if(j){f=parseInt(jq(j).attr("data-val"))}d=this.computeHighlitedRange(f);c.each(function(l,m){var m=jq(m);var o=parseInt(m.attr("data-val"));var n={};if(k.computeItemState(o,f,d,n,g)){k.updateItem(b,g)}k.updateItem(m,n);b=m;g=n});this.updateHoverDOM(j)},clearDaterange:function(b){if(typeof b!="undefined"){this.clicks[b]=0}else{this.clicks=[0,0]}if(this.isDropdownVisible()){this.updateDropdownSelection()}this.updateDOM()},updateHoverDOM:function(f){var d,j,b,h,c,g;j=this.clicks[0];b=this.clicks[1];if(f){d=parseInt(f.attr("data-val"));if(this.actOnStart){j=d}else{b=d}}if(b!=0&&((b<j)||(Math.abs(moment(b).diff(j,"days")<this.options.minRangeDays)))){if(this.actOnStart){b=0}else{j=0}}if(j){c=moment(j);this.startDisplay.text(c.format(this.options.startFormat));this.getStartWrapperElement().removeClass("r9-datepicker-start-empty")}else{this.getStartWrapperElement().addClass("r9-datepicker-start-empty")}if(b){g=moment(b);this.endDisplay.text(g.format(this.options.endFormat));if(this.summaryDisplay){h=g.diff(c,"days");this.summaryDisplay.text(R9.Common.Utils.String.formatChoice(this.unitFormat,h+this.unitAdjustment,h+this.unitAdjustment))}this.getEndWrapperElement().removeClass("r9-datepicker-end-empty")}else{this.getEndWrapperElement().addClass("r9-datepicker-end-empty")}},updateDOM:function(){var b,c,f;if(this.clicks[0]!=0){b=moment(this.clicks[0]);this.startDisplay.text(b.format(this.options.startFormat));this.startInput.val(b.format(this.options.startInputFormat))}else{this.startDisplay.text("");this.startInput.val("")}if(!this.endStartIsSameField()){if(this.clicks[1]!=0){c=moment(this.clicks[1]);this.endDisplay.text(c.format(this.options.endFormat));this.endInput.val(c.format(this.options.endInputFormat))}else{this.endDisplay.text("");this.endInput.val("")}}if(this.summaryDisplay){if(b!=null&&c!=null){f=c.diff(b,"days");this.summaryDisplay.text(R9.Common.Utils.String.formatChoice(this.unitFormat,f+this.unitAdjustment,f+this.unitAdjustment))}else{this.summaryDisplay.text("")}}if(b==null){this.getStartWrapperElement().addClass("r9-datepicker-start-empty")}else{this.getStartWrapperElement().removeClass("r9-datepicker-start-empty")}if(!this.endStartIsSameField()){if(c==null){this.getEndWrapperElement().addClass("r9-datepicker-end-empty")}else{this.getEndWrapperElement().removeClass("r9-datepicker-end-empty")}}},endStartIsSameField:function(){var b=this.getStartWrapperElement().get(0).id;var c=this.getEndWrapperElement().get(0).id;return b===c&&this.options.singlePickerWithSingleField===true},updateClicks:function(){this.clicks=[0,0];if(this.startInput.val()){var b=moment(this.startInput.val(),this.options.startInputFormat);if(b!=null){this.clicks[0]=b.valueOf()}}if(this.endInput.val()){var b=moment(this.endInput.val(),this.options.endInputFormat);if(b!=null){this.clicks[1]=b.valueOf()}}},handleNextPrevClickEvent:function(d,c){var b=moment(parseInt(jq(d).attr("data-val")));this.dropdown[0].innerHTML=this.makeCalendarHTML(b);if(this.options.showBuzzGraph){this.bindBuzzGraphEvents();this.displayBuzzGraph()}this.updateDropdownSelection(null);return false},bindItemEvent:function(b,d){var c=this;this.dropdown.off(b,this.options.dateItemsSelector).on(b,this.options.dateItemsSelector,function(f){return d.call(c,this,f)})},bindOverlayEvent:function(b,d){var c=this;this.overlay.off(b).on(b,function(f){return d.call(c,this,f)})},bindNextPrevEvent:function(b,d){var c=this;this.dropdown.off(b,".r9-datepicker-switch-month.r9-datepicker-enabled").on(b,".r9-datepicker-switch-month.r9-datepicker-enabled",function(f){return d.call(c,this,f)})},initDropdown:function(){var f=this.getDropdownId(this.element);var g=this.getDropdownEl(this.element).get(0);if(g==null){var b=R9.Widgets.DaterangePicker.prototype.widgetBaseClass;if(this.options.dropdownClass){b=b+" "+this.options.dropdownClass}var c={id:f,css:{display:"none",position:"absolute",zIndex:5001}};g=jq("<div></div>",c).appendTo(this.options.appendTo)[0];jq(g).addClass(b)}this.dropdown=jq(g);this.overlay=jq("#"+this.widgetBaseClass+"-overlay");if(!this.overlay.length){this.overlay=jq('<div id="'+this.widgetBaseClass+'-overlay" class="'+this.widgetBaseClass+'-overlay"></div>').appendTo(this.options.appendTo)}},isDropdownVisible:function(){return !(this.dropdown.css("display")=="none")},markDropdownElements:function(){this.unmarkDropdownElements();this.element.addClass("r9-datepicker-dropdown");if(this.actOnStart){this.element.addClass("r9-datepicker-dropdown-start")}else{this.element.addClass("r9-datepicker-dropdown-end")}},unmarkDropdownElements:function(){this.element.removeClass("r9-datepicker-dropdown r9-datepicker-dropdown-start r9-datepicker-dropdown-end")},positionDropdown:function(j){var d=j.offset();var c=jq(this.options.appendTo).offset();var g=this.dropdown[0].style;jq("#datepicker").removeClass("r9-datepicker-responsive-right-position");if(jq(window).width()<606&&jq(".fdSearchForm-hotel").length&&jq("#travel_dates-end-wrapper").hasClass("r9-datepicker-focus")){jq("#datepicker").addClass("r9-datepicker-responsive-right-position");var b=d.left-c.left-144;g.left=b+"px"}else{var b=d.left-c.left;var f=b+this.dropdown.outerWidth();if(f>window.innerWidth){var h=(f)-window.innerWidth;b=b-(h)-15;this.dropdown.find(".r9-datepicker-pointer").css("left",(h+36)+"px")}g.left=b+"px"}g.top=(d.top+j.outerHeight()-c.top)+"px"},_hideDropdown:function(b){if(this.dropdown.css("display")=="none"||(b!=null&&this.dropdown.prop("data-owner")!=b.attr("id"))){return false}if(b!=null){b.removeClass("r9-datepicker-focus")}jq(".r9-datepicker-focus").removeClass("r9-datepicker-focus");if(this.options.hide){this.options.hide.apply(this,arguments)}this.hideOverlay();this.preventBlur=false;this.updateDOM();this.unmarkDropdownElements();this.dropdown.hide();this.actOnStart=true;jq(window).unbind("resize",this.resizeHandler);return true},hideDropdown:function(c){var b=this;if(c!=null){c.removeClass("r9-datepicker-focus")}if(this.dropdown.css("display")=="none"||(c!=null&&this.dropdown.prop("data-owner")!=c.attr("id"))||this.preventBlur){this.preventBlur=false;return false}jq(".r9-datepicker-focus").removeClass("r9-datepicker-focus");if(this.options.hide){this.options.hide.apply(this,arguments)}this.preventBlur=false;this.updateDOM();this.unmarkDropdownElements();this.actOnStart=true;this.hideTimeout=setTimeout(function(){b._hideDropdown.call(b,c)},100)},hideMultipleDropdowns:function(){if(!this.options.datepickerWrapperSelector){return}jq(this.options.datepickerWrapperSelector).not(this.getStartWrapperElement()).not(this.getEndWrapperElement()).each(function(b,c){jq(c).daterangePickerTwoFields("hideDropdown")})},showDropdown:function(h){if(this.hideTimeout){clearTimeout(this.hideTimeout)}if(this.options.show){this.options.show.apply(this,arguments)}this.hideMultipleDropdowns();this.showOverlay();this.markDropdownElements();this.updateClicks();if(typeof this.options.minDateFunc==="function"){this.options.minDateFunc(this)}this.dropdown[0].innerHTML=this.makeCalendarHTML(this.clicks[0]);this.updateDropdownSelection(null);var b=R9.Widgets.DaterangePicker.prototype.widgetBaseClass;if(this.options.dropdownClass){b=b+" "+this.options.dropdownClass}jq(h).addClass("r9-datepicker-focus");this.dropdown.addClass(b);var g=this.dropdown[0].style;this.positionDropdown(h);var c=this,d=jq(window).width();this.resizeHandler=function(){var j=jq(window).width();if(Math.abs(j-d)>10){d=j;c.positionDropdown(h)}};jq(window).on("resize",this.resizeHandler);this.bindItemEvent("mousedown",this.handleItemClickEvent);if(!R9.globals.isTouch){this.bindItemEvent("mouseover",this.handleItemHoverEvent);this.bindItemEvent("mouseout",this.handleItemHoverEndEvent)}else{var f=this;this.bindOverlayEvent("mousedown",function(){f.hideDropdown(f.element)})}if(this.options.showBuzzGraph){this.bindBuzzGraphEvents();this.displayBuzzGraph()}this.bindNextPrevEvent("mousedown",this.handleNextPrevClickEvent);this.dropdown.prop("data-owner",h.attr("id"));g.display="inline"},showOverlay:function(){this.overlay.show()},hideOverlay:function(){this.overlay.hide()},handleJQueryOnChangeHookForIE:function(c,b,d){if(!a.support.changeBubbles){if(typeof d=="object"){var f=d.originalEvent||null;if(f&&f.type!=null&&(f.type.match(/(^|\.)click(\.|$)/)&&f.srcElement==b||f.type=="beforeactivate"||f.type=="beforedeactivate")){d.type=f.type;a(c).trigger(d);jq("body").trigger("event",[d]);return true}}}return false},getStartDate:function(){this.updateClicks();return this.clicks[0]!=0?new Date(this.clicks[0]):null},getEndDate:function(){this.updateClicks();return this.clicks[1]!=0?new Date(this.clicks[1]):null},parseDateString:function(b,d){try{return moment(b,d||this.options.startInputFormat)._d}catch(c){return""}},setFocusAfterClick:function(b){this.options.focusAfterClick=b},setStartDate:function(c){if(c){var b=c;if(typeof b==="string"){b=this.parseDateString(b,this.options.startInputFormat)}else{if(typeof b==="number"){b=new Date(b)}else{if(typeof b==="object"){b="toDate" in b?b.toDate():b}else{b=new Date(0)}}}if(b.getTime!=undefined){this.clicks[0]=b.getTime()}}else{this.clicks[0]=0}this.updateDOM()},setEndDate:function(c){if(c){var b=c;if(typeof b==="string"){b=this.parseDateString(b,this.options.endInputFormat)}else{if(typeof b==="number"){b=new Date(b)}else{if(typeof b==="object"){b="toDate" in b?b.toDate():b}else{b=new Date(0)}}}if(b.getTime!=undefined){this.clicks[1]=b.getTime()}}else{this.clicks[1]=0}this.updateDOM()},setUseDaysFormat:function(b){this.options.useDaysFormat=b;if(this.options.useDaysFormat){this.unitFormat=this.options.daysFormat;this.unitAdjustment=1}else{this.unitFormat=this.options.nightsFormat;this.unitAdjustment=0}},update:function(){this.updateClicks();this.updateDOM()},isBeforeStart:function(b){if(b instanceof jq){b=jq(b).attr("data-val")}if(b&&this.getStartDate()!==null){if(moment(parseInt(b)).isBefore(this.getStartDate())){return true}}return false},decrementEndDay:function(d){var f=this.insideLastCalendar("end");var g=this.getEndDate()||this.today;var b=this.getStartDate()||this.today;var c=this.utils.decrementDay(g,d);if(c.date()===c.daysInMonth()&&!f){this.prevCalendar();this.prevCalendar()}if(b&&(moment(g)>moment(b))){this.setEndDate(c.toDate())}this.fetchBuzzData();if(this.options.change){this.options.change.call(this)}this.updateDropdownSelection();return this.getEndDate()},decrementStartDay:function(c){var d=this.insideLastCalendar("start");var b=this.utils.decrementDay(this.utils.validate(this.getStartDate()),c,this.setStartDate);if(b.date()===b.daysInMonth()&&!d){this.prevCalendar();this.prevCalendar()}this.fetchBuzzData();if(this.options.change){this.options.change.call(this)}this.updateDropdownSelection();return this.getEndDate()},incrementEndDay:function(c){var d=this.insideLastCalendar("end");var f=this.getEndDate();var b=this.utils.incrementDay(f||this.today,c,this.setEndDate);if(b.date()>=1&&b.month()!==f.getMonth()&&d){this.nextCalendar();this.nextCalendar()}this.fetchBuzzData();if(this.options.change){this.options.change.call(this)}this.updateDropdownSelection();return this.getEndDate()},incrementStartDay:function(d){var f=this.insideLastCalendar("start");var b=this.getStartDate()||this.today;var g=this.getEndDate();var c=this.utils.incrementDay(b,d,this.setStartDate);if(c.date()===1&&f){this.nextCalendar();this.nextCalendar()}if(!g||(moment(b)>=moment(g))){this.setEndDate(this.getStartDate())}this.fetchBuzzData();if(this.options.change){this.options.change.call(this)}this.updateDropdownSelection();return this.getStartDate()},handleStartDisplayFocusEvent:function(g,j){var d=null;var c="";var b=this.getStartWrapperElement();var h=this;this.markDropdownElements();jq(".r9-datepicker-focus").removeClass("r9-datepicker-focus");jq(b).addClass("r9-datepicker-focus");var f=jq(g);if(!f.text()){this.setStartDate(this.today)}if((d=this.getStartDate())!==null){c=jq(this.startInput).val()||moment(d).format(this.options.startInputFormat)}this.hideDropdown(this.getEndWrapperElement());this.showDropdown(b);if(this.options.accessible){setTimeout(function(){f.text(c);h.selectDisplayBox(g)},1)}j.stopPropagation();j.stopImmediatePropagation();jq("body").trigger("event",[j]);return this},handleStartDisplayBlurEvent:function(c,d){if(this.clickTarget!==null&&this.clickTarget.closest(".r9-datepicker").length>0){this.blurTarget=c;return}var b=this.getStartWrapperElement();var f=this.getStartDate();this.hideDropdown(b);jq(b).removeClass("r9-datepicker-focus");c=jq(c);if(c.text()===""&&f===null){this.setStartDate(this.today)}else{if(this.start_custom_value!==""){this.utils.applyStartVal()}}this.updateDropdownSelection();this.updateClicks();return this},handleStartDisplayKeydownEvent:function(d,h){var c=h.keyCode||h.which;var f=this.options.commands.keys;var g=jq(this.endDisplay);d=jq(d);if((c===f.TAB||c===f.ENTER)&&!h.shiftKey){if(g.is(":hidden")===false){h.preventDefault();h.stopPropagation();setTimeout(function(){g.focus()},1)}if(c===f.ENTER&&g.is(":hidden")){d.closest("form").find("[type=submit]").trigger("click");h.preventDefault();h.stopPropagation();return false}this.utils.applyStartVal();this.updateDropdownSelection();return false}else{var b=this.options.commands.keys;switch(c){case b.RIGHT:case b.UP:this.incrementStartDay();h.preventDefault();h.stopPropagation();break;case b.LEFT:case b.DOWN:this.decrementStartDay();h.preventDefault();h.stopPropagation();break}this.vim(h,"start")}jq("body").trigger("event",[h]);return this},handleEndDisplayFocusEvent:function(g,j){var c=null;var d="";var b=this.getStartWrapperElement();var k=this.getEndWrapperElement();var h=this;var f=jq(g);if(this.options.accessible){this.selectDisplayBox(g)}setTimeout(function(){var l=h.clicks[0]||h.today.getTime();if(!f.text()||h.clicks[1]<=l){h.setEndDate(moment(l).toDate())}jq(".r9-datepicker-focus").removeClass("r9-datepicker-focus");jq(k).addClass("r9-datepicker-focus");h.actOnStart=false;h.markDropdownElements();h.showDropdown(k);if((c=h.getEndDate())!==null){d=jq(h.endInput).val()||moment(c).format(h.options.endInputFormat)}if(h.options.accessible){f.text(d);h.selectDisplayBox(g)}j.stopImmediatePropagation()},1);jq("body").trigger("event",[j]);return this},handleEndDisplayBlurEvent:function(b,c){var d=this.getEndWrapperElement();if(this.clickTarget!==null&&this.clickTarget.closest(".r9-datepicker").length>0){this.blurTarget=b;return}this.hideDropdown(d);b=jq(b);if(b.text()==""&&this.getEndDate()===null){if(this.getStartDate()!==null){this.setEndDate(moment(this.getStartDate()).add("days",1))}else{this.setEndDate(moment().toDate())}}else{this.utils.applyEndVal()}this.updateDropdownSelection();return this},handleEndDisplayKeydownEvent:function(d,g){var c=g.keyCode||g.which;d=jq(d);var j=d.text();var f=this.options.commands.keys;if(c===f.TAB&&g.shiftKey===true){var h=jq(this.startDisplay);if(h.is(":hidden")===false){g.preventDefault();g.stopPropagation();setTimeout(function(){h.focus()})}}else{if(c===f.ENTER){this.utils.applyEndVal();d.closest("form").find("[type=submit]").trigger("click");this.updateDropdownSelection();g.preventDefault();g.stopPropagation();this.hideDropdown(this.getEndWrapperElement());return false}else{var b=this.options.commands.keys||{};switch(c){case b.RIGHT:case b.UP:this.incrementEndDay();g.preventDefault();g.stopPropagation();break;case b.LEFT:case b.DOWN:this.decrementEndDay();g.preventDefault();g.stopPropagation();break}this.vim(g,"end")}}jq("body").trigger("event",[g]);return this},handleStartDisplayKeyupEvent:function(b,c){if(this.utils.isCharacterKeyPress(c)){this.start_custom_value=jq(b).text()}return this},handleEndDisplayKeyupEvent:function(b,c){if(this.utils.isCharacterKeyPress(c)){this.end_custom_value=jq(b).text()}return this},nextCalendar:function(b){return this.utils.changeCalendar("next",b)},prevCalendar:function(b){return this.utils.changeCalendar("prev",b)},selectDisplayBox:function(b){window.setTimeout(function(){var d,c;if(window.getSelection&&document.createRange){c=document.createRange();c.selectNodeContents(b);d=window.getSelection();d.removeAllRanges();d.addRange(c)}else{if(document.body.createTextRange){c=document.body.createTextRange();c.moveToElementText(b);if(!R9.Common.Utils.Browsers.isIE(8)){c.select()}}}},1)},vim:function(d,f){var c=d.keyCode||d.which;var b=this.options.commands.keys||{};switch(c){case b.DOLLAR:if(d.shiftKey){this.endOfLine(f);d.preventDefault()}break;case b.CARAT:if(d.shiftKey){this.startOfLine(f);d.preventDefault()}break}return this},startOfLine:function(c){var b=this.utils.getRowInfo(c);if(c=="start"){this.decrementStartDay(b.index)}else{this.decrementEndDay(b.index)}},endOfLine:function(d){var c=this.utils.getRowInfo(d);var b=c.len-c.index;if(d=="start"){this.incrementStartDay(b)}else{this.incrementEndDay(b)}},bindBuzzGraphEvents:function(){var b=this;jq(".r9-datepicker-buzz-day").hover(function(){jq(".r9-datepicker-item[data-val=%s]".format(jq(this).attr("data-val"))).addClass("r9-datepicker-item-hover");jq(".r9-datepicker-buzz-graph-footer > .detail").html(jq(this).children(".r9-datepicker-buzz-bar").attr("footertitle"))},function(){jq(".r9-datepicker-item[data-val=%s]".format(jq(this).attr("data-val"))).removeClass("r9-datepicker-item-hover");jq(".r9-datepicker-buzz-graph-footer > .detail").html("")});jq(".r9-datepicker-buzz-day").click(function(){var d=Number(jq(this).children(".r9-datepicker-buzz-bar").attr("dtstart"));if(b.actOnStart){var c=Number(jq(this).children(".r9-datepicker-buzz-bar").attr("dtend"));b.clearDaterange();b.setStartDate(d);b.setEndDate(c);b.updateDropdownSelection(null);if(!b.options.isOneWay){b.endDisplay.focus()}else{jq(".r9-datepicker-item[data-val=%s]".format(jq(this).attr("data-val"))).mousedown()}}else{b.setEndDate(d);jq(".r9-datepicker-item[data-val=%s]".format(jq(this).attr("data-val"))).mousedown()}})},fetchBuzzGraphData:function(){var f=this;var j=(jq("#flexgraphOK").size()>0);var b=f.getStartDate()||f.today;var d=f.getEndDate();var h=3;if(d!=null){h=f.utils.dateDiff(d,b)+1}var c=Number(jq(".r9-datepicker-month-first").find(".r9-datepicker-enabled:first").attr("data-val"));if(f.options.originControl.val()==""||f.options.originControl.val()==""){jq(".r9-datepicker-buzz-graph-footer").html("Select airports to see recent best prices. <span class='detail'></span>");return}if(f.actOnStart){var g=moment(c).format("YYYY-MM-DD");console.log("About to call flexgraph controller (start) start date = "+g+", duration = "+h);if(f.buzzCall){f.buzzCall.abort()}f.buzzCall=jq.ajax({type:"GET",url:"/h/run/flexgraph",data:{q:"fixed",o:f.options.originControl.val().substr(0,3),d:f.options.destControl.val().substr(0,3),depart:g,daysout:70,duration:h,json:1},dataType:"json",success:function(k){try{responseObject=k;f.graphDataReadyCallback(responseObject,h,c)}catch(l){}f.buzzCall=false},error:function(l,m,k){f.buzzCall=false},cache:false})}else{var g=moment(b.getTime()).format("YYYY-MM-DD");console.log("About to call flexgraph controller (end) start date = "+g);if(f.buzzCall){f.buzzCall.abort()}f.buzzCall=jq.ajax({type:"GET",url:"/h/run/flexgraph",data:{q:"start",o:f.options.originControl.val().substr(0,3),d:f.options.destControl.val().substr(0,3),depart:g,daysout:70,json:1},dataType:"json",success:function(k){try{responseObject=k;f.graphDataReadyCallback(responseObject,h,b.getTime())}catch(l){}f.buzzCall=false},error:function(l,m,k){f.buzzCall=false},cache:false})}},displayBuzzGraph:function(){this.fetchBuzzData(true)},fetchBuzzData:function(b){if(this.options.showBuzzGraph){if(b){jq(".r9-datepicker-buzz-day.r9-datepicker-enabled .r9-datepicker-buzz-bar").each(function(){jq(this).css("height","2px").attr("footertitle","")});this.fetchBuzzGraphData()}}},graphDataReadyCallback:function(p,f,q){if(this.actOnStart){jq(".r9-datepicker-buzz-graph-footer").html("Best prices for "+f+" day trips. <span class='detail'></span>")}else{jq(".r9-datepicker-buzz-graph-footer").html("Best prices for trips departing on "+moment(q).format(this.options.startInputFormat)+". <span class='detail'></span>")}var g=500;for(var r in p){var n=p[r].localPrice;if(n>g){g=n}}for(var r in p){var n=p[r].localPrice;var k=p[r].localPriceAsString;var j=new Date(p[r].departMilli);var d=new Date(p[r].returnMilli);var l=p[r].departMilli;var b=p[r].returnMilli;var s=moment(p[r].departMilli).format(this.options.startInputFormat);var c=moment(p[r].returnMilli).format(this.options.startInputFormat);var o=this.actOnStart?jq(".r9-datepicker-buzz-day[data-val='"+r+"']").find("div"):jq(".r9-datepicker-buzz-day[data-val='"+b+"']").find("div");if(o.size()==1){var m=Math.floor(n/g*100);o.css("height",m+"%");o.attr("footertitle",s+"-"+c+" "+k);if(this.actOnStart){o.attr("dtstart",l)}else{o.attr("dtstart",b)}o.attr("dtend",b)}}}})})(jq||jQuery);(function(a){a.extend("Widgets.DaterangePicker.prototype.options",{prevTitle:"Prev",nextTitle:"Next",nightsFormat:"0#same day|1#1 night|2#{0} nights",daysFormat:"0#same day|1#1 day|2#{0} days",startInputFormat:"MM/DD/YYYY",endInputFormat:"MM/DD/YYYY",startFormat:"ddd M/D",endFormat:"ddd M/D"})})(window.R9);(function(a){R9.extend("Widgets",{DaterangePickerTwoFields:function(b,c){this.endNode=b;this.endElement=a(this.endNode);this.startElement=jq(this.endElement).closest("form").find('[id$="start-wrapper"]');if(this.startElement.length!=1){this.startElement=jq("#"+this.endElement.attr("id").replace("end-wrapper","start-wrapper"))}if(!this.validateElement()){return}this.startDisplay=a(R9.Widgets.DaterangePickerTwoFields.findDisplay(this.startElement[0]));this.startClearDisplay=a(R9.Widgets.DaterangePickerTwoFields.findClearDisplay(this.startElement[0]));this.startPlaceholderDisplay=a(R9.Widgets.DaterangePickerTwoFields.findPlaceholderDisplay(this.startElement[0]));this.startInputTab=a(R9.Widgets.DaterangePickerTwoFields.findInputTab(this.startElement[0]));this.startInput=a(R9.Widgets.DaterangePickerTwoFields.findInput(this.startElement[0]));this.endDisplay=a(R9.Widgets.DaterangePickerTwoFields.findDisplay(this.endElement[0]));this.endClearDisplay=a(R9.Widgets.DaterangePickerTwoFields.findClearDisplay(this.endElement[0]));this.endPlaceholderDisplay=a(R9.Widgets.DaterangePickerTwoFields.findPlaceholderDisplay(this.endElement[0]));this.endInputTab=a(R9.Widgets.DaterangePickerTwoFields.findInputTab(this.endElement[0]));this.endInput=a(R9.Widgets.DaterangePickerTwoFields.findInput(this.endElement[0]));this.options=a.extend({},this.options,c);this.init()}});R9.extend("Widgets.DaterangePickerTwoFields",{isDatepicker:function(b){return b&&b.nodeName&&b.nodeName.toLowerCase()=="div"},isWidgetControlled:function(b){return a(b).hasClass(R9.Widgets.DaterangePicker.prototype.widgetBaseClass+"-wrapper")},findDisplay:function(b){var c=a(b).closest("form").find("#"+b.id.replace("wrapper","display"))[0];if(!c){c=document.getElementById(b.id.replace("wrapper","display"))}return c},findClearDisplay:function(b){var c=a(b).closest("form").find("#"+b.id.replace("wrapper","clear"))[0];if(!c){c=document.getElementById(b.id.replace("wrapper","clear"))}return c},findPlaceholderDisplay:function(b){var c=a(b).closest("form").find("#"+b.id.replace("wrapper","placeholder"))[0];if(!c){c=document.getElementById(b.id.replace("wrapper","placeholder"))}return c},findInputTab:function(c){var b=a(c).closest("form").find("#"+c.id.replace("wrapper","tab"))[0];if(!b){b=document.getElementById(c.id.replace("wrapper","tab"))}return b},findInput:function(c){var b=jq(c).closest("form").find("#"+c.id+" .r9-datepicker-input")[0];if(!b){b=jq("#"+c.id+" .r9-datepicker-input")[0]}return b},getDropdownId:function(b){return"datepicker"}});R9.extend("Widgets.DaterangePickerTwoFields.prototype",true,R9.Widgets.DaterangePicker.prototype,{endNode:null,startElement:null,endElement:null,startDisplay:null,startClearDisplay:null,startPlaceholderDisplay:null,startInputTab:null,startInput:null,endDisplay:null,endClearDisplay:null,endPlaceholderDisplay:null,endInputTab:null,endInput:null,singleDateMode:false,init:function(){this.initDropdown();if(this.options.useLongDisplayFormat){this.options.startFormat=this.options.startInputFormat;this.options.endFormat=this.options.endInputFormat}if(!this.endStartIsSameField()){this.bindEvent(this.endInputTab,"focus",this.handleEndInputFocusEvent);this.bindEvent(this.endInputTab,"blur",this.handleInputBlurEvent);this.bindEvent(this.endInputTab,"keydown",this.handleInputKeydownEvent);this.bindEvent(this.endElement,"mousedown",this.handleEndClickEvent);this.bindEvent(this.endClearDisplay,"mousedown",this.handleEndClearClickEvent)}this.bindEvent(this.startInputTab,"focus",this.handleStartInputFocusEvent);this.bindEvent(this.startInputTab,"blur",this.handleInputBlurEvent);this.bindEvent(this.startInputTab,"keydown",this.handleInputKeydownEvent);this.bindEvent(this.startElement,"mousedown",this.handleStartClickEvent);this.bindEvent(this.startClearDisplay,"mousedown",this.handleStartClearClickEvent);this.endElement.data(this.widgetName,this);jq(".r9-datepicker-wrapper").each(function(){var b=jq(this).find(".r9-datepicker-display");if(b!==undefined&&b.length>1){return}jq(this).off("mousedown focus").on("mousedown focus",function(c){c.preventDefault();c.stopPropagation();jq("body").trigger("event",[c]);jq(this).find(".r9-datepicker-display").focus()})});this.bindCommandUtilities();this.start_custom_value=this.end_custom_value="";this.utils=this.options.commands.utilities;this.today=moment().startOf("day").toDate();this.bindAccessibilityEvents();this.updateClicks();this.updateDOM()},validateElement:function(){return R9.Widgets.DaterangePicker.isDatepicker(this.endNode)&&R9.Widgets.DaterangePicker.isWidgetControlled(this.endNode)&&this.endElement.data(this.widgetName)===undefined},getWrapperElement:function(){return this.actOnStart?this.startElement:this.endElement},getStartWrapperElement:function(){return this.startElement},getEndWrapperElement:function(){return this.endElement},handleClickEvent:function(c,f,b){this.actOnStart=b;var g=this.getWrapperElement();var d=this;setTimeout(function(){if(!d.isDropdownVisible()){g.find(".r9-datepicker-tab").focus()}},1)},switchActOn:function(){var b=!this.actOnStart;this.hideDropdown(this.getWrapperElement());this.actOnStart=b;(this.actOnStart?this.startInputTab:this.endInputTab).focus()},markDropdownElements:function(){this.unmarkDropdownElements();if(this.actOnStart){this.startElement.addClass("r9-datepicker-dropdown r9-datepicker-dropdown-start")}else{this.endElement.addClass("r9-datepicker-dropdown r9-datepicker-dropdown-end")}},unmarkDropdownElements:function(){this.startElement.removeClass("r9-datepicker-dropdown r9-datepicker-dropdown-start");this.endElement.removeClass("r9-datepicker-dropdown r9-datepicker-dropdown-end")},setSingleDateMode:function(b){if(this.singleDateMode!=b){this.singleDateMode=b;this.updateDOM()}},getSingleDateMode:function(){return this.singleDateMode},handleStartClearClickEvent:function(b,c){this.clearDaterange(0);if(this.options.change){this.options.change.apply(this,arguments)}return !this.startElement.hasClass("r9-datepicker-focus")},handleEndClearClickEvent:function(b,c){this.clearDaterange(1);if(this.options.change){this.options.change.apply(this,arguments)}return !this.endElement.hasClass("r9-datepicker-focus")},handleStartInputFocusEvent:function(b,c){if(b.disabled){return}this.preventBlur=false;var d=this.getStartWrapperElement();d.addClass("r9-datepicker-focus");if(!this.startDisplay.text()){this.setStartDate(this.today)}this.actOnStart=true;this.showDropdown(d);if(this.options.focus){this.options.focus.apply(this,arguments)}},handleEndInputFocusEvent:function(b,c){if(b.disabled){return}this.preventBlur=false;var d=this.getEndWrapperElement();d.addClass("r9-datepicker-focus");if(!this.endDisplay.text()){this.setEndDate(moment(this.getStartDate()).toDate())}this.actOnStart=false;this.showDropdown(d);if(this.options.focus){this.options.focus.apply(this,arguments)}},handleItemClickEvent:function(f,d){var c=this;var b=jq(f);if(this.singleDateMode){if(b.hasClass("r9-datepicker-enabled")){var g=parseInt(b.attr("data-val"));this.clicks[0]=g;this.clicks[1]=moment(this.clicks[0]).add(2,"days");this.updateDropdownSelection(null);setTimeout(function(){c.hideDropdown(null);if(c.options.change){c.options.change.apply(c,arguments)}if(c.options.nextFieldSelector){jq(c.options.nextFieldSelector).focus()}},this.options.secondClickHideDelay)}this.updateDOM();return false}else{return R9.Widgets.DaterangePicker.prototype.handleItemClickEvent.call(this,f,d)}},handleClickEvent:function(c,d,b){return true},updateItem:function(b,c){if(this.singleDateMode){(c.hover)?b.addClass("r9-datepicker-item-hover"):b.removeClass("r9-datepicker-item-hover");b.removeClass("r9-datepicker-item-selected");if(c.selected&&!c.end){b.addClass("r9-datepicker-item-selected");b.attr("aria-selected",true)}else{if(!c.selected){b.attr("aria-selected",false)}}if(c.start){b.addClass("r9-datepicker-item-start")}}else{R9.Widgets.DaterangePicker.prototype.updateItem.call(this,b,c)}}})})(jq||jQuery);(function(a){R9.extend("Widgets",{DaterangePickerFixed:function(c,b){this.elementNode=c;this.element=a(this.elementNode);if(!this.validateElement()){return}this.startDisplay=a(R9.Widgets.DaterangePicker.findStartDisplay(this.elementNode));this.sepDisplay=a(R9.Widgets.DaterangePicker.findSepDisplay(this.elementNode));this.endDisplay=a(R9.Widgets.DaterangePicker.findEndDisplay(this.elementNode));this.clearDisplay=a(R9.Widgets.DaterangePicker.findClearDisplay(this.elementNode));this.nightsDisplay=a(R9.Widgets.DaterangePicker.findNightsDisplay(this.elementNode));this.placeholderDisplay=a(R9.Widgets.DaterangePicker.findPlaceholderDisplay(this.elementNode));this.input=a(R9.Widgets.DaterangePicker.findInputNode(this.elementNode));this.startInput=a(R9.Widgets.DaterangePicker.findStartInput(this.elementNode));this.endInput=a(R9.Widgets.DaterangePicker.findEndInput(this.elementNode));this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.DaterangePickerFixed",{isDatepicker:function(b){return b&&b.nodeName&&b.nodeName.toLowerCase()=="div"},isWidgetControlled:function(b){return a(b).hasClass(R9.Widgets.DaterangePicker.prototype.widgetBaseClass+"-wrapper")},findStartDisplay:function(b){return document.getElementById(b.id+"-start")},findEndDisplay:function(b){return document.getElementById(b.id+"-end")},findSepDisplay:function(b){return document.getElementById(b.id+"-sep")},findClearDisplay:function(b){return document.getElementById(b.id+"-clear")},findNightsDisplay:function(b){return document.getElementById(b.id+"-nights")},findPlaceholderDisplay:function(b){return document.getElementById(b.id+"-placeholder")},findStartInput:function(b){return jq("#"+b.id+" .r9-datepicker-input.r9-datepicker-start")[0]},findEndInput:function(b){return jq("#"+b.id+" .r9-datepicker-input.r9-datepicker-end")[0]},findInputNode:function(b){return document.getElementById(b.id+"-tab")},getDropdownId:function(b){return"datepicker"}});R9.extend("Widgets.DaterangePickerFixed.prototype",true,R9.Widgets.DaterangePicker.prototype,{options:{rangeDays:34},handleItemClickEvent:function(f,d){var c=this;var b=jq(f);if(b.hasClass("r9-datepicker-enabled")){var g=parseInt(b.attr("data-val"));this.clicks[0]=g;this.clicks[1]=moment(g).add(this.options.rangeDays,"days").valueOf();this.updateDropdownSelection(null);setTimeout(function(){c.hideDropdown(null);if(c.options.change){c.options.change.apply(c,arguments)}if(c.options.nextFieldSelector){jq(c.options.nextFieldSelector).focus()}},this.options.secondClickHideDelay)}this.updateDOM();return false},getHighlitedRange:function(c,d){var b=[0,0];if(d==null){return b}b[0]=parseInt(d.attr("data-val"));b[1]=moment(b[0]).add(34,"days").valueOf();return b},setStartDate:function(b){if(b!=null){this.clicks[0]=b.getTime();this.clicks[1]=moment(this.clicks[0]).add(this.options.rangeDays,"days").valueOf();this.updateDOM()}},setEndDate:function(b){if(b!=null){this.clicks[1]=b.getTime();this.clicks[0]=moment(this.clicks[1]).subtract(this.options.rangeDays,"days").valueOf();this.updateDOM()}}})})(jq||jQuery);(function(a){R9.extend("Widgets",{DaterangePickerOrSingleDate:function(b,c){R9.Widgets.DaterangePicker.call(this,b,c)}});R9.extend("Widgets.DaterangePickerOrSingleDate",{});R9.extend("Widgets.DaterangePickerOrSingleDate.prototype",true,R9.Widgets.DaterangePicker.prototype,{minDate:null,singleDateMode:false,setSingleDateMode:function(b){this.singleDateMode=b;this.updateDOM()},getSingleDateMode:function(){return this.singleDateMode},updateDOM:function(){var b;if(this.singleDateMode){this.element.addClass("r9-datepicker-single-date-mode");this.dropdown.addClass("r9-datepicker-single-date-mode");this.endDisplay.text("");this.endInput.val("");if(this.clicks[0]!=0){b=moment(this.clicks[0]);this.startDisplay.text(b.format(this.options.startFormat));this.startInput.val(b.format(this.options.startInputFormat))}else{this.startDisplay.text("");this.startInput.val("")}if(b==null){this.element.addClass("r9-datepicker-start-empty")}else{this.element.removeClass("r9-datepicker-start-empty")}}else{this.element.removeClass("r9-datepicker-single-date-mode");this.dropdown.removeClass("r9-datepicker-single-date-mode");R9.Widgets.DaterangePicker.prototype.updateDOM.call(this)}},updateHoverDOM:function(b){if(!this.singleDateMode){R9.Widgets.DaterangePicker.prototype.updateHoverDOM.call(this,b)}},computeState:function(d,h,c,b,f,g){if(this.singleDateMode){if(h==c[0]){f.start=true}else{if(h==d){f.highlited=true}}}else{R9.Widgets.DaterangePicker.prototype.computeState.call(this,d,h,c,b,f,g)}},handleItemClickEvent:function(f,d){var c=this;var b=jq(f);if(this.singleDateMode){if(b.hasClass("r9-datepicker-enabled")){var g=parseInt(b.attr("data-val"));this.clicks[0]=g;this.updateDropdownSelection(null);setTimeout(function(){c.hideDropdown(null);if(c.options.change){c.options.change.apply(c,arguments)}if(c.options.nextFieldSelector){jq(c.options.nextFieldSelector).focus()}},this.options.secondClickHideDelay)}this.updateDOM();return false}else{return R9.Widgets.DaterangePicker.prototype.handleItemClickEvent.call(this,f,d)}}})})(jq||jQuery);(function(a){R9.extend("Widgets",{DaterangePickerTwoFieldsWithPastDate:function(b,c){this.options=a.extend({},this.options,c);R9.Widgets.DaterangePickerTwoFields.call(this,b,this.options);if(this.options.scrollContainer){var d=this;var f=jq(this.options.scrollContainer);f.scroll(function(){R9.Widgets.DaterangePickerTwoFields.prototype.hideDropdown.call(d)})}}});R9.extend("Widgets.DaterangePickerTwoFieldsWithPastDate",{});R9.extend("Widgets.DaterangePickerTwoFieldsWithPastDate.prototype",true,R9.Widgets.DaterangePickerTwoFields.prototype,{options:{minDateFunc:function(b){b.minDate=moment("01/01/2000");b.maxDate=moment().startOf("month").add(10,"years")},allowPastDate:true,useLongDisplayFormat:true,scrollContainer:null},handleEndDisplayFocusEvent:function(b,c){var d=this.getEndWrapperElement();if(!d.is(".disabled")){R9.Widgets.DaterangePickerTwoFields.prototype.handleEndDisplayFocusEvent.call(this,b,c)}},handleStartDisplayFocusEvent:function(c,d){var b=this.getStartWrapperElement();if(!b.is(".disabled")){R9.Widgets.DaterangePickerTwoFields.prototype.handleStartDisplayFocusEvent.call(this,c,d)}}})})(jq||jQuery);(function(a){a.fn.daterangePicker=function(c){if(typeof c=="string"){for(var d=0;d<this.length;d++){var b=a(this[d]).data(R9.Widgets.DaterangePicker.prototype.widgetName);if(b){return R9.utils.applyMethod(b,c,Array.prototype.slice.call(arguments,1))}}return null}return this.each(function(){new R9.Widgets.DaterangePicker(this,c)})};a.fn.daterangePickerTwoFields=function(c){if(typeof c=="string"){for(var d=0;d<this.length;d++){var b=a(this[d]).data(R9.Widgets.DaterangePicker.prototype.widgetName);if(b){return R9.utils.applyMethod(b,c,Array.prototype.slice.call(arguments,1))}}return null}return this.each(function(){new R9.Widgets.DaterangePickerTwoFields(this,c)})};a.fn.daterangePickerTwoFieldsWithPastDate=function(c){if(typeof c=="string"){for(var d=0;d<this.length;d++){var b=a(this[d]).data(R9.Widgets.DaterangePicker.prototype.widgetName);if(b){return R9.utils.applyMethod(b,c,Array.prototype.slice.call(arguments,1))}}return null}return this.each(function(){new R9.Widgets.DaterangePickerTwoFieldsWithPastDate(this,c)})};a.fn.daterangePickerFixed=function(c){if(typeof c=="string"){for(var d=0;d<this.length;d++){var b=a(this[d]).data(R9.Widgets.DaterangePicker.prototype.widgetName);if(b){return R9.utils.applyMethod(b,c,Array.prototype.slice.call(arguments,1))}}return null}return this.each(function(){new R9.Widgets.DaterangePickerFixed(this,c)})};a.fn.daterangePickerOrSingleDate=function(c){if(typeof c=="string"){for(var d=0;d<this.length;d++){var b=a(this[d]).data(R9.Widgets.DaterangePicker.prototype.widgetName);if(b){return R9.utils.applyMethod(b,c,Array.prototype.slice.call(arguments,1))}}return null}return this.each(function(){new R9.Widgets.DaterangePickerOrSingleDate(this,c)})}})(jq||jQuery);(function(a){R9.extend("Widgets",{ScrollingFixedPanel:function(c,b){this.elementNode=c;this.element=a(this.elementNode);if(!this.validateElement()){return}this.options=a.extend({},this.options,b);this.init()}});R9.extend("Widgets.ScrollingFixedPanel",{elementInViewport:function(d){var g=d.offsetTop;var f=d.offsetLeft;var c=d.offsetWidth;var b=d.offsetHeight;while(d.offsetParent){d=d.offsetParent;g+=d.offsetTop;f+=d.offsetLeft}return(g<(window.pageYOffset+window.innerHeight)&&f<(window.pageXOffset+window.innerWidth)&&(g+b)>window.pageYOffset&&(f+c)>window.pageXOffset)}});R9.extend("Widgets.ScrollingFixedPanel.prototype",{widgetName:"scrollingFixedPane",elementNode:null,element:null,scrollTimerID:null,oldscrolltop:null,railoffsettop:null,railsoffsetleft:null,railheight:null,windowheight:null,minTop:null,maxTop:null,options:{footerElementID:"ft",scrollTimeoutMS:40},init:function(){this.bindWindowEvents();this.initializeOffsetsAndPosition()},validateElement:function(){return this.element.is(":visible")},bindWindowEvents:function(){var c=this;var b="scroll."+this.widgetName;jq(window).unbind(b).bind(b,function(d){if(c.scrollTimeID!=null){window.clearTimeout(c.scrollTimeID)}c.scrollTimeID=window.setTimeout(function(){R9.Widgets.ScrollingFixedPanel.prototype.scrollContent.apply(c)},c.options.scrollTimeoutMS)});b="resize."+ +this.widgetName;jq(window).unbind(b).bind(b,function(d){c.initializeOffsetsAndPosition();c.scrollContent()})},scrollContent:function(){this.scrollTimerID=null;var b=jq(window).scrollTop();var d=b-this.oldscrolltop;var c=parseInt(this.element.css("top"))-d;if(d<0&&c>0){if(b-this.railoffsettop>0){c=0}}else{if(c<this.minTop&&!R9.Widgets.ScrollingFixedPanel.elementInViewport(document.getElementById(this.options.footerElementID))){c=this.minTop}else{if(c>this.maxTop){c=this.maxTop}}}this.element.css({position:"fixed",left:this.railoffsetleft+"px",top:c});this.oldscrolltop=b},initializeOffsetsAndPosition:function(){this.element.css({position:"static"});this.oldscrolltop=jq(window).scrollTop();this.railoffsettop=this.element.offset().top;this.railoffsetleft=this.element.offset().left;this.railheight=this.element.height();this.windowheight=jq(window).height();this.minTop=(this.railheight-this.windowheight)*(-1);this.maxTop=this.element.offset().top;this.element.css("top",this.railoffsettop)}})})(jq||jQuery);(function(a){a.fn.scrollingFixedPanel=function(b){return this.each(function(){new R9.Widgets.ScrollingFixedPanel(this,b)})}})(jq||jQuery);(function(a){a.fn.expansiveTextArea=function(c){var b=jq(this);var g="50px";if(c&&c.minHeight){g=c.minHeight}if(b.attr("expansive")!="true"){var d=jq(document.createElement("div"));var f=null;b.css({"min-height":g,resize:"vertical",overflow:"hidden"});b.attr("expansive","true");d.css({display:"none","white-space":b.css("white-space"),width:b.css("width"),"min-height":g,"font-family":b.css("font-family"),"font-size":b.css("font-size"),padding:b.css("padding"),"word-wrap":b.css("word-wrap")});d.addClass("expansiveTextAreaHelperDiv");b.after(d);b.on("keyup",function(){f=jq(this).html();f=f.replace(/\n/g,"<br>");d[0].innerHtml=f+'<br class="lbr">';jq(this).css("height",d.height()+10);if(d.height()>parseInt(b.css("max-height"))){b.css("overflow-y","scroll")}else{b.css("overflow-y","hidden")}})}b.keyup()}})(jq||jQuery);R9.extend("Common.Init",{initEllipsisFields:function(){jq(".fdEllipsis").ellipsisTooltip()}});R9.extend("Common.Form",{Loader:function(a,c,b){this.element=jq(a);this.targetElement=c;this.options=jq.extend(true,{},this.defaultOptions,{success:this.successCallback},b||{})}});R9.extend("Common.Form.Loader",{getInstance:function(a,c,b){return new R9.Common.Form.Loader(c,a,b)},getFullForm:function(b,d,c){var a=R9.Common.Form.Loader.getInstance(d,b,c);return a.execute()}});R9.extend("Common.Form.Loader.prototype",{element:null,targetElement:null,defaultOptions:{dataType:"text",error:null,success:null,additionalParams:{uselast:false,getFormOnly:1,responseContentIDAndClass:"inlineSearchForm"},fieldFilters:[{attr:"name",val:"action"}],responseWrapperSelector:"#inlineSearchForm",dialogClass:"inlineSearchFormDlg",draggable:false,triggerAnchor:null,dialogPlacement:"right"},execute:function(b){if(!this.element.length){return false}this._disableTriggerElement();var a=this;jq.ajax({type:this.element.attr("type"),dataType:this.options.dataType,url:this.element.attr("action"),data:jq.extend(this.options.additionalParams,this.collectFormParams(),b||{}),error:function(){if(typeof a.options.error!="function"){return}a.options.error.apply(a,arguments);a._enableTriggerElement()},success:function(){if(typeof a.options.success!="function"){return}a.options.success.apply(a,arguments);a._enableTriggerElement()}});R9.Analytics.api.trackEvent("inlinesearch/moreoptions");return false},successCallback:function(a){this.element.after(a);var d=null;var c=this;var b={draggable:this.options.draggable,dialogClass:this.options.dialogClass,open:function(g,h){var f=this;d=loadResults;loadResults=function(j,k){if(f){if(c.options.triggerAnchor){jq(f).r9popover("destroy")}else{jq(f).r9dialog("destroy")}loadResults=d}d.apply(this,arguments)}},close:function(f,g){if(d){loadResults=d}jq(this).r9dialog("destroy");jq(this).remove()}};if(this.options.triggerAnchor){jq(this.options.responseWrapperSelector).r9popover(jq.extend(b,{position:jq(this.options.triggerAnchor),at:this.options.dialogPlacement}))}else{jq(this.options.responseWrapperSelector).r9dialog(b)}},collectFormParams:function(){var c={};var b=this;jq("input, select",this.element).each(function(){var d=jq(this);if(!b.isSubmitableParameter(d)){return}if(d.prop("tagName")=="INPUT"&&(d.attr("type")=="radio"||d.attr("type")=="checkbox")){if(d.is(":checked")){c[d.attr("name")]=d.val()}}else{c[d.attr("name")]=d.val()}});var a={destinationcode:"destcode"};jq.each(a,function(d,f){c[d]=c[f]});return c},isSubmitableParameter:function(c){var b=jq(c);if(!c.length){return false}if(b.attr("id")==="c2s"&&this.options.additionalParams.getFormOnly===1){return false}for(var a=0;a<this.options.fieldFilters.length;a++){if(c.attr(this.options.fieldFilters[a].attr)==this.options.fieldFilters[a].val){return false}}return true},_disableTriggerElement:function(b){if(!this.targetElement){return}var a=b||b==null?"wait":"";jq(this.targetElement).prop("disabled",b==null?true:b).trigger("mouseout").css("cursor",a);jq("body").css("cursor",a)},_enableTriggerElement:function(){this._disableTriggerElement(false)}});R9.extend("Common.RemoveAccents",{translate_re:/[öäüÖÄÜáàâéèêúùûóòôÁÀÂÉÈÊÚÙÛÓÒÔßæçØøðÇÐÌÍÎÏìíîïÑñŠšŸÿýŽžŒабвгдеёжзийклмнопрстуфхцчшщъыьэюяАБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯΑαΆάΒβΓγΔδΕεΈέΖζΗηΉήΘθΙιΊίΪϊΐΚκΛλΜμΝνΞξΟοΌόΠπΡρΣσςΤτΥυΎύΫϋΰΦφΧχΨψΩωΏώ]/g,translate:{"ä":"a","ö":"o","ü":"u","Ä":"A","Ö":"O","Ü":"U","á":"a","à":"a","â":"a","é":"e","è":"e","ê":"e","ú":"u","ù":"u","û":"u","ó":"o","ò":"o","ô":"o","Á":"A","À":"A","Â":"A","É":"E","È":"E","Ê":"E","Ú":"U","Ù":"U","Û":"U","Ó":"O","Ò":"O","Ô":"O","ß":"s","æ":"o","ç":"c","Ø":"O","ø":"o","ð":"e","Ç":"C","Ð":"D","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Š":"S","š":"s","Ÿ":"Y","ÿ":"y","ý":"y","Ž":"Z","ž":"z","Œ":"O","ć":"c","а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","ё":"jo","ж":"zh","з":"z","и":"i","й":"jj","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"kh","ц":"c","ч":"ch","ш":"sh","щ":"shh","ъ":'"',"ы":"y","ь":"'","э":"eh","ю":"ju","я":"ja","А":"A","Б":"B","В":"V","Г":"G","Д":"D","Е":"E","Ё":"JO","Ж":"ZH","З":"Z","И":"I","Й":"JJ","К":"K","Л":"L","М":"M","Н":"N","О":"O","П":"P","Р":"R","С":"S","Т":"T","У":"U","Ф":"F","Х":"KH","Ц":"C","Ч":"CH","Ш":"SH","Щ":"SHH","Ъ":'""',"Ы":"Y","Ь":"''","Э":"EH","Ю":"JU","Я":"JA","Α":"A","α":"a","Ά":"A","ά":"a","Β":"V","β":"v","Γ":"G","γ":"g","Δ":"D","δ":"d","Ε":"E","ε":"e","Έ":"E","έ":"e","Ζ":"Z","ζ":"z","Η":"I","η":"i","Ή":"I","ή":"i","Θ":"Th","θ":"th","Ι":"I","ι":"i","Ί":"I","ί":"i","Ϊ":"I","ϊ":"i","ΐ":"i","Κ":"K","κ":"k","Λ":"L","λ":"l","Μ":"M","μ":"m","Ν":"N","ν":"n","Ξ":"X","ξ":"x","Ο":"O","ο":"o","Ό":"O","ό":"o","Π":"P","π":"p","Ρ":"R","ρ":"r","Σ":"S","σ":"s","ς":"s","Τ":"T","τ":"t","Υ":"Y","υ":"y","Ύ":"Y","ύ":"y","Ϋ":"Y","ϋ":"y","ΰ":"y","Φ":"F","φ":"f","Χ":"Ch","χ":"ch","Ψ":"Ps","ψ":"ps","Ω":"O","ω":"o","Ώ":"O","ώ":"o"},removeAccentedChars:function(a){var b=this;return(a.replace(b.translate_re,function(c){return b.translate[c]}))}});String.prototype.removeAccentedChars=function(){return R9.Common.RemoveAccents.removeAccentedChars(this)};try{psevents=window.parent.psevents||{}}catch(e){psevents={}}function publish(b,h,d){var c=psevents[b];if(c){var a;for(var j in c){var g=c[j];var f=g.handler;if(f instanceof Function||((typeof f)=="function")){if(d===true){h=a}if(d&&d!==true){a=f.call(d,b,h,a)}else{if(g.context){a=f.call(g.context,b,h,a)}else{a=f.call(h,b,h,a)}}if(a===false){return false}}}return a||h||true}else{return h}}function subscribe(g,d,c){if(d instanceof Function){var g=g.split(",");for(var b=0;b<g.length;++b){var a=g[b].trim();if(!psevents[a]){psevents[a]=[]}psevents[a].push({context:c,handler:d})}}}R9.extend("Common",{AsyncQueue:function(){var a=[];var b;var c={run:function(d){a.push(d);b===undefined&&c.next();return d},next:function(){b=a.shift();b&&b.apply(null,arguments)}};return c}});(function(c){R9.extend("Common",{Cache:function(g){var h=c.extend({},this.options,g,{cache:{},orderedKeys:[],garbageCollectorInterval:null});c.extend(this,{get:function(j){return d(j,h)},set:function(j,l,k){b(j,l,k,h)},getKeys:function(){return a(h)}})}});R9.extend("Common.Cache.prototype",{options:{maxLifeSpam:15*60*1000,defaultLifeSpam:1*60*1000,garbageCollectionTime:0.5*60*1000,maxCacheEntrySize:15},get:function(){},set:function(){}});function d(g,h){if(h.cache[g]){return h.cache[g].value}}function a(h){var g=[];for(key in h.cache){g.push(key)}return g}function b(g,k,j,h){if(!h.garbageCollectorInterval){h.garbageCollectorInterval=setInterval(function(){f(h)},h.garbageCollectionTime)}j=j||h.defaultLifeSpam;j>h.maxLifeSpam&&(j=h.maxLifeSpam);if(h.orderedKeys.length>=h.maxCacheEntrySize){delete (h.cache[h.orderedKeys.splice(0,1)[0]])}if(!h.cache[g]){h.cache[g]={value:k,timeCreated:new Date().getTime(),lifeSpam:j};h.orderedKeys.push(g)}else{h.cache[g].value=k;h.cache[g].timeCreated=new Date().getTime();h.cache[g].lifeSpam=j;h.orderedKeys.push(h.orderedKeys.splice(h.orderedKeys.indexOf(g),1))}}function f(h){var j=new Date().getTime();for(var g in h.cache){if(!h.cache.hasOwnProperty(g)){continue}if(j-h.cache[g].timeCreated>=h.cache[g].lifeSpam){delete (h.cache[h.orderedKeys.splice(h.orderedKeys.indexOf(g),1)[0]])}}h.orderedKeys.length==0&&clearInterval(h.garbageCollectorInterval)}})(jq||jQuery);R9.extend("Common",{GoogleMapsAugmentation:function(){var a={addSetMapAnimation:function(h,g){var b=[];var f;var d=h.setMap;var c=jq.extend(h,{setMap:function(k,l){l===undefined&&(l=true);if(k===null){var n={};c.stopAnimations();jq.each(g,function(m,o){n[o.propertyName]=false;if(l){c.animateProperty(o,o.initialValue,function(){n[o.propertyName]=true;j()})}else{n[o.propertyName]=true;j()}})}else{f=k;c.stopAnimations();jq.each(g,function(m,o){var p={};p[o.propertyName]=o.initialValue;c.setOptions(p)});d.apply(c,[f]);jq.each(g,function(m,o){c.animateProperty(o,o.finalValue)})}function j(){var o=Object.keys(n);var m=true;jq.each(function(p,q){m=m&&n[key]});if(m){d.apply(c,[null]);f=k}}},stopAnimations:function(){jq.each(b,function(j,k){clearTimeout(k)});b=[]},animateProperty:function(s,r,t){var n=s.propertyName;var p=s.duration/30;var m=s.setter||function(w){var v={};v[n]=w;h.setOptions(v)};var q=s.getter||function(){return c[n]};var u=q();var o=0;var l=1;var j;function k(){j&&b.splice(b.indexOf(j),1);var w=Math.max(Math.min(o/p,1),0);var v=R9.Common.GoogleMapsAugmentation.LINEAR(u,r,w);m(v);o+=l;if(v!=r){j=setTimeout(k,30);b.push(j)}else{t&&t()}}setTimeout(k)}})}};return a}()});R9.Common.GoogleMapsAugmentation.LINEAR=function(b,a,c){return(b*(1-c))+(a*c)};R9.Common.GoogleMapsAugmentation.EASE_IN_OUT=function(b,a,c){return b+((a-b)*(1-Math.sin((Math.PI/2)+(c*Math.PI)))/2)};R9.extend("Common.Init",{initEllipsisFields:function(){jq(".fdEllipsis").ellipsisTooltip()}});R9.extend("Common",{Places:{food:["restaurant","food","cafe"],shopping:["shopping_mall","book_store","clothing_store","department_store","electronics_store"],nightlife:["night_club","bar"],beautyAndLifestyle:["spa","beauty_salon","hair_care"],publicTransportation:["subway_station","train_station","bus_station","transit_station"]}});R9.extend("Common",{Session:(function(){return function(a){var c={sessionId:""};var b=jq.extend({},c,a);return{getSessionId:function(){return b.sessionId}}}})()});R9.extend("Common.Utils",{getId:(function(){var a=new Date().getTime();return function(){return ++a}})(),formatPrice:function(b,a){var c=(b*1)+0.5;return(a!==false?R9.globals._LEFT_CURSYMBOL:"")+R9.Common.Utils.formatThousandsSeparator(parseInt(c))+(a!==false?R9.globals._RIGHT_CURSYMBOL:"")},formatThousandsSeparator:function(g,a,h){a=a||R9.globals._PRICE_THOUSANDS_SEPARATOR;h=h||".";var d=g.toString().split(".");var c=d[0];var b=d.length>1?h+d[1]:"";var f=/(\d+)(\d{3})/;if(a.length>0){while(f.test(c)){c=c.replace(f,"$1"+a+"$2")}}return c+b},arrayDifference:function(b,a){var c=[];var d=[];var f=[];jq.each(b,function(g,h){if(a.indexOf(h)<0){d.push(h)}else{f.push(h)}});jq.each(a,function(g,h){if(b.indexOf(h)<0){c.push(h)}});return{added:c,removed:d,unchanged:f}},getDimensions:function(a){jq("body").append(a.addClass("outOfView"));var b={width:a.outerWidth(),height:a.outerHeight()};a.detach();a.removeClass("outOfView");return b},throttle:function(a,c,b){if(isNaN(a)){throw new TypeError("limit must be an number")}var d=0;return function(){if(d<a){d++;var f=Array.prototype.slice.call(arguments);f.push(d===a);f.push(d);return c.apply(b||this,f)}}},after:function(a,c,b){if(isNaN(a)){throw new TypeError("waitCount must be an number")}var d=0;return function(){if(d>=a){return c.apply(b||this,arguments)}d++}},debounce:function(d,a,c){var f,b=0;a=a||200;return function(){var g=Array.prototype.slice.call(arguments);b+=1;clearTimeout(f);f=setTimeout(function(){g.push(b);d.apply(c||this,g)},a)}},defer:function(a){setTimeout(function(){a()},0)},throwop:function(a){return function(){throw new Error((a||"unknown")+" function is abstract and must be overridden")}}});R9.extend("Common.Utils",{Browsers:{isChrome:function(){return !!navigator.userAgent.match(/chrome\/(\d+)/i)},isIE:function(a){var d=-1;if(navigator.appName=="Microsoft Internet Explorer"){var b=navigator.userAgent;var c=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(c.exec(b)!==null){d=parseFloat(RegExp.$1)}if(typeof a!=="undefined"){return a===d}}else{if(Object.hasOwnProperty.call(window,"ActiveXObject")&&!window.ActiveXObject){d=11;if(typeof a!=="undefined"){return a===d}}}return d!==-1},isMobileSafari:function(){return navigator.userAgent.indexOf("AppleWebKit")!==-1&&navigator.userAgent.indexOf("Mobile")!==-1}},URL:{getQueryParams:function(){var d=[],c;var a=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var b=0;b<a.length;b++){c=a[b].split("=");d.push(c[0]);d[c[0]]=c[1]}return d}}});String.prototype.camelizeUpper=function(){return this.substr(0,1).toUpperCase()+this.substr(1)};String.prototype.format=function(){var a=[].slice.call(arguments);function b(d,c){return d.replace("%s",c)}return a.reduce(b,this.valueOf())};if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}Object.values=Object.values||function(a){var c=[];for(var b in a){a.hasOwnProperty(b)&&c.push(a[b])}return c};Array.prototype.each=function(c){var b=0;var a=this.length;for(b;b<a;b++){c(this[b])}};window.getQueryVariable=function(a){var c=window.location.search.substring(1);var d=c.split("&");for(var b=0;b<d.length;b++){var f=d[b].split("=");if(decodeURIComponent(f[0])==a){return decodeURIComponent(f[1])}}};R9.extend("Common.Utils.String",{formatString:function(c,a){var b=arguments;return c.replace(/{(\d)}/g,function(d,f){return b[(parseInt(f,10)||0)+1]})},formatChoice:function(g,a,b){var c=arguments,f,d;g=g.split("|",20);for(d=g.length-1;d>=0;d--){f=g[d].split("#",2);if(a<f[0]){continue}c=Array.prototype.slice.call(c,2);c=Array.prototype.concat([f[1]],c);return R9.Common.Utils.String.formatString.apply(this,c)}}});R9.extend("Common.Utils",{getImageToContainerSize:function(b,f,n,q){var g;var a;if(b>=n&&f>=q){var k,c,j;var d,h,p;k=n;c=n*f/b;j=q-c>=0?q-c:0;d=q*b/f;h=q;p=n-d>=0?n-d:0;if(j<=p){g=k;a=c}else{g=d;a=h}}else{if(b>=n||f>=q){var l=(b>=n)?n/b:q/f;g=b*l;a=f*l}else{g=b;a=f}}g=parseInt(g);a=parseInt(a);Math.abs(n-g)<10&&(g=n);var o=0;var m=0;if(g>n){o=parseInt(g/2-(n/2))}if(a>q){m=parseInt(a/2-(q/2))}if(a<q){m=parseInt((q-a)/2)*(-1)}return{finalWidth:g,finalHeight:a,shiftX:o,shiftY:m}}});(function(){if(!R9.Common.VisibilityMonitor){var d={};var a;R9.extend("Common",{VisibilityMonitor:(function(){return{getInstance:function(){if(!a){a=c()}return a}}})()});setTimeout(function(){window.onscroll=window.onresize=b;b()})}function c(){return{spyMovement:function(m,h,g,j,l){var k={element:h,showfn:g,hidefn:j,offset:l||0,isshown:false,lastVisible:false};d[m]=k;b()},remove:function(g){delete (d[g])}}}function b(){jq.each(Object.values(d),function(g,h){if(f(h.element,h.offset)){h.isshown=true;if(h.lastVisible!=h.isshown){h.showfn();h.lastVisible=h.isshown}}else{h.isshown=false;if(h.lastVisible!=h.isshown){h.hidefn();h.lastVisible=h.isshown}}})}function f(j,l){var k=jq(window).scrollTop();var g=jq(j).offset().top;var h=g+jq(j).height();return((k>g-jq(window).height()-l)&&(k<h+l))}})();(function(a){var b=a(window);R9.extend("Common",{lazyLoad:function(c,d){this.nodes=c;this.options=a.extend({},this.options,d);this.init()}});R9.extend("Common.lazyLoad.prototype",{nodes:null,container:null,options:{threshold:0,event:"scroll",effect:"show",container:window,data_attribute:"original",skip_invisible:true,appear:null,load:null},init:function(){var c=this;this.container=(this.options.container===undefined||this.options.container===window)?b:a(this.options.container);if(0===this.options.event.indexOf("scroll")){this.container.bind(this.options.event,function(){return c.update()})}this.nodes.each(function(){var f=this;var d=a(f);f.loaded=false;f.jqImage=d.children("img");d.on("appear",function(){if(!this.loaded){if(c.options.appear){var g=c.nodes.length;c.options.appear.call(f,g,c.options)}a("<img />").bind("load",function(){c.onImageLoad(f)}).attr("src",f.jqImage.data(c.options.data_attribute))}});if(0!==c.options.event.indexOf("scroll")){d.bind(c.options.event,function(){if(!f.loaded){d.trigger("appear")}})}});b.bind("resize",function(){c.update()});this.update()},onImageLoad:function(d){d.jqImage.hide().attr("src",d.jqImage.data(this.options.data_attribute))[this.options.effect](this.options.effect_speed);d.loaded=true;var c=a.grep(this.nodes,function(g){return !g.loaded});this.nodes=a(c);if(this.options.load){var f=this.nodes.length;this.options.load.call(d,f,this.options)}},update:function(){var c=this;this.nodes.each(function(){var d=a(this);if(c.options.skip_invisible&&!d.is(":visible")){return}if(a.abovethetop(this,c.options)||a.leftofbegin(this,c.options)){}else{if(!a.belowthefold(this,c.options)&&!a.rightoffold(this,c.options)){d.trigger("appear")}}})}});a.fn.lazyLoad=function(c){return new R9.Common.lazyLoad(this,c)};a.belowthefold=function(d,f){var c;if(f.container===undefined||f.container===window){c=b.height()+b.scrollTop()}else{c=a(f.container).offset().top+a(f.container).height()}return c<=a(d).offset().top-f.threshold};a.rightoffold=function(d,f){var c;if(f.container===undefined||f.container===window){c=b.width()+b.scrollLeft()}else{c=a(f.container).offset().left+a(f.container).width()}return c<=a(d).offset().left-f.threshold};a.abovethetop=function(d,f){var c;if(f.container===undefined||f.container===window){c=b.scrollTop()}else{c=a(f.container).offset().top}return c>=a(d).offset().top+f.threshold+a(d).height()};a.leftofbegin=function(d,f){var c;if(f.container===undefined||f.container===window){c=b.scrollLeft()}else{c=a(f.container).offset().left}return c>=a(d).offset().left+f.threshold+a(d).width()};a.inviewport=function(c,d){return !a.rightoffold(c,d)&&!a.leftofbegin(c,d)&&!a.belowthefold(c,d)&&!a.abovethetop(c,d)};a.extend(a.expr[":"],{"below-the-fold":function(c){return a.belowthefold(c,{threshold:0})},"above-the-top":function(c){return !a.belowthefold(c,{threshold:0})},"right-of-screen":function(c){return a.rightoffold(c,{threshold:0})},"left-of-screen":function(c){return !a.rightoffold(c,{threshold:0})},"in-viewport":function(c){return a.inviewport(c,{threshold:0})},"above-the-fold":function(c){return !a.belowthefold(c,{threshold:0})},"right-of-fold":function(c){return a.rightoffold(c,{threshold:0})},"left-of-fold":function(c){return !a.rightoffold(c,{threshold:0})}})})(jq||jQuery);(function(b,a){b.extend("Common",{Emitter:function(f,c){var d=this;d.events={};d.on=function(h,j){var k=d.events[h];if(k==null){d.events[h]=k=a.Callbacks(c==null?"unique":c)}k.add(j)};d.off=function(h,j){var k=d.events[h];if(k==null){return}k.remove(j)};function g(k,j){var l=d.events[k];if(l==null){return d}var h=f||d;l.fire.apply(h,j||[]);return d}d.emit=g;d.trigger=g;d.fire=g;if(f!=null){f.on=function(h,j){return d.on(h,j)};f.off=function(h,j){return d.off(h,j)}}}})})(window.R9,window.jq||window.jQuery);R9.extend("Common.Patterns",{Observable:function(){var a=[];jq.extend(this,{registerListener:function(c,f,d,b){c=c||"default";!a[c]&&(a[c]=[]);jq.each(a[c],function(g,h){h.callback===d&&a[c].splice(h,1)});a[c].push({id:f,callback:d,scope:b})},registerListeners:function(b){var c=this;jq.each(b,function(d,f){c.registerListener.apply(c,f)})},notifyListeners:function(b,d,f){b=b||"default";var c=a[b]||[];jq.each(c,function(g,h){if(h&&h.scope){h.callback.call(h.scope,b,d,f);return}h&&h.callback(b,d,f)})},unregisterListener:function(b,c){b=b||"default";if(a[b]){jq.each(a[b],function(d,f){f.callback===c&&a[b].splice(f,1)})}},unregisterListeners:function(b){var c=this;jq.each(b,function(d,f){c.unregisterListener.apply(c,f)})},unregisterAllListeners:function(){this.unregisterListeners(a)}})}});R9.extend("Common.Patterns.Observable.prototype",{registerListener:function(){},notifyListeners:function(){},unregisterListener:function(){}});R9.extend("Common.Patterns",{Factory:function(){var a={};return{registerProduct:function(b,c){a[b]=c;a[b].registry=new R9.Common.Cache({maxLifeSpam:15*60*1000,defaultLifeSpam:5*60*1000,garbageCollectionTime:0.5*60*1000,maxCacheEntrySize:20})},newInstance:function(c,b){return a[c].createProduct.apply(a[c],b)}}}});R9.extend("Common.Patterns.MVC",{Model:function(){return new R9.Common.Patterns.Observable()}});R9.extend("Common.Patterns.MVC",{View:function(){R9.Common.Patterns.Observable.apply(this,arguments)}});R9.extend("Common.Patterns.MVC.View.prototype",jq.extend(true,{},R9.Common.Patterns.Observable.prototype,{initialize:function(){},destroy:function(){}}));R9.extend("Common.Patterns.MVC",{Controller:function(){return new R9.Common.Patterns.Observable()}});R9.extend("Common.Communication",{ScriptLoader:(function(){var a=[];var b={load:function(c,l,h,m){h=h||false;if(typeof m=="undefined"){m=true}if(m&&jq.inArray(c,a)>-1){l();return}a.push(c);if(h){var f="C"+R9.Common.Utils.getId();var k=document.createElement("script");b.loaderCallbacks[f]=function(){clearTimeout(d);delete (b.loaderCallbacks[f]);l()};var g=c.replace(/^(\s)*http(s)?:\/\//i,location.protocol+"//");k.src=g;l&&(k.src+="&callback=R9.Common.Communication.ScriptLoader.loaderCallbacks."+f);k.type="text/javascript";var d=setTimeout(function(){delete (b.loaderCallbacks[f])},30000);var j=jq("#scripts");j=j.length?j.get(0):document.getElementsByTagName("head")[0];j.appendChild(k)}else{jq.getScript(c,function(){l()})}},loaderCallbacks:{}};return b})()});R9.extend("Common.Communication",{ServerRequestService:(function(){var b;var g=new R9.Common.Cache({maxLifeSpam:15*60*1000,defaultLifeSpam:5*60*1000,garbageCollectionTime:0.5*60*1000,maxCacheEntrySize:20});var f={cluster:function(o,m,j,k,h,l){var n={searchid:o,action:"cluster",ne:m.toUrlValue(),sw:j.toUrlValue(),zoom:k,r:h,callback:l};var p=function(){};if(!window.ssUserAction){window.ssUserAction=window.parent.ssUserAction}ssUserAction("cluster",p,n)},getHotelPhotos:function(j,l,h,n){var k="/hotel/photos?hid="+j;l&&(k+="&width="+l);h&&(k+="&height="+h);var m=g.get(k);if(m){setTimeout(function(){n(jq.parseJSON(m))},0)}else{jq.ajax({url:k}).done(function(o){g.set(k,o);n(jq.parseJSON(o))})}},addFavorite:function(j,h){d(j,h,"/favorites/add")},removeFavorite:function(j,h){d(j,h,"/favorites/remove")},setRecentlyViewedHotel:function(h,k){var j={action:"setRecentlyViewedHotel",hid:h};setTimeout(function(){ssUserAction("setRecentlyViewed",k,j)},0)},getPlaceDetails:function(j,l,m){var h=j.reference;var k=g.get(h);if(k){setTimeout(function(){m(k)},0)}else{!b&&(b=new google.maps.places.PlacesService(l));b.getDetails({reference:h},function(n){g.set(h,n);m(n)})}},updateXSell:function(n,l,j,o,h,k){var m={ctid:n,checkIn:l,checkOut:j,guests:o,tabType:R9.globals.vertical};h&&(m.originCode=h);k&&(m.destinationCode=k);new R9.Ajax("/s/run/fd/xsell/common",{data:m}).execute()},updateXSellByForm:function(j){var h=j.tab.value;new R9.Ajax("/s/run/fd/xsell/"+h,{data:jq(j).serialize(),type:"POST"}).execute()}};if(R9.Common.Places){var c=600;var a={};jq.each(R9.Common.Places,function(h,j){a["poll"+h.camelizeUpper()]=function(m,l,o){!b&&(b=new google.maps.places.PlacesService(l));b.search({location:m.getLocation().googleLatLon,radius:c,types:j},n);var k={success:true};function n(p,q){if(q===google.maps.places.PlacesServiceStatus.OK){k[h]=p;o(k)}else{jq.extend(k,{success:false,error:q});o(k)}}}});jq.extend(f,a)}return f;function d(l,k,h){var j={id:l,searchtype:window.SearchType};jq.ajax({url:h,data:j,dataType:"json"}).done(k)}})()});(function(a){R9.extend("Common.Model",{Favorites:function(){R9.Common.Patterns.Observable.apply(this,arguments)}});R9.extend("Common.Model.Favorites.prototype",a.extend(true,{},R9.Common.Patterns.Observable.prototype,{count:0,favorites:[],addFavorite:function(c,b){if(b===undefined){b=true}this.favorites.push(c);this.count++;if(b){this.notifyListeners(R9.Common.Model.Favorites.Events.FAVORITE_ADDED,this,{id:c})}},isFavorite:function(b){return a.inArray(b,this.favorites)>-1},removeFavorite:function(d,c){if(c===undefined){c=true}var b=this.favorites.indexOf(d);if(b>-1){this.favorites.splice(b,1);this.count--;if(c){this.notifyListeners(R9.Common.Model.Favorites.Events.FAVORITE_REMOVED,this,{id:d})}}}}));R9.Common.Model.Favorites.Events={FAVORITE_ADDED:"favoriteAdded",FAVORITE_REMOVED:"favoriteRemoved"}})(jq||jQuery);(function(a){R9.extend("Common",{ClientStorageManager:function(b){if(b){this.options=a.extend({},this.options,b)}this.init()}});R9.extend("Common.ClientStorageManager.prototype",{_storage:null,options:{defaultCookieExpire:10,storageKey:null},_loadStorageInstance:function(){return this._getLocalStorage(this.options.storageKey)},_createExpirationTimestamp:function(b){return moment().add(b||0,"hours").toDate()},_shouldExpire:function(b){return moment().diff(moment(b))>0},_serialize:function(b){return typeof b==="object"?JSON.stringify(b):b},_deserialize:function(c){try{return JSON.parse(c)}catch(b){return c}},_setLocalStorage:function(b,c){localStorage.setItem(b,this._serialize(c))},_getLocalStorage:function(b){return this._deserialize(localStorage.getItem(b))},getCookie:function(b){return this._deserialize(a.cookie(b))},setCookie:function(d,f,c){var b=this._serialize(f);if(c===undefined){c={}}if(!c.expires){c.expires=this._createExpirationTimestamp(this.options.defaultCookieExpire)}a.cookie(d,b,c)},init:function(){if(this.options.storageKey){this._storage=this._loadStorageInstance()||{}}},save:function(){this._setLocalStorage(this.options.storageKey,this._storage)},purge:function(){localStorage.removeItem(this.options.storageKey);this._storage={}}})})(jq||jQuery);(function(a){R9.extend("Common",{UserHistory:function(b){if(R9.Common.UserHistory.prototype._Instance){return R9.Common.UserHistory.prototype._Instance}this.options=a.extend({},this.options,b);this.init();R9.Common.UserHistory.prototype._Instance=this}});R9.extend("Common.UserHistory.prototype",{pageTab:"other",wasLastUsedPage:false,searchHistoryLimit:3,options:{defaultCookiExpire:10,defaultSearchExpire:100,persistLocalStorage:true,onSave:a.noop},_storage:{sticky:{origin:"",destination:"",guests:"",depart_date:"",return_date:"",travelersObject:""},lastUsedTab:"",canary:3},_storageKey:"BKHISTORY",page:{searches:[],last_updated:null},history:[],hasSearchHistory:false,searchHistoryMoreRecent:false,_loadStorageInstance:function(){var b=this._storage.canary;var c=this._getLocalStorage(this._storageKey);if(!c||!c.canary||c.canary!==b){c=this._storage}return c},_createExpirationTimestamp:function(c){var b=moment();b.add(c||0,"hours");return b._d},_shouldExpire:function(b){return moment().diff(moment(b))>0},_serialize:function(b){return typeof b==="object"?JSON.stringify(b):b},_deserialize:function(c){try{return JSON.parse(c)}catch(b){return null}},_setCookie:function(d,f,c){var b=this._serialize(f);if(c===undefined){c={}}if(!c.expires){c.expires=this._createExpirationTimestamp(this.options.defaultCookieExpire)}a.cookie(d,b,c)},_setLocalStorage:function(b,c){localStorage.setItem(b,this._serialize(c))},_getLocalStorage:function(b){return this._deserialize(localStorage.getItem(b))},init:function(){this.dirty=false;this.pageTab=a("input[name=tab]").val()||this.pageTab;this._storage=this._loadStorageInstance();if(this._storage.lastUsedTab===this.pageTab){this.wasLastUsedPage=true}this.page=this._storage[this.pageTab]=this._storage[this.pageTab]||this.page;this.sticky=this._storage.sticky;this.history=this.page.searches;this.evictExpiredSearches();if(this.history.length>0){this.hasSearchHistory=true;if(this.page.last_updated&&moment(this.page.last_updated).diff(this.history[0].createdAt)<0){this.searchHistoryMoreRecent=true}}var b=this;a(window).bind("beforeunload",function(){try{b.save()}catch(c){}})},save:function(){try{this.options.onSave.call(this)}catch(b){return false}if(this.dirty&&this.options.persistLocalStorage){this._storage.lastUsedTab=this.pageTab;this._storage.common=this.common;this.page.searches=this.history;this._storage[this.pageTab]=this.page;this._setLocalStorage(this._storageKey,this._storage)}},get:function(b){return this.page[b]},set:function(b,c){if(!this.dirty){this.dirty=true;this.page.last_updated=this._createExpirationTimestamp()}this.page[b]=c},setSticky:function(b,c){if(!this.dirty){this.dirty=true}this.sticky[b]=c},reduceTravelersObjectToTotal:function(){var b=this.sticky.travelersObject;var c=0;if(b){c+=parseInt(b.adults);c+=parseInt(b.youth);c+=parseInt(b.children);c+=parseInt(b.infants);c+=parseInt(b.lapinfants);c+=parseInt(b.seniors)}return c},getRecentHistory:function(){var c=this.hasSearchHistory&&this.searchHistoryMoreRecent?this.history[0]:null;if(!c){c={};for(var b in this.page){c[b]=this.get(b)}delete c.last_updated;delete c.searches}return c},evictExpiredSearches:function(){var b=this;if(this.history.length===0){return}if(this.history.length>this.searchHistoryLimit){this.history=this.history.slice(0,this.searchHistoryLimit)}this.history=this.history.filter(function(c){return !b._shouldExpire(c.expiresBy)})},pushSearchHistory:function(b){b.expiresBy=this._createExpirationTimestamp(this.options.defaultSearchExpire);b.createdAt=this._createExpirationTimestamp();this.dirty=true;this.history.splice(0,0,b)},purge:function(){localStorage.removeItem(this._storageKey);this._storage={};this.options.persistLocalStorage=false}})})(jq||jQuery);(function(a){R9.extend("Common",{SmartyHistory:function(c){var d=c.historyType;if(!d){d="flight"}var b=R9.Common.SmartyHistory.prototype["_"+d+"Instance"];if(b){b.init();return R9.Common.SmartyHistory.prototype["_"+d+"Instance"]}this.options=a.extend({},this.options,c);this.init();R9.Common.SmartyHistory.prototype["_"+d+"Instance"]=this}});R9.extend("Common.SmartyHistory",{SmartyFlightHistory:function(b){return R9.Common.SmartyHistory.call(this,a.extend({historyType:"flight"},b))},SmartyHotelHistory:function(b){return R9.Common.SmartyHistory.call(this,a.extend({historyType:"hotel"},b))},SmartyCarHistory:function(b){return R9.Common.SmartyHistory.call(this,a.extend({historyType:"car"},b))},SmartyClearHistory:function(){if(typeof R9Anon!=="undefined"&&R9Anon){if(this.currentSmartyHistory){this.currentSmartyHistory.clearHistory();this.currentSmarty.hideDropdown();this.currentSmarty.runSearch(false)}R9.Analytics.api.trackEvent("smartyHistory/click/clearHistory/Anon")}else{window.location.assign("/history");R9.Analytics.api.trackEvent("smartyHistory/click/clearHistory/LoggedIn")}}});R9.extend("Common.SmartyHistory.prototype",{history:null,received:false,options:{historyType:"flight",maxSearchHistory:30,searchHistorySubtype:"",showPastDates:R9.config.getBoolean("ui.smarty-history.showPastDates",false)},init:function(){if(!this.received||this.history==null){this.update()}},update:function(){var b=this;a.ajax({type:"GET",dataType:"json",url:"/s/run/recentsearchhistory/gethistory",data:{searchType:b.options.historyType,maxSearchHistoryNum:b.options.maxSearchHistory,searchHistorySubtype:b.options.searchHistorySubtype},success:function(d){if(d){b.history=d;b.processPastDates();b.received=true;for(var c=0;c<b.history.length;c++){var f=b.history[c];f.idx=c}}}})},clearHistory:function(){this.history=[];var b=this;a.ajax({type:"POST",url:"/s/run/recentsearchhistory/clearhistory",data:{searchType:b.options.historyType},success:function(c){b.history=[]}})},matchWord:function(d,b){var c=d.indexOf(b);if(c===0){return c}else{c=d.indexOf(" "+b);if(c>-1){c=c+1}}return c},processPastDates:function(){var g=[];if(this.history===null){return}for(var d=0;d<this.history.length;d++){var j=this.history[d];var b=j.startDate||j.checkinDate;var k=j.endDate||j.checkoutDate;if(b&&k){var h=new moment(b);var f=new moment(k);var c=new moment();if(h.isBefore(c,"day")||f.isBefore(c,"day")){if(this.options.showPastDates){j.isPast=true;g.push(j)}}else{g.push(j)}}}this.history=g}});R9.extend("Common.SmartyHistory.SmartyFlightHistory.prototype",true,R9.Common.SmartyHistory.prototype,{filter:function(l,j,c,d,k){c=c||Infinity;var f=[];if(this.history==null){return[]}var g=[];if(!j&&k!==""){for(var h=0;h<this.history.length;h++){var n=this.history[h];if(n.departCode===k){g.push(n)}}}else{g=this.history}g=this.filterByRoundTrip(g,d);if(l===""){return g.slice(0,c)}for(var h=0;h<g.length;h++){var n=g[h];var b=n.departShortName+" "+n.departAirportName.toUpperCase();if(!j){b=n.destShortName+" "+n.destAirportName.toUpperCase()}var m=this.matchWord(b,l);if(m>-1){f.push(n);if(f.length>=c){break}}}return this.filterByRoundTrip(f,d).slice(0,c)},filterByRoundTrip:function(g,f){if(g==null){return[]}if(R9.config.getBoolean("ui.flight.smarty-history.separateRTOW",false)){var d=[];for(var b=0;b<g.length;b++){var c=g[b];if(c.isRoundTrip===f){d.push(c)}}return d}else{return g}}});R9.extend("Common.SmartyHistory.SmartyHotelHistory.prototype",true,R9.Common.SmartyHistory.prototype,{filter:function(b,h){h=h||Infinity;var c=[];if(this.history==null){return[]}if(b==""){return this.history.slice(0,h)}for(var d=0;d<this.history.length;d++){var g=this.history[d];var j=g.location.toUpperCase();var f=this.matchWord(j,b);if(f>-1){c.push(g);if(c.length>=h){break}}}return c.slice(0,h)}});R9.extend("Common.SmartyHistory.SmartyCarHistory.prototype",true,R9.Common.SmartyHistory.prototype,{filter:function(k,h,d,j){d=d||Infinity;var f=[];if(this.history==null){return[]}var b=this.filterByOneWay(this.history,j);if(k===""){return b.slice(0,d)}for(var g=0;g<b.length;g++){var m=b[g];var c=(m.airportCode==null)?m.location.toUpperCase():m.location.toUpperCase()+" "+m.airportCode;if(!h){c=(m.airportCode2==null)?m.location2.toUpperCase():m.location2.toUpperCase()+" "+m.airportCode2}var l=this.matchWord(c,k);if(l>-1){f.push(m);if(f.length>=d){break}}}return this.filterByOneWay(f,j).slice(0,d)},filterByOneWay:function(g,b){if(g==null){return[]}var f=[];for(var c=0;c<g.length;c++){var d=g[c];if(d.oneWay===b){f.push(d)}}return f}})})(jq||jQuery);(function(a){R9.extend("Common",{SmartyControlGroup:function(b){this.options=a.extend({},this.options,b);this.init()}});R9.extend("Common.SmartyControlGroup.prototype",{options:{form:"",smartyHistory:null,daterangePicker:"",startFormat:R9.Widgets.DaterangePicker.prototype.options.startFormat,endFormat:R9.Widgets.DaterangePicker.prototype.options.endFormat},type:"flight",getHistory:function(){return this.options.smartyHistory()},getTime:function(b){if(b==null){return null}else{return b.getTime()}},validateDate:function(b){if(b==null){return null}else{return this.datepicker().utils.validate(new Date(b))}},datepicker:function(){return a(this.options.daterangePicker).data("datepicker")}});R9.extend("Common.SmartyControlGroup",{SmartyFlightControlGroup:function(b){R9.Common.SmartyControlGroup.call(this,b)},SmartyHotelControlGroup:function(b){R9.Common.SmartyControlGroup.call(this,b)},SmartyCarControlGroup:function(b){R9.Common.SmartyControlGroup.call(this,b)}});R9.extend("Common.SmartyControlGroup.SmartyFlightControlGroup.prototype",true,R9.Common.SmartyControlGroup.prototype,{options:a.extend(R9.Common.SmartyControlGroup.prototype.options,{form:null,originInput:"",destInput:"",originCode:"",destCode:"",daterangePicker:"",cabin:"",travelers:"",nearbyDeparture:"",nearbyArrival:"",isRoundTrip:null}),init:function(){this.type="flight"},setFieldsFromHistoryItem:function(d,c){this.datepicker().setStartDate(this.validateDate(d.startDate));this.datepicker().setEndDate(this.validateDate(d.endDate));a(this.options.nearbyDeparture).prop("checked",d.departureAllowNearby);a(this.options.nearbyArrival).prop("checked",d.arrivalAllowNearby);if(c){this.options.form.noCheckInfant=true}this.setTravelersFromHistoryItem(d);if(c){this.options.form.noCheckInfant=false}if(c){a(this.options.originInput).val(d.departAirportName);a(this.options.destInput).val(d.destAirportName);a(this.options.originCode).val(d.departCode);a(this.options.destCode).val(d.destCode)}else{var b={type:"ap",id:d.departCode,short_str:d.departAirportName};a(this.options.originInput).data("smarty").setItem(b);var f={type:"ap",id:d.destCode,short_str:d.destAirportName};a(this.options.destInput).data("smarty").setItem(f)}},saveFieldsToHistoryItem:function(){var b={};b.departAirportName=a(this.options.originInput).val();b.destAirportName=a(this.options.destInput).val();b.departCode=a(this.options.originCode).val();b.destCode=a(this.options.destCode).val();b.startDate=this.getTime(this.datepicker().getStartDate());b.endDate=this.getTime(this.datepicker().getEndDate());b.departureAllowNearby=a(this.options.nearbyDeparture).prop("checked");b.arrivalAllowNearby=a(this.options.nearbyArrival).prop("checked");a(this.options.travelers).each(function(c){var f=a(this).data("r9NumberBox");var d=a(this).parent().data("for").toLowerCase();b[d]=f.getValue()});b.cabin=a(this.options.cabin).val();return b},isRoundTrip:function(){if(typeof this.options.isRoundTrip==="function"){return this.options.isRoundTrip()}else{if(a("#roundtrip").attr("checked")==="checked"){return true}else{if(a(".inlineSearchAgainView").length>0&&a('[name="oneway"]',".inlineSearchAgainView").val()!=="y"){return true}else{return false}}}},setTravelersFromHistoryItem:function(d){var b=0;a(this.options.travelers).each(function(f){var h=a(this).data("r9NumberBox");var g=a(this).parent().data("for").toLowerCase();var j=d[g];b+=j;if(h!=undefined){h.setValue(j)}});var c=a(".ptcAdults .r9NumberBox",a(this.options.form.e)).data("r9NumberBox");if(b==0){c.setValue(1)}if(a(this.options.cabin).length>0){a(this.options.cabin).val(d.cabin)}this.setTravelerCount();c.options.callback.call(c,0)},setTravelerCount:function(){var d=0;a(".fieldInputPTCType .numberHolder",this.form).each(function(j){var k=+a(this).val();if(!isNaN(k)){d+=k}});if(!d&&a("select#mobiletravelers",this.form).length){d=+a("#mobiletravelers",this.form).val()}a("[name=travelers]",this.form).val(d);var f;if(d==1){f="adults";a(".fieldInputPTCType",this.form).each(function(){if(a(this).find(".numberHolder").val()==1){f=a(this).data("for").toLowerCase();return false}})}else{f="traveler_count"}var b=a("#travelers, #travelers2",this.form),h=b.data("dropdownDialog");if(h){if(this.statusMessage[f]===undefined){f="traveler_count"}var c=this.statusMessage[f];if(c!==undefined){if(f==="traveler_count"){c=R9.Common.Utils.String.formatChoice(c,d,d)}else{c=R9.Common.Utils.String.formatString(c,d)}var g=a("#cabin option:selected",this.form).text();h.updateLabel(c+", "+g)}}},statusMessage:{adults:"{0} adult",seniors:"{0} senior",children:"{0} child",traveler_count:"1#1 traveler|2#{0} travelers"}});R9.extend("Common.SmartyControlGroup.SmartyHotelControlGroup.prototype",true,R9.Common.SmartyControlGroup.prototype,{options:a.extend(R9.Common.SmartyControlGroup.prototype.options,{form:null,locationInput:"",ctid:"",lmid:"",hid:"",nhid:"",daterangePicker:"",rooms:"",guests:"",minStars:"",priceRange:"",rating:""}),init:function(){this.type="hotel"},setFieldsFromHistoryItem:function(d,c){this.datepicker().setStartDate(this.validateDate(d.checkinDate));this.datepicker().setEndDate(this.validateDate(d.checkoutDate));a(this.options.rooms).data("r9NumberBox").setValue(d.rooms);a(this.options.guests).data("r9NumberBox").setValue(d.guests);a(this.options.minStars).val(d.minStars);a(this.options.rating).val(Math.floor(d.rating/10));if(c){a(this.options.locationInput).val(d.location);a(this.options.ctid).val(d.ctid);a(this.options.lmid).val(d.lmid);a(this.options.hid).val(d.hid);a(this.options.nhid).val(d.nhid);a(this.options.frid).val(d.frid);a(this.options.rid).val(d.rid);a(this.options.cid).val(d.cid)}else{var b={id:d.ctid,str:d.location,lmid:d.lmid,hid:d.hid,nhid:d.nhid,frid:d.frid,rid:d.rid,cid:d.cid};a(this.options.locationInput).data("smarty").setItem(b)}},saveFieldsToHistoryItem:function(){var b={};b.location=a(this.options.locationInput).val();b.ctid=a(this.options.ctid).val();b.lmid=a(this.options.lmid).val();b.hid=a(this.options.hid).val();b.nhid=a(this.options.nhid).val();b.frid=a(this.options.frid).val();b.rid=a(this.options.rid).val();b.cid=a(this.options.cid).val();b.checkinDate=this.getTime(a(this.options.daterangePicker).daterangePicker("getStartDate"));b.checkoutDate=this.getTime(a(this.options.daterangePicker).daterangePicker("getEndDate"));b.rooms=a(this.options.rooms).data("r9NumberBox").getValue();b.guests=a(this.options.guests).data("r9NumberBox").getValue();b.minStars=a(this.options.minStars).val();b.rating=Math.floor(a(this.options.rating).val()*10);return b}});R9.extend("Common.SmartyControlGroup.SmartyCarControlGroup.prototype",true,R9.Common.SmartyControlGroup.prototype,{options:{form:null,location:"",location2:"",ctid1:"",ctid2:"",daterangePicker:"",pickupHour:"",dropoffHour:""},init:function(){this.type="car"},isOneWay:function(){if(typeof this.options.isOneWay==="function"){return this.options.isOneWay()}else{if(a("#carsearchbar").hasClass("oneway")){return true}else{if(a(".inlineSearchAgainView").length>0&&a('[name="oneway"]',".inlineSearchAgainView").val()==="y"){return true}else{return false}}}},setFieldsFromHistoryItem:function(f,d){this.datepicker().setStartDate(this.validateDate(f.startDate));this.datepicker().setEndDate(this.validateDate(f.endDate));a(this.options.pickupHour).val(f.pickupHour);a(this.options.dropoffHour).val(f.dropoffHour);if(d){if(f.airportName){a(this.options.location).val(f.airportDisplayName)}else{a(this.options.location).val(f.location)}if(f.airportName2){a(this.options.location2).val(f.airportDisplayName2)}else{a(this.options.location2).val(f.location2)}a(this.options.ctid1).val(f.cityCode);a(this.options.ctid2).val(f.cityCode2)}else{var c={id:f.cityCode,str:f.airportDisplayName||f.location};a(this.options.location).data("smarty").setItem(c);var b={id:f.cityCode2,str:f.airportDisplayName2||f.location2};a(this.options.location2).data("smarty").setItem(b)}},saveFieldsToHistoryItem:function(){var b={};b.location=a(this.options.location).val();b.location2=a(this.options.location2).val();b.cityCode=a(this.options.ctid1).val();b.cityCode2=a(this.options.ctid2).val();b.startDate=this.getTime(this.datepicker().getStartDate());b.endDate=this.getTime(this.datepicker().getEndDate());b.pickupHour=a(this.options.pickupHour).val();b.dropoffHour=a(this.options.dropoffHour).val();return b}})})(jq||jQuery);function kmail(a){document.write('<a class="mlink" href="mailto:'+a+'&#64;kayak&#46;com">'+a+"&#64;kayak&#46;com</a>")}function kmail2(b,a){document.write('<a class="mlink" href="mailto:'+b+"&#64;"+a+'">'+b+"&#64;"+a+"</a>")}function validateEmail(a){if(a&&a.length>0){var b=a.length;if(b-a.replace(/@/g,"").length!=1){return false}var c=a.match("^(.+)@(.+?)$");if(c!=null){if(c[1]!=null){if(c[1].match(/^\"?[@\'\w-_\.\+]*\"?$/)==null){return false}}if(c[2]!=null){return c[2].match(/^[\w-\.]*\.[A-Za-z]{2,6}$/)!=null||c[2].match(/^\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\]$/)!=null}}}return false}function getRadioValue(a){return jq(a).filter(":checked").val()||null}function showmessage(c,b){var a=jq("#messagebox");if(!a.length){a=jq("<div id='messagebox'></div>").appendTo("body").r9dialog({autoOpen:false,closeOnEscape:false,dialogClass:"messagebox",modal:false,position:["center",185],showCloseX:false})}a.html(c);if(b){a.r9dialog("option","title",b).r9dialog("widget").removeClass("ui-dialog-no-title")}else{a.r9dialog("widget").addClass("ui-dialog-no-title")}a.r9dialog("open")}function hidemessage(){if(jq("#messagebox").length>0){jq("#messagebox").r9dialog("close")}}function msie(a){return jq.browser.msie&&(!a||a>=jq.browser.version-0)&&jq.browser.version-0||0}function getFader(){var a=jq("#faderPane");if(!a.length){a=jq("<div id='faderPane' class='faderPane'></div>").appendTo("body")}return a}function toggleFaderPane(a,b){fader=getFader();if(a){fader.css("height",jq(window).height()).show();jq(window).resize(function(){fader.css("height",jq(window).height())})}else{fader.hide()}hideMeOnPopup(a);fader[0].onclick=(typeof b=="function")&&a?b:null}function htmlSafe(a){return a.replace(/\&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;")}function stripSpaces(a){return a.replace(/\s/g,"")}function safeSpaces(a){return a.replace(/\s/g,"%20")}function displaysmartad(iframe,rank){if(window.skipSmartAd){return}var innerIFrame=jq(iframe).contents().find("iframe");if(innerIFrame!=null&&innerIFrame.length>0){iframe=innerIFrame}var smtaddiv=jq(iframe).contents().find("body #smtdiv");try{var smtad=eval("smtad="+jq(smtaddiv).text());smtad.searchid=smtad.searchid||window.searchid;if(smtad.provider_code&&smtad.searchid){getsmartadcreative(rank,smtad.provider_code,smtad.searchid,smtad.click_tracking,smtad.sz,true,Streaming.done);if(!Streaming.done){pollsmartadcreative(rank,smtad.provider_code,smtad.searchid,smtad.click_tracking,smtad.sz)}}}catch(ignored){}}function getsmartadcreative(d,a,l,c,g,b,k){var h=document.getElementById("displayAd"+d),j;if(R9.Ads.SmartAd.imageSlotEnabled){if(d==="0"){j="R0"}else{if(d==="1"){j="R1"}else{if(d==="4"||d==="3"){j="M0"}}}}else{if(d==="1"){j="R0"}else{if(d==="3"){j="M0"}}}if(!j){j="R0"}if(h){var m="/h/ads/smartad?provider_code="+safeSpaces(a)+"&searchid="+l+"&clicktracking="+encodeURIComponent(c)+"&sz="+g+"&rank="+d+"&logimpr="+b+"&strm="+k+"&pageorigin_location="+j+"&isstreaming="+(typeof Streaming!=="undefined"?Streaming.done:false);if(navigator.appVersion.indexOf("MSIE")!=-1&&!window.showNewGPTAds){var f=document.getElementById("displayAdSpanFrame"+d);f.innerHTML=f.innerHTML.replace(/src="[^"]*"/,'src="'+m+'"')}else{setIframeUrl(h,m)}}}function pollsmartadcreative(f,a,b,d,c){if(!Streaming.done){setTimeout(function(){pollsmartadcreative(f,a,b,d,c)},1000)}else{getsmartadcreative(f,a,b,d,c,false,true)}}function loadDisplayAds(){window.showNewGPTAds&&showNewGPTAds()}function displayGPTCallback(){jq("div.GPT").each(function(){var b=jq(this);var d=b.attr("id").replace("displayAd","");try{var a=jq(b).find("iframe").contents().find("body #smtdiv");if(a&&a.length==1){displaysmartad(jq(b).find("iframe"),d)}}catch(c){}})}jq(loadDisplayAds);function resizeIframeToContents(a){if(window.showNewGPTAds){return}if(a==null){return}var g=jq(a).contents().find("iframe");if(g!=null&&g.length>0){a=g}var f=jq(a).attr("id").replace("displayAd","displayAdHide");var b=false;var d=jq(a).contents().find("body img");if(!d||d.length==0){d=jq(a).contents().find("iframe").contents().find("body img")}if(d&&d.length==1&&d.attr("src")!=null&&d.attr("src").indexOf("/kayakadpixel.gif")>0){b=true}if(!d||d.length==0){d=jq(a).contents().find("iframe").contents().find("body div.kayakadpixel");if(d&&d.length==1){b=true}else{d=jq(a).contents().find("iframe").contents().find("body > *");if(!d||d.length==0){b=true}}}var c;if(b){c=f.replace("displayAdHide","");jq("#bannerad"+c).hide();jq("#"+f).hide()}else{jq("#"+f).css("visibility","visible");c=f.replace("displayAdHide","");jq("#bannerad"+f.replace("displayAdHide","")).show();if(c=="2"){jq("#"+f).show()}}}var clearFlagTimer=null;var canReloadAds=true;function reloadBannerAds(){if(canReloadAds){canReloadAds=false;if(window.refreshGPTAds){refreshGPTAds()}else{b()}R9.Analytics.api.trackEvent("bannerreload");d()}else{clearTimeout(clearFlagTimer);d()}function c(h){var n=document.getElementById(h);if(n!=null){if(!n.src){if(window.Streaming){Streaming.dbg(h+" NAF")}return}var l=navigator.appVersion.indexOf("MSIE")!=-1?n.contentWindow.location.href:n.src;if(typeof(document.bannerUrls)!="undefined"){if(document.bannerUrls[h]!=null){l=document.bannerUrls[h]}}var k=(new Date()).getTime();var m=(l.indexOf("&ad_ts=")<0?l+"&ad_ts="+(new Date()).getTime():l.substring(0,l.indexOf("&ad_ts")))+"&ad_ts="+(new Date()).getTime();var g=new RegExp("ord%3D([0-9]*)%3F");if(m.match(g)){m=m.replace(g,"ord%3D"+k+"%3F")}var j=n;var f=jq(j).hasClass("hideAllAds");setIframeUrl(n,m);jq(j).load(function(){if(f){var p=0;var o=setInterval(function(){try{q()}catch(r){clearInterval(o)}},1000);function q(){if(p==2){if(!jq(j).hasClass("hide_all_displayed_ads_before_load")){jq(j).addClass("hide_all_displayed_ads_before_load")}}var r=jq(j).contents().find("#output").height();if(r>50){jq(j).removeClass("hide_all_displayed_ads_before_load");clearInterval(o)}if(p++>30){clearInterval(o)}}}})}if(jq("#displayAdSpanFrame2").length>0){jq("#displayAdHide2").show()}else{jq("#displayAdHide2").hide()}}function a(f){f=document.getElementById(f);return f&&f.style.display!="none"}function b(){c("displayAd1","1");if(a("bannerad2")){c("displayAd2","2")}if(a("bannerad3")){c("displayAd3","3")}if(a("bannerad4")){c("displayAd4","4")}}function d(){clearFlagTimer=setTimeout(function(){canReloadAds=true},R9.globals.adsRefreshTimer||2500)}}function loadTT(g,b){var a=g.match(/^\#ttip(.*)/);var c=a&&a[1];if(!c||jq(g).length){b();return}var f=function(){if(!jq(g).length){jq("<div id='ttip"+c+"'></div>").appendTo("body")}b()};var d={action:"ttip",t:c};if(R9.ttip&&R9.ttip[c]){if(R9.ttip[c].empty){return f()}jq.extend(d,R9.ttip[c].params)}return ssAJAX("/s/toolbox",d,f)}function showTT(d,g,c,a,b,f){loadTT("#ttip"+c,function(){if(g!=""){jq("#ttipText"+c).html(g)}if(c=="BL"){var h=jq("#ttip"+c);h.css({left:"-9999",visibility:"visible"}).show(function(){_showTT(d,g,c,a,b,f)})}else{_showTT(d,g,c,a,b,f)}})}function _showTT(j,k,g,l,d,b){if(d==null||!d){hideAllTT(false)}else{if(b!=null){parts=b.split(",");for(var f=0;f<parts.length;f++){hideTTType(parts[f])}}}var h=jq("#ttip"+g);obj=document.getElementById("ttip"+g);obj.style.display="block";var c=jq(j).offset();var m=c.top;var a=c.left;if(l!=null){m+=l.y;a+=l.x}if(g=="BL"){h.show(function(){jq(this).position({my:"left bottom",at:"left top",offset:"-30 5",of:jq(j)})});return}else{if(g=="TL"){m=m+j.offsetHeight-5;a=a+j.offsetWidth-50}else{if(g=="CL"){m=m+j.offsetHeight-30;a=a+j.offsetWidth+25}else{if(g=="CR"||g=="FSP"){m=m-(h.outerHeight()/2)+(j.offsetHeight/2);if(g=="CL"||g=="FL"||g=="FSP"){a=a+j.offsetWidth}else{a=a-h.outerWidth()}}else{if(g=="FL"){a=a+jq(j).outerWidth()+20;m=m+(jq(j).outerHeight()/2)-65}else{if(g=="DL"){a=a+jq(j).outerWidth();m=m+(jq(j).outerHeight()/2)-50;obj.style.zIndex="45"}else{if(g=="DR"){m=m+(jq(j).outerHeight()/2)-50;a=a-(jq(obj).outerWidth()+3);obj.style.zIndex="45"}else{if(g=="CT"||g=="CB"){m=m-0+j.offsetHeight;if((jq.browser.mozilla||jq.browser.safari)&&(g=="CL"||g=="FL")){m+=8}else{if(jq.browser.msie&&parseInt(jq.browser.version)==6){}}a=a-(obj.offsetWidth/2)}}}}}}}}jq(obj).css({top:m,left:a,visibility:"visible"})}function hideAllTT(a){if(navigator.appVersion.indexOf("MSIE 6.")!=-1){jq("select.hideOnTT").css("visibility","visible")}if(a==null){a=true}jq.each(["BL","TL","CL","CR","CB","CT","DL","DR","FL","FSP","DX","DXC","DT","DG","SHR","HP","SLT","SLB"],function(){hideTTType(this)});try{jq("#createShareDiv").r9popover("close")}catch(b){}if(typeof localTTHidden=="function"&&a){localTTHidden()}jq("div.hideableTT").hide()}function hideTTType(a){jq("#ttip"+a).hide()}function simpleurl(b){if(b==null){return b}var d=b.indexOf("http://")==0,a=b.indexOf("/",d?7:0),c=a>0?b.substring(d?7:0,a):b.substring(d?7:0);return c.indexOf("www.")==0?c.substring(4):c}function cleanUrl(a,c){var b=(c===true||c==="true")?"s":"";var d="http"+b;if(a!=""){if(a.indexOf("http")<0){a=d+"://"+a.slice(0,1017)}else{if(a.indexOf(d)==0){}else{if(a.indexOf("http")==0){a=d+a.slice(4,1017)}else{}}}}return a}function replaceArgs(){str=arguments[0];for(var a=1;a<=arguments.length;a++){str=str.replace("{"+(a-1)+"}",arguments[a])}return str}if(typeof String.prototype.localeCompare=="undefined"){String.prototype.localeCompare=function(a){if(this<a){return -1}if(this>a){return 1}return 0}}var R9_DisplayEds_JustHidden=false;function hideDisplayAds(a){R9_DisplayEds_JustHidden=true;if(a==null||a){AjaxReg.regtype="displayad";AjaxReg.ui.register(function(){AjaxAlert.disableDisplayAds()})}else{AjaxAlert.disableDisplayAds()}}function StringBuilder(a){this.strings=[""];this.append(a)}jq.extend(StringBuilder.prototype,{append:function(a){if(a){this.strings.push(a)}return this},clear:function(){this.strings.length=1}});StringBuilder.prototype.toString=function(){return this.strings.join("")};function r9Float(a){return a-0}function hideMeOnPopup(a){jq("div.hideMeOnPopup").css({visibility:a==null||a?"hidden":"visible"})}function hideOnOutsideClick(c,b){var a=b?".":"#";c=a+c;jq("body").click(function(){jq(c).hide().unbind("click");jq("body").unbind("click")});jq(c).click(function(d){d.stopPropagation()})}function setToAnchor(k,d,b,h,l){var j=jq("#"+d).offset(),a=jq("#"+k).outerWidth(),c=jq("#"+d).outerWidth(),f=j.left,g=j.top;if(b=="left"){f=f-a}else{if(b=="right"){f+=c}}if(h!=0){g+=h}if(l!=0){f+=l}jq("#"+k).css({position:"absolute",left:f,top:g,zIndex:50})}function gradientDialogCleanup(){function a(){jq(".dialog_top").hide().show()}a();window.setTimeout(a,2000)}function evalScript(a){if(a.src){jq.ajax({url:a.src,async:false,dataType:"script"})}else{jq.globalEval(a.text||a.textContent||a.innerHTML||"")}if(a.parentNode){a.parentNode.removeChild(a)}}function loadResults(a){showRPSpinner(R9.globals.messages.searchInProgress);jq.cookie("nus","t",{path:"/"});R9.ViewState.getInstance().reset();document.location.href=a}function showRPSpinner(c,b){b=b||1;jq(".RPTopText").html(c);var a=jq(".resbodySpinnerContainer");a.css({display:"block"});a.stop().animate({opacity:b},150)}function hideRPSpinner(){var a=jq(".resbodySpinnerContainer");a.stop().animate({opacity:0},150,function(){a.css({display:"none"})})}function logTiming(g,j,h,b,a){var d=h-j;var f=b-j;var c=a-j;jq.post("/s/sparkle",{searchid:g,action:"ss",rt:d,ht:f,st:c});if(R9){R9.extend("globals",{logTiming:"<b>Performance metrics:</b><br />resp: "+d+"<br />html: "+f+"<br />script: "+c+"<br />"});if(typeof FilterList=="undefined"){displayLogTiming()}}}function displayLogTiming(){if(!R9||!R9.globals||!R9.globals.logTiming){return}jq("#kayak_pm_0001").html(R9.globals.logTiming)}function deepExtend(b,a){if(!b){return a}jq.each(a,function(d,c){b[d]=deepExtend(b[d],c)});return b}function setIframeUrl(b,a){var c=R9.Common.Utils.getId();if(!b.contentWindow){jq(b).html("<iframe id="+c+" onLoad=\"autoResize('"+c+"');\" frameborder='0' scrolling='no' style='text-align:center;margin:0;padding:0;' src='"+a+"'></iframe>")}else{b.contentWindow.location.replace(a)}}function autoResize(d){var b=3;function c(){var h=document.getElementById(d);if(h&&h.contentWindow){var g=jq(h.contentWindow.document.body).height();var f=jq(h.contentWindow.document.body).width()}h=jq(h);if(g&&g>0&&f&&f>0){h.css({height:g+"px",width:f+"px"});h.attr("height",String(g)+"px");h.attr("width",String(f)+"px")}if(b-->0){setTimeout(c,500)}}try{c()}catch(a){}}R9.metacookie=R9.metacookie||{};R9.metacookie.saveQueue=R9.metacookie.saveQueue||[];function saveQueuedMetaCookie(){if(R9.metacookie.saveQueue.length==0){return}var a=R9.metacookie.saveQueue[0];jq.ajax({type:"POST",url:"/k/cookie",data:{action:"setmeta",metacookie:a.name,metavalue:a.value,formtoken:R9.globals.formtoken},complete:function(){R9.metacookie.saveQueue.shift();saveQueuedMetaCookie()},success:function(){a.callback()}})}function setMetaCookie(a,b,c){R9.metacookie.saveQueue.push({name:a,value:b,callback:c||jq.noop});if(R9.metacookie.saveQueue.length==1){saveQueuedMetaCookie()}}function deleteMetaCookie(b,a){if(typeof a=="undefined"||!a){a=jq.noop}jq.ajax({type:"POST",url:"/k/cookie",data:{action:"deletemeta",metacookie:b,formtoken:R9.globals.formtoken},success:a})}function attachEmailDisclaimerTooltip(){jq("#emailSpecialDealsLabel > a").tipTip({delay:0,fadeOut:400})}function initScrollbarSize(){var d=jq("<p></p>")[0];d.style.width="100%";d.style.height="200px";var c=jq("<div></div>")[0];c.style.position="absolute";c.style.top="0px";c.style.left="0px";c.style.visibility="hidden";c.style.width="200px";c.style.height="150px";c.style.overflow="hidden";c.appendChild(d);document.body.appendChild(c);var b=d.offsetWidth;c.style.overflow="scroll";var a=d.offsetWidth;if(b==a){a=c.clientWidth}document.body.removeChild(c);window.scrollbarSize=b-a}function getScrollbarSize(){if(!window.scrollbarSize){initScrollbarSize()}return window.scrollbarSize}function disableSelection(a){if(typeof a.onselectstart!="undefined"){a.onselectstart=function(){return false}}else{if(typeof a.style.MozUserSelect!="undefined"){a.style.MozUserSelect="none"}else{a.onmousedown=function(){return false}}}}function refreshGPTAds(){try{if(typeof cygnus_index_start!=="undefined"){cygnus_index_start()}else{if(typeof amznads!=="undefined"){amznads.getAdsCallback("3131",function(){window.googletag.pubads().clearTargeting("amznslots");amznads.setTargetingForGPTAsync("amznslots");window.googletag.pubads().refresh();window.setTimeout("displayGPTCallback()",500);window.setTimeout("displayGPTCallback()",800);window.setTimeout("displayGPTCallback()",1500);window.setTimeout("displayGPTCallback()",2500)})}else{window.googletag.pubads().refresh();window.setTimeout("displayGPTCallback()",500);window.setTimeout("displayGPTCallback()",800);window.setTimeout("displayGPTCallback()",1500);window.setTimeout("displayGPTCallback()",2500)}}}catch(a){}}jq.ajaxPrefilter("script",function(a){a.cache=true});function updateRoomsAndGuests(a,b,d){for(var c in a){if(a.hasOwnProperty(c)){updateSelectorTitleAndHtml("select[id=guests"+c+"],select[id=guests2"+c+"]",b,d)}}updateSelectorTitleAndHtml("select[name=rooms]",a,d)}function updateSelectorButtonsTitles(f,a,c){var d=jq("#guests"+f+"-status");var b=jq("#rooms-status");if(b.is("span")){b.html(a)}if(d.is("span")){d.html(c)}}function updateSelectorTitleAndHtml(a,c,b){var d;if(b!=undefined){d=jq(a,b)}else{d=jq(a)}if(d.is("select")){d.find("option").each(function(){var f=jq(this).val();var g=f?c[f]:null;if(g){jq(this).attr("title",g).html(g)}})}}function r9scrollIntoView(f,h,a){var g=f.offset(),c=jq(document).scrollTop(),b=c+jq(window).height(),k=g.top,d=false;a=a||{};if(a.center){k-=(b-c)*0.5;d=Math.abs(g.top-k)>4}var j=function(){if(typeof(h)==="function"){h()}h=null};if(g.top<c||g.top>b||d){jq("html, body").animate({scrollTop:k},1000,j)}else{j()}}var emailDealSaveSuccess_clientSuccess=null,emailDealSaveSuccess_clientError=null,R9KayakLoginLogger,AjaxReg=(function(){var y=null;var s;function j(G,H,F){r(H)}function h(){return jq("#ajaxinner button")}function z(){return jq("#ajaxinner input[type='checkbox']")}function a(){b();u();jq("#showAlertRegLink").attr("href","javascript:showAlertSection()");jq("#emailAlertsPopupAfterClick").hide();jq("#hiddenCarsPopupAfterClick").show();AjaxReg.alreadyRegistered=true}function k(){b();u();AjaxReg.alreadyRegistered=false}function n(){jq("#emailValidatorWarnBox").r9popover("destroy").remove();if(jq("#fbLoginPopover").is(":visible")){jq("#fbLoginPopover").r9popover("close")}g()}function D(){location.reload(true)}function m(){jq("#ajaxinner").parents(".r9-dialog-wrapper").remove()}function w(){h().button("disable")}function q(){h().button("enable")}function b(){m();return false}function d(F){jq.ajax({url:F,dataType:"script",async:false,cache:false})}function x(){jq("tr.error").hide();jq("."+R9.Widgets.Tooltip.prototype.widgetBaseClass+"-wrapper").remove();jq("#ajaxloginfields").removeClass("error")}function u(){R9.XDM.remoteShowAjax("/k/headerajax?"+new Date().getTime(),{redir:window.location.href},"html",function(F){jq("#header:not(.gl_header #header)").html(F);R9.ui.initHeader();r9CurrencyPicker.view.addMyAccountMenuHandler()},function(F){location.reload()})}function E(F){F=F||{};if(typeof F==="function"){F={success:F}}return F}function C(F,G,H){R9.XDM.remotePostJSON(F,G,H,j,function(I){AjaxReg.showError('An unknown error has occurred. If it continues, please <a href="/feedback/form">send feedback</a>.');try{if(jq.isPlainObject(window.JSON)){jq.post("/k/run/auth/error",{e:JSON.stringify(I)})}}catch(J){}})}function B(G,H,F,I){R9.XDM.remoteShowAjax(G,H,F,I,j,function(J){AjaxReg.showError('An unknown error has occurred. If it continues, please <a href="/feedback/form">send feedback</a>.');try{if(jq.isPlainObject(window.JSON)){jq.post("/k/run/auth/error",{e:JSON.stringify(J)})}}catch(K){}})}function p(F,G,H){m();B("/k/run/auth/display/"+F,G,"html",H||v)}function l(){if(jq("#promoContainer").hasClass("carousel")){s=setInterval(f,5000)}}function g(){clearInterval(s)}function f(H){var G=jq("#promoContainer");var F=parseInt(G.find(".dot.active").attr("data-index"))+1;if(F>=G.find(".dot").length){F=0}t(F);if(H){g()}}function c(H){var G=jq("#promoContainer");var F=parseInt(G.find(".dot.active").attr("data-index"))-1;if(F<0){F=G.find(".dot").length-1}t(F);if(H){g()}}function t(F,G){jq("#promoContainer .active").removeClass("active");jq("#promoImage_%s, #promoDot_%s".format(F,F)).addClass("active");if(G){g()}}function r(I,G,F,J){var H={content:I,baseClass:"loginError",showImmediately:true,activation:"click",position:F?F:"right",onClose:function(){this._removeAllWidgetBindings();this.element.removeData(this.widgetName)}};if(typeof(G)==="undefined"){H.position="top";H.baseClass="loginErrorNoArrow";G="#credentials"}jq(G,J).tipTip(H);var K=jq(G).data().tooltip;jq("body").one("click",function(){K.close()});q()}function o(){var I=jq(window);var G=I.height();var F=G*0.12;var H=550;var J=Math.floor((G-H)/2);if(J<10){J=10}if(F<J){return"12%"}else{return J+"px"}}function v(G,F,J){var H=jq(G),I="ui-dialog ui-widget ui-widget-content ui-corner-all ";if(J!=undefined){I=I+" "+J.dialogClass}options={spinner:false,close:function(){n();if(typeof F==="function"){F()}},open:function(){jq("body, html").removeClass("zeroScrollbar").removeClass("defaultScrollbar")},viewPortClass:I,hideTitle:true,modalOpacity:0.45,closeButtonClass:" tighter",contentClass:"",width:"270px",minWidth:"270px",top:o()};if(J){jq.extend(options,J)}H.attr("title","").newDialog(options).find("form").submit(w);h().button();z().newCheckbox();if(options.aftershow){options.aftershow(H)}}function A(){x();var F=document.ajaxlogreg;jq(F).find(".highlight").removeClass("highlight");jq(F.username).val(jq.trim(F.username.value));if(!validateEmail(F.username.value)&&F.username.value.indexOf("@runwaynine.com")==-1){r("Please enter a valid email address.","#loginUsername",null,F);if(!R9.ui.isTouchDevice()){jq(F.username).addClass("highlight").focus()}return false}if(F.passwd.value.length==0){r("Please enter a password","#loginPassword",null,F);if(!R9.ui.isTouchDevice()){jq(F.passwd).addClass("highlight").focus()}return false}return true}return{regtype:"default",defaultAirportCode:"",alreadyRegistered:false,confcode:"",usernamedefault:"",searchid:"",utils:{backendCall:function(F,G,H){C(F,G,H)}},showError:function(F){r(F,"#credentials")},changeSlide:function(F,G){t(F,G)},nextSlide:function(F){f(F)},previousSlide:function(F){c(F)},startCarousel:function(){l()},stopCarousel:function(){g()},facebook:{link:function(H,F,G){x();C(AjaxReg.remoteHost+"/k/run/fbauth/link",{accessToken:F||"",userId:G||""},function(I){if(I.status==0){R9.extend("globals",{formtoken:I.formToken});if(H){b();u();AjaxReg.alreadyRegistered=true;H()}else{D()}}else{if(I.status==1){FB.logout();p("linkConflict")}else{if(I.status==-1){r(I.message,"fbConnectButton","left")}}}})},login:function(G,J,I,F,H){x();C(AjaxReg.remoteHost+"/k/run/fbauth/login",{confcode:I||"",confirm:G||0,accessToken:F||"",userId:H||"",sticky:true},function(K){if(K.status==0){R9.extend("globals",{formtoken:K.formToken});if(J){a();J()}else{D()}}else{if(K.status==1){if(K.message=="l"){p("fbLink",null,function(L){L=jq(L);L.find("#ajaxlinkwelcome a").click(function(){b();FB.logout();AjaxReg.regtype="toprightsignin";AjaxReg.ui.login()});v(L,null,{dialogClass:"fbLinkDlg"});jq("#ajaxlinkfields").submit(AjaxReg.facebook.loginAndLink(J,F,H))})}else{if(K.message=="n"){p("fbCannotLink",null,function(L){L=jq(L);L.find("#ajaxcannotlink a").click(function(){b();FB.logout();AjaxReg.regtype="toprightsignin";AjaxReg.ui.login()});v(L,null,{dialogClass:"fbLinkDlg"})})}else{p("fbWelcome",null,function(L){v(L,null,{dialogClass:"fbLinkDlg"});jq("#ajaxfbwelcome a").first().click(function(){jq("#ajaxfbwelcomefields").slideDown();jq("#ajaxfbwelcome a:first").slideUp();return false}).end().last().click(function(){AjaxReg.facebook.login(1,J,I,F,H);return false});jq("#ajaxfbwelcomefields").submit(AjaxReg.facebook.loginAndLink(J,F,H))})}}}else{if(K.status==-1){r(K.message,"[name=passwd]")}}}})},loginAndLink:function(H,F,G){return function(){if(A()){x();var I=jq("#ajaxinner form").serialize()+"&accessToken="+F+"&userId="+G;C("/k/run/fbauth/loginAndLinkExisting",I,function(J){if(J.status==0){if(H){a();H()}else{D()}}else{r(J.message,"[name=passwd]")}})}return false}},unlink:function(F){x();jq.ajax({type:"POST",url:"/k/run/fbauth/unlink",dataType:"json",headers:{"X-CSRF":R9.globals.formtoken},success:function(G){if(G.status==0){R9.extend("globals",{formtoken:G.formToken});if(F){a();AjaxReg.alreadyRegistered=true;F()}else{D()}}else{r(G.message)}},error:j})}},google:{link:function(G,F){x();C(AjaxReg.remoteHost+"/k/run/googleauth/link",{accessToken:F||""},function(H){if(H.status==0){R9.extend("globals",{formtoken:H.formToken});if(G){b();u();AjaxReg.alreadyRegistered=true;G()}else{D()}}else{if(H.status==1){R9.Social.Google.postAuthCallback=function(I){gapi.auth.signOut()};R9.Social.Google.ensureAPILoaded();p("linkConflict")}else{if(H.status==-1){r(H.message,".googleConnectButton")}}}})},login:function(G,I,H,F){x();C(AjaxReg.remoteHost+"/k/run/googleauth/login",{confcode:H||"",confirm:G||0,accessToken:F||"",sticky:true},function(J){if(J.status==0){R9.extend("globals",{formtoken:J.formToken});if(I){a();I()}else{D()}}else{if(J.status==1){if(J.message=="w"){p("googleWelcome",null,function(K){v(K,null,{dialogClass:"googleWelcomeDlg"});jq("#ajaxgooglewelcome a").first().click(function(){jq("#ajaxgooglewelcomefields").slideDown();jq("#ajaxgooglewelcome a:first").slideUp();return false}).end().last().click(function(){AjaxReg.google.login(1,I,H,F);return false});jq("#ajaxgooglewelcomefields").submit(AjaxReg.google.loginAndLink(I,F))})}}else{if(J.status==-1){r(J.message,"#credentials")}}}})},loginAndLink:function(G,F){return function(){if(A()){x();var H=jq("#ajaxinner form").serialize()+"&accessToken="+F;C("/k/run/googleauth/loginAndLinkExisting",H,function(I){if(I.status==0){if(G){a();G()}else{D()}}else{r(I.message)}})}return false}},unlink:function(F){x();jq.ajax({type:"POST",url:"/k/run/googleauth/unlink",headers:{"X-CSRF":R9.globals.formtoken},dataType:"json",success:function(G){if(G.status==0){R9.extend("globals",{formtoken:G.formToken});if(F){a();AjaxReg.alreadyRegistered=true;F()}else{D()}}else{r(G.message)}},error:j})}},ui:{fbLinkWarning:function(G,F){p("linkWarning",null,function(H){v(H,null,{dialogClass:"fbLinkDlg"});h().click(function(){w();return R9.Social.FB.link(G,F)})})},login:function(G){R9.Social.FB.ensureAPILoaded();R9.Social.Google.ensureAPILoaded();G=E(G);if(!R9KayakLoginLogger){R9KayakLoginLogger=R9.Common.Utils.debounce(function(){if(typeof G.promo!=="undefined"){R9.Analytics.api.trackEvent("%s/login/show".format(G.promo),jq.noop)}R9.Analytics.api.trackEvent("fd/topstrip/kayaklogin",{},jq.noop,true)},200);R9KayakLoginLogger()}else{R9KayakLoginLogger()}var J=jq("input[name=username]");var I=J.val()&&J.val()!=J.attr("placeholder")?J.val():null;I=G.loginuname||G.username||I||AjaxReg.usernamedefault;var F=jq("input[name=passwd]").val()||"";var H={dialogClass:"loginDlg",width:G.dialogWidth||"335px"};if(G.aftershow&&typeof G.aftershow==="function"){jq.extend(H,{aftershow:G.aftershow})}if(jq("html").is("._2h7iph0d")){jq.extend(H,{width:"820px",wrapperClass:"promoDialog bigX"})}if(typeof G.promo!=="undefined"){AjaxReg.regtype=G.promo;G.data=jq.extend(G.data,{promo:G.promo})}if(G.redirecturl){G.success=function(){window.location=G.redirecturl}}if(G.preventCloseExceptButton){H.closeOnModalClick=false;H.closeOnEscape=false}if(G.preventClose){H.closeOnModalClick=false;H.closeOnEscape=false;H.closeButtonClass="hidden"}p("login",jq.extend({cc:AjaxReg.confcode,regtype:AjaxReg.regtype,srch:AjaxReg.searchid,un:I},G.data),function(K){v(K,G.error||G.onclose,H);l();jq(".thirdPartyConnectButton.fbConnectButton").click(function(){if(!jq(this).hasClass("disabled")){fbOptions={success:function(M,N){AjaxReg.facebook.login(0,G.success,AjaxReg.confcode,M,N)}};return R9.Social.FB.login(fbOptions)}});jq(".thirdPartyConnectButton.googleConnectButton").click(function(){if(!jq(this).hasClass("disabled")){return R9.Social.Google.login(function(M){AjaxReg.google.login(0,G.success,AjaxReg.confcode,M.access_token)})}});jq("a.signUpLink, .signUpLink a.actionlink").click(function(){if(typeof G.promo!=="undefined"){R9.Analytics.api.trackEvent("%s/signup/show".format(G.promo),jq.noop)}R9.Analytics.api.trackEvent("fd/topstrip/kayaksignup",{},jq.noop,true);x();AjaxReg.ui.register(G);return false});var L=jq("#ajaxloginfields");jq("input[name=passwd]",L).val(F);L.submit(function(){if(typeof G.promo!=="undefined"){R9.Analytics.api.trackEvent("%s/login/login".format(G.promo),jq.noop)}R9.Analytics.api.trackEvent("fd/topstrip/kayaklogin/login",{},jq.noop,true);if(A()){x();C("/k/run/auth/login",jq(this).serialize(),function(M){if(M.status==0){R9.extend("globals",{formtoken:M.formToken});if(G.success){AjaxReg.alreadyRegistered=true;G.success();a()}else{jq("input[name=username]",L).focus();b();D()}}else{r(M.message,"#credentials",null,L)}})}return false});if(!R9.ui.isTouchDevice()){jq("input",L).focus(q)}if(jq("input[name=username]",L).val()&&!R9.ui.isTouchDevice()){jq("input[name=passwd]",L).focus()}else{if(!R9.ui.isTouchDevice()){jq("input[name=username]",L).focus()}}jq("input",L).placeholder()})},register:function(G){R9.Social.FB.ensureAPILoaded();R9.Social.Google.ensureAPILoaded();G=E(G);var J=jq("input[name=username]");var I=J.val()&&J.val()!=J.attr("placeholder")?J.val():null;I=G.reguname||G.username||I||AjaxReg.usernamedefault;var F=jq("input[name=passwd]").val()||"";var H={dialogClass:"loginDlg",width:G.dialogWidth||"640px"};if(jq("html").is("._2h7iph0d")){jq.extend(H,{width:"820px",wrapperClass:"promoDialog bigX"})}if(G.aftershow&&typeof G.aftershow==="function"){jq.extend(H,{aftershow:G.aftershow})}if(G.preventCloseExceptButton){H.closeOnModalClick=false;H.closeOnEscape=false}if(G.preventClose){H.closeOnModalClick=false;H.closeOnEscape=false;H.closeButtonClass="hidden"}if(typeof G.promo!=="undefined"){G.data=jq.extend(G.data,{promo:G.promo});AjaxReg.regtype=G.promo}if(G.redirecturl){G.success=function(){window.location=G.redirecturl}}p("reg",jq.extend({regtype:AjaxReg.regtype,dac:AjaxReg.defaultAirportCode,cc:AjaxReg.confcode,un:I,srch:AjaxReg.searchid},G.data),function(K){v(K,G.error||G.onclose,H);l();if(G.promo=="forcedsignup"||G.promo=="promotedsignupv2"){R9.Analytics.api.trackEvent(G.promo+"/impression",jq.noop)}var L=jq("#ajaxregisterfields");jq(".thirdPartyConnectButton.fbConnectButton",L).click(function(){var M={success:function(O,N){if(G.promo=="forcedsignup"||G.promo=="promotedsignupv2"){R9.Analytics.api.trackEvent(G.promo+"/facebook",jq.noop)}AjaxReg.facebook.login(0,G.success,AjaxReg.confcode,O,N)}};return R9.Social.FB.login(M)});jq(".thirdPartyConnectButton.googleConnectButton",L).click(function(){return R9.Social.Google.login(function(M){if(G.promo=="forcedsignup"||G.promo=="promotedsignupv2"){R9.Analytics.api.trackEvent(G.promo+"/google",jq.noop)}AjaxReg.google.login(0,G.success,AjaxReg.confcode,M.access_token)})});jq("#ajaxoptin").click(function(){R9.Analytics.api.trackEvent("fd/topstrip/lastminutedeals/"+jq(this).is(":checked"),{},jq.noop,true)});jq("input[name=username]",L).textInput().emailValidator();jq("input[name=passwd]",L).textInput().val(F);if(G.confirmed){jq("input[name=confirmed]").val("true")}L.submit(function(){if(typeof G.promo!=="undefined"){R9.Analytics.api.trackEvent("%s/signup/signup".format(G.promo),jq.noop)}if(G.promo=="forcedsignup"||G.promo=="promotedsignupv2"){R9.Analytics.api.trackEvent(G.promo+"/kayak",jq.noop)}R9.Analytics.api.trackEvent("fd/topstrip/kayaksignup/signup",{},jq.noop,true);L.find(".highlight").removeClass("highlight");L.find('input[name="username"').val(jq.trim(this.username.value));if(!validateEmail(this.username.value)){r("Please enter a valid email address.","#regUsername",null,L);if(!R9.ui.isTouchDevice()){jq(this.username).addClass("highlight").focus()}q();return false}if(this.passwd.value.length==0){r("Please enter a password","#regPassword",null,L);if(!R9.ui.isTouchDevice()){jq(this.passwd).addClass("highlight").focus()}q();return false}if(this.airport.value.length==0){r("Please enter a home airport.","#regAirport",null,L);if(!R9.ui.isTouchDevice()){jq(this.airport).addClass("highlight").focus()}q();return false}if(this.consent&&!this.consent.checked){r("Please confirm that you have read and accept KAYAK Terms & Conditions",null,null,L);jq(this.consent).parent().addClass("highlight");if(!R9.ui.isTouchDevice()){this.consent.focus()}q();return false}x();C("/k/run/auth/register",jq(this).serialize(),function(M){if(M.status==0){R9.extend("globals",{formtoken:M.formToken});if(G.success){AjaxReg.alreadyRegistered=true;G.success();a()}else{D()}}else{jq("#regUsername, #regPassword, #regAirport").addClass("highlight");r(M.message)}});if(!R9.ui.isTouchDevice()){jq("input[name=username]",L).focus()}return false});jq("input[name=airport]",L).r9AirportsSmarty({clearItem:function(M){jq("input[name=airportcode]",L).val("")},dropdownClass:"registrationAirportSmarty",setItem:function(O,M,N){setTimeout(function(){jq("input[name=airportcode]",L).val(M.id);O.elementNode.value=M.str},1)},minWidth:175});jq("#ajaxinner").on("click","a.loginLink, .loginLink a.actionlink",function(){x();if(G.promo=="forcedsignup"||G.promo=="promotedsignupv2"){R9.Analytics.api.trackEvent(G.promo+"/login",jq.noop)}AjaxReg.ui.login(G);return false});if(jq("input[name=username]",L).val()&&!R9.ui.isTouchDevice()){jq("input[name=passwd]",L).focus()}else{if(!R9.ui.isTouchDevice()){jq("input[name=username]",L).focus()}}if(G.promo=="forcedsignup"||G.promo=="promotedsignupv2"){jq(".r9-dialog-closeButton.r9-icon-x").on("click",function(){R9.Analytics.api.trackEvent(G.promo+"/exit-button",jq.noop)});jq(".r9-no-thanks").on("click",function(){R9.Analytics.api.trackEvent(G.promo+"/exit-no-thanks",jq.noop);m()})}if(G.promo=="priceAlert"){jq(".r9-dialog-closeButton.r9-icon-x").on("click",function(){R9.Analytics.api.trackEvent("signup/pricealert/exitbutton",jq.noop)});jq(".promoDialog .r9-dialog-modalBackground").on("click",function(){R9.Analytics.api.trackEvent("signup/pricealert/closedialog",jq.noop)})}jq("input",L).placeholder()})},logout:function(F){x();jq.ajax({type:"POST",url:"/k/run/fbauth/logout",dataType:"json",success:function(G){if(G.status==0){R9.extend("globals",{formtoken:G.formToken});k();if(F){F()}else{D()}}else{r(G.message)}},error:j})},bindInlineRegistrationForm:function(H,G){R9.Social.FB.ensureAPILoaded();R9.Social.Google.ensureAPILoaded();jq("#sw_reg_form button").button();jq("#sw_reg_form input[type='checkbox']").newCheckbox();jq(".thirdPartyConnectButton.fbConnectButton",H).click(function(){var I={success:function(K,J){AjaxReg.facebook.login(0,G.success,AjaxReg.confcode,K,J)}};return R9.Social.FB.login(I)});jq(".thirdPartyConnectButton.googleConnectButton",H).click(function(){return R9.Social.Google.login(function(I){AjaxReg.google.login(0,G.success,AjaxReg.confcode,I.access_token)})});jq("input[name=username]",H).textInput().emailValidator();var F=jq("input[name=passwd]").val()||"";jq("input[name=passwd]",H).textInput().val(F);H.submit(function(){H.find(".highlight").removeClass("highlight");H.find('input[name="username"').val(jq.trim(this.username.value));if(!validateEmail(this.username.value)){r("Please enter a valid email address.","#regUsername",null,H);if(!R9.ui.isTouchDevice()){jq(this.username).addClass("highlight").focus()}q();return false}if(this.passwd.value.length==0){r("Please enter a password","#regPassword",null,H);if(!R9.ui.isTouchDevice()){jq(this.passwd).addClass("highlight").focus()}q();return false}if(this.airport.value.length==0){r("Please enter a home airport.","#regAirport",null,H);if(!R9.ui.isTouchDevice()){jq(this.airport).addClass("highlight").focus()}q();return false}if(this.consent&&!this.consent.checked){r("Please confirm that you have read and accept KAYAK Terms & Conditions",null,null,H);jq(this.consent).parent().addClass("highlight");if(!R9.ui.isTouchDevice()){this.consent.focus()}q();return false}x();C("/k/run/auth/register",jq(this).serialize(),function(I){if(I.status==0){R9.extend("globals",{formtoken:I.formToken});if(G.success){AjaxReg.alreadyRegistered=true;G.success();a()}else{D()}}else{jq("#regUsername, #regPassword, #regAirport").addClass("highlight");r(I.message)}});if(!R9.ui.isTouchDevice()){jq("input[name=username]",H).focus()}return false});jq("input[name=airport]",H).r9AirportsSmarty({clearItem:function(I){jq("input[name=airportcode]",H).val("")},dropdownClass:"registrationAirportSmarty",setItem:function(K,I,J){setTimeout(function(){jq("input[name=airportcode]",H).val(I.id);K.elementNode.value=I.str},1)},minWidth:175});jq("#ajaxinner").on("click","a.loginLink, .loginLink a.actionlink",function(){x();AjaxReg.ui.login(G);return false});jq("input",H).placeholder()}}}})(),AjaxAlert={_ajaxError:function(b,c,a){alert(c)},_doPost:function(a,b,c){jq("tr.error").hide();jq.ajax({type:"POST",headers:{"X-CSRF":R9.globals.formtoken},url:a,data:b,success:c,dataType:"script",error:this._ajaxError})},_getDriveByData:function(){return jq("#ajaxalert").serialize()},showEmailAlertError:function(a){jq("#ajaxalerterror").show();jq("#ajaxalerterror").html(a)},showDuplicateEmailAlertError:function(a,b){if(typeof showPriceAlertSaved=="function"){showPriceAlertSaved(a,b)}},emailAlertSaveSuccess:function(a){if(typeof showPriceAlertSaved=="function"){showPriceAlertSaved(a)}},saveEmailAlert:function(){this._doPost("/k/alertajax","action=save&"+jq("#ajaxalert").serialize())},saveHotelAlert:function(){this._doPost("/alerts/hrp/save",jq("#hotelalert").serialize())},hotelAlertSaveSuccess:function(a){if(typeof showAlertSaved=="function"){showAlertSaved(a)}},showHotelAlertError:function(a){if(typeof showAlertError=="function"){showAlertError(a)}},showDriveByAlertDialog:function(a,b){if(!b){b="driveby"}jq.ajax({type:"POST",url:"/s/toolbox",data:{action:"driveby",searchid:a,alertsrc:b},dataType:"html",success:function(c){var d="ui-dialog ui-widget ui-widget-content ui-corner-all driveByDialog"+(R9.config.getBoolean("ui.newdriveby",false)?" newdriveByDialog":"");jq(c).newDialog({spinner:false,close:function(){toggleFaderPane(false)},open:function(){jq("body, html").removeClass("zeroScrollbar").removeClass("defaultScrollbar")},width:371,isFixed:true,modalOpacity:0.45,viewPortClass:d})},error:this._ajaxError,cache:false})},saveAlertAjaxReg:function(d,a,b){var g=this._getDriveByData();if(AjaxReg.alreadyRegistered){AjaxAlert.saveDriveByEmailAlert(g)}else{var c=jq("#ajaxalert"),f=c.find("input:hidden[name=alertsrc]").val();AjaxReg.regtype=f;AjaxReg.searchid=d;if(a){AjaxReg.usernamedefault=a}AjaxReg.ui[b?"login":"register"]({success:function(){AjaxAlert.saveDriveByEmailAlert(g)},data:{alertsrc:f,hid:c.find("input:hidden[name=hid]").val()}})}},saveDriveByEmailAlert:function(a){this._doPost("/k/alertajax","action=save&"+(a||jq("#ajaxalert").serialize()))},saveChangeHomeAirportError:function(a){jq("tr.successrow").hide();jq("#ajaxairporterror").html(a);jq("#dealerrorrow").show();jq("tr.buttonrow").show();jq("tr.inputrow").show()},saveChangeHomeAirportSuccess:function(){saveChangeHomeAirport_clientSuccess()},saveChangeHomeAirport:function(){this._doPost("/k/savehomeairportajax","action=save&"+jq("#ajaxchangehome").serialize())},disableDisplayAds:function(){jq.ajax({type:"GET",url:"/s/sparkle",data:"action=hidedisplayads&formtoken="+R9.globals.formtoken+"&"+jq("#ajaxalert").serialize(),dataType:"text",success:function(){jq("#displayAd1, #displayAd2, #displayAd3, #displayAd4, .hidedisplayad").hide("slow",function(){if(window.R9&&R9.RP&&R9.RP.FloatingAd){R9.RP.FloatingAd.refresh()}})},error:this._ajaxError,cache:false})}};if(jq("html._habkdn13").length>0){AjaxAlert.dontRemoveDriveByAlert=false;AjaxAlert.loadCompleted=false;AjaxAlert.onDriveByAlertCreation=function(b){jq("body, html").removeClass("zeroScrollbar").removeClass("defaultScrollbar");var c=b.element.find("#featuresandsignupdialogform"),a=c.find("#useraddress");b.element.parent().click(function(){AjaxAlert.dontRemoveDriveByAlert=true});c.submit(function(d){d.preventDefault();var f=a.val(),g=c.find("#r9username").val();AjaxAlert.saveAlertAjaxReg(searchid,f,f==g);b.close()});AjaxAlert.onProgressBarIsSet=function(){var d=b.element.find(".separator .orange");R9PBar.addCallback(function(f){d.width((AjaxAlert.loadCompleted?"100":f)+"%")})};if(R9PBar){AjaxAlert.onProgressBarIsSet()}};AjaxAlert.showDriveByAlertDialog=function(a){jq.ajax({type:"POST",url:"/s/toolbox",data:{action:"driveby",searchid:a,alertsrc:"driveby"},dataType:"html",success:function(b){var c="ui-dialog ui-widget ui-widget-content ui-corner-all driveByDialog"+(R9.config.getBoolean("ui.newdriveby",false)?" newdriveByDialog":"");jq(b).newDialog({spinner:false,closeButtonClass:"r9-dialog-closeNoBorder",width:350,opened:function(){AjaxAlert.onDriveByAlertCreation(this)},isFixed:true,modalOpacity:0.45,viewPortClass:c,top:"25%",minHeight:"100px"})},error:this._ajaxError,cache:false})};AjaxAlert.saveDriveByEmailAlert=function(a){this._doPost("/k/alertajax","action=save&"+(a||jq("#ajaxalert").serialize()))};AjaxAlert.closeDriveByEmailAlertIfNoInteraction=function(){if(!this.dontRemoveDriveByAlert){var a=jq("#featuresandsignupdialog").data("dialog");a&&a.close()}AjaxAlert.loadCompleted=true}}function showAlertRegRedirect(c){function b(){window.location="/alerts"}if(R9.globals.isLoggedIn){b();return}var a={onclose:function(){null},success:function(){R9.globals.isLoggedIn=true;b()}};if(R9.config.getBoolean("ui.sheep.campaign.pricealert.enabled",false)&&c){a.promo=c}AjaxReg.regtype="alert";AjaxReg.ui.register(a)}jq(function(){if(R9.globals.showForcedSignup){setMetaCookie("forced-signup-shown","true",function(){if(R9.config.getBoolean("ui.forcedsignup.enabled",false)){AjaxReg.ui.register({promo:"promotedsignupv2",preventCloseExceptButton:true})}else{AjaxReg.ui.register({promo:"forcedsignup",preventCloseExceptButton:true})}})}});function formatDate(g){if(g.length<6){return false}if(g.length>10){return false}if(g.indexOf("/")>=0){var f=g.split("/");if(f.length!=3){return false}if(f[0].length==0||f[1].length==0||f[2].length==0){return false}var a=parseInt(f[1],10);var d=parseInt(f[0],10);var c=parseInt(f[2],10)}else{if(g.indexOf("-")>=0){var f=g.split("-");if(f.length!=3){return false}if(f[0].length==0||f[1].length==0||f[2].length==0){return false}var a=parseInt(f[2],10);var d=parseInt(f[1],10);var c=parseInt(f[0],10)}else{if(g.indexOf(".")>=0){var f=g.split(".");if(f.length!=3){return false}if(f[0].length==0||f[1].length==0||f[2].length==0){return false}var a=parseInt(f[0],10);var d=parseInt(f[1],10);var c=parseInt(f[2],10)}else{return false}}}if(c<100){if(c<30){c+=2000}else{c+=1900}}if(!isValidDate(c,d,a)){return false}var b="";if(d<10){b+="0"}b+=d+"/";if(a<10){b+="0"}b+=a+"/";b+=c;return b}function isValidDate(c,d,a){if(c>=1970){var b=new Date(c,d-1,a);if(a!=b.getDate()){return false}if(d!=(b.getMonth()+1)){return false}if(c!=b.getFullYear()){return false}}else{if((a<1)||(a>31)){return false}if((d<1)||(d>12)){return false}if((c<1000)||(c>3000)){return false}}if(a>28){if(getNumberOfDays(c,d)<a){return false}}return true}function getNumberOfDays(a,b){switch(b){case 2:if(isLeapYear(a)){return 29}return 28;break;case 1:case 3:case 5:case 7:case 8:case 10:case 12:return 31;break;default:return 30}}function isLeapYear(a){return(((a%4==0)&&(a%100!=0))||(a%400==0))}function validDate(b){if(b.value.length==0){return true}if(!formatDate(b.value)){alert("Please enter a valid date. (MM/DD/YYYY format)");b.focus();b.select();return false}var a=formatDate(b.value);if(isNaN(Date.parse(a))){alert("Please enter a valid date. (MM/DD/YYYY format)");b.focus();b.select();return false}b.value=a;return true}function parseDate(d){var g=d.split("/");var f=parseInt(zeroUnpad(g[0]));var a=parseInt(zeroUnpad(g[1]));var c=parseInt(zeroUnpad(g[2]));var b=new Date(c,f-1,a);return b}function zeroPad(a){if(a.length==1){return"0"+a}return a}function zeroUnpad(a){a=""+a;if(a.match(/^0/)){return a.substring(1)}return a}function addDays(c,f){c.setDate(c.getDate()+f);var d=c.getMonth()+1;var a=c.getDate();var b=c.getYear();if(b<1900){b+=1900}return zeroPad(d)+"/"+zeroPad(a)+"/"+b}function countDays(c,a){c.setUTCMilliseconds(0);c.setUTCSeconds(0);c.setUTCMinutes(0);c.setUTCHours(12);a.setUTCMilliseconds(0);a.setUTCSeconds(0);a.setUTCMinutes(0);a.setUTCHours(13);var b=a.getTime()-c.getTime();return Math.floor(b/(1000*60*60*24))}function existsInArray(c,a){for(var b=0;b<c.length;b++){if(c[b]==a){return true}}return false}Date.prototype.formatDate=function(input,time){var switches=["a","A","B","d","D","F","g","G","h","H","i","j","l","L","m","M","n","O","r","s","t","T","U","w","y","Y","z"];var daysLong=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var daysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];var monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var monthsLong=["January","February","March","April","May","June","July","August","September","October","November","December"];function a(){return self.getHours()>11?"pm":"am"}function A(){return self.getHours()>11?"PM":"AM"}function B(){var off=(self.getTimezoneOffset()+60)*60;var theSeconds=(self.getHours()*3600)+(self.getMinutes()*60)+self.getSeconds()+off;var beat=Math.floor(theSeconds/86.4);if(beat>1000){beat-=1000}if(beat<0){beat+=1000}if((""+beat).length==1){beat="00"+beat}if((""+beat).length==2){beat="0"+beat}return beat}function d(){return new String(self.getDate()).length==1?"0"+self.getDate():self.getDate()}function D(){return daysShort[self.getDay()]}function F(){return monthsLong[self.getMonth()]}function g(){return self.getHours()>12?self.getHours()-12:self.getHours()}function G(){return self.getHours()}function h(){if(self.getHours()>12){var s=new String(self.getHours()-12);return s.length==1?"0"+(self.getHours()-12):self.getHours()-12}else{var s=new String(self.getHours());return s.length==1?"0"+self.getHours():self.getHours()}}function H(){return new String(self.getHours()).length==1?"0"+self.getHours():self.getHours()}function i(){return new String(self.getMinutes()).length==1?"0"+self.getMinutes():self.getMinutes()}function j(){return self.getDate()}function l(){return daysLong[self.getDay()]}function L(){var y_=Y();if((y_%4==0&&y_%100!=0)||(y_%4==0&&y_%100==0&&y_%400==0)){return 1}else{return 0}}function m(){return self.getMonth()<9?"0"+(self.getMonth()+1):self.getMonth()+1}function M(){return monthsShort[self.getMonth()]}function n(){return self.getMonth()+1}function O(){var os=Math.abs(self.getTimezoneOffset());var h=""+Math.floor(os/60);var m=""+(os%60);h.length==1?h="0"+h:1;m.length==1?m="0"+m:1;return self.getTimezoneOffset()<0?"+"+h+m:"-"+h+m}function r(){var r;r=D()+", "+j()+" "+M()+" "+Y()+" "+H()+":"+i()+":"+s()+" "+O();return r}function s(){return new String(self.getSeconds()).length==1?"0"+self.getSeconds():self.getSeconds()}function t(){var daysinmonths=[null,31,28,31,30,31,30,31,31,30,31,30,31];if(L()==1&&n()==2){return 29}return daysinmonths[n()]}function T(){return G()+":"+i()}function U(){return Math.round(self.getTime()/1000)}function W(){var beforeNY=364+L()-z();var afterNY=z();var weekday=w()!=0?w()-1:6;if(beforeNY<=2&&weekday<=2-beforeNY){return 1}var ny=new Date("January 1 "+Y()+" 00:00:00");var nyDay=ny.getDay()!=0?ny.getDay()-1:6;if((afterNY<=2)&&(nyDay>=4)&&(afterNY>=(6-nyDay))){var prevNY=new Date("December 31 "+(Y()-1)+" 00:00:00");return prevNY.formatDate("W")}if(nyDay<=3){return 1+Math.floor((z()+nyDay)/7)}else{return 1+Math.floor((z()-(7-nyDay))/7)}}function w(){return self.getDay()}function Y(){if(self.getFullYear){var newDate=new Date("January 1 2001 00:00:00 +0000");var x=newDate.getFullYear();if(x==2001){return self.getFullYear()}}var x=self.getYear();var y=x%100;y+=(y<38)?2000:1900;return y}function y(){var y=Y()+"";return y.substring(y.length-2,y.length)}function z(){var t=new Date("January 1 "+Y()+" 00:00:00");var diff=self.getTime()-t.getTime();return Math.floor(diff/1000/60/60/24)}var self=this;if(time){var prevTime=self.getTime();self.setTime(time)}var ia=input.split("");var ij=0;while(ia[ij]){if(ia[ij]=="\\"){ia.splice(ij,1)}else{if(existsInArray(switches,ia[ij])){ia[ij]=eval(ia[ij]+"()")}}ij++}if(prevTime){self.setTime(prevTime)}return ia.join("")};Date.prototype.formatUTCDate=function(input,time){var switches=["a","A","B","d","D","F","g","G","h","H","i","j","l","L","m","M","n","O","r","s","t","T","U","w","y","Y","z"];var daysLong=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var daysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];var monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var monthsLong=["January","February","March","April","May","June","July","August","September","October","November","December"];function a(){return self.getUTCHours()>11?"pm":"am"}function A(){return self.getUTCHours()>11?"PM":"AM"}function B(){var off=(self.getTimezoneOffset()+60)*60;var theSeconds=(self.getHours()*3600)+(self.getMinutes()*60)+self.getSeconds()+off;var beat=Math.floor(theSeconds/86.4);if(beat>1000){beat-=1000}if(beat<0){beat+=1000}if((""+beat).length==1){beat="00"+beat}if((""+beat).length==2){beat="0"+beat}return beat}function d(){return new String(self.getDate()).length==1?"0"+self.getDate():self.getUTCDate()}function D(){return daysShort[self.getUTCDay()]}function F(){return monthsLong[self.getUTCMonth()]}function g(){return self.getUTCHours()>12?self.getUTCHours()-12:self.getUTCHours()}function G(){return self.getUTCHours()}function h(){if(self.getUTCHours()>12){var s=new String(self.getUTCHours()-12);return s.length==1?"0"+(self.getUTCHours()-12):self.getUTCHours()-12}else{var s=new String(self.getUTCHours());return s.length==1?"0"+self.getUTCHours():self.getUTCHours()}}function H(){return new String(self.getUTCHours()).length==1?"0"+self.getUTCHours():self.getUTCHours()}function i(){return new String(self.getUTCMinutes()).length==1?"0"+self.getUTCMinutes():self.getUTCMinutes()}function j(){return self.getUTCDate()}function l(){return daysLong[self.getUTCDay()]}function L(){var y_=Y();if((y_%4==0&&y_%100!=0)||(y_%4==0&&y_%100==0&&y_%400==0)){return 1}else{return 0}}function m(){return self.getUTCMonth()<9?"0"+(self.getUTCMonth()+1):self.getUTCMonth()+1}function M(){return monthsShort[self.getUTCMonth()]}function n(){return self.getUTCMonth()+1}function O(){var os=Math.abs(self.getTimezoneOffset());var h=""+Math.floor(os/60);var m=""+(os%60);h.length==1?h="0"+h:1;m.length==1?m="0"+m:1;return self.getTimezoneOffset()<0?"+"+h+m:"-"+h+m}function r(){var r;r=D()+", "+j()+" "+M()+" "+Y()+" "+H()+":"+i()+":"+s()+" "+O();return r}function s(){return new String(self.getUTCSeconds()).length==1?"0"+self.getUTCSeconds():self.getUTCSeconds()}function t(){var daysinmonths=[null,31,28,31,30,31,30,31,31,30,31,30,31];if(L()==1&&n()==2){return 29}return daysinmonths[n()]}function T(){return G()+":"+i()}function U(){return Math.round(self.getTime()/1000)}function w(){return self.getUTCDay()}function Y(){if(self.getUTCFullYear){var newDate=new Date("January 1 2001 00:00:00 +0000");var x=newDate.getUTCFullYear();if(x==2001){return self.getUTCFullYear()}}var x=self.getUTCYear();var y=x%100;y+=(y<38)?2000:1900;return y}function y(){var y=Y()+"";return y.substring(y.length-2,y.length)}function z(){var t=new Date("January 1 "+Y()+" 00:00:00");var diff=self.getTime()-t.getTime();return Math.floor(diff/1000/60/60/24)}var self=this;if(time){var prevTime=self.getTime();self.setTime(time)}var ia=input.split("");var ij=0;while(ia[ij]){if(ia[ij]=="\\"){ia.splice(ij,1)}else{if(existsInArray(switches,ia[ij])){ia[ij]=eval(ia[ij]+"()")}}ij++}if(prevTime){self.setTime(prevTime)}return ia.join("")};function getShortTime(d,c){if(c==null||isFlexDate){c=false}var a=d.getUTCHours();var b=d.getUTCMinutes();if(b<10){b="0"+b}if(c){return d.formatUTCDate("D T")}else{return d.formatUTCDate("T")}}function getShortDate(a){return a.formatUTCDate("j M")}function getShortTime(f,d){if(d==null||isFlexDate){d=false}var a=f.getUTCHours();if(a>=13){a=a-12}else{if(a==0){a=12}}var c=f.getUTCMinutes();if(c<10){c="0"+c}var b=(f.getUTCHours()>=12)?"p":"a";if(d){return dow[f.getUTCDay()]+" "+a+":"+c+b}else{return a+":"+c+b}}function getShortDate(a){return a.formatUTCDate("M j")}(function(){var d=27,l=9,a=18,n=38,k=40,c=37,h=39,f=13,m=16,g="smartboxOptions",b,j={air:1,car:2,hotel:29,freeregions:29,any:4,crc:5,crcg:6,deal:7,crcga:8,hotelname:11,brandname:15};function o(){if(b){try{b.abort()}catch(p){}}}jq.fn.smartbox=function(t,r,q){if(t&&!jq.isPlainObject(t)){if(t==="option"){this.data(g)[r]=q}return this}t=jq.extend({},jq.fn.smartbox.defaults,t);var w,u;function p(){return jq(w).find("ul li")}function x(v){var y=p();retIndex=y.index(v);return retIndex==-1?0:retIndex}function s(){w.style.display=u.style.display="none"}this.each(function(){var I=jq(this),F=0,K,C,O,P,z=0,H=false,y=false;function B(){if(w){w.style.display="none"}if(u){u.style.display="none"}H=true;I.trigger("sbclose")}function G(){return I.data(g)}function D(){C=x(this);A(C);B()}function E(){C=-1;M(-1)}function N(){C=x(this);M(C)}function M(R){var S=G().itemHighlightClass;var T=p();T.removeClass(S);if(R>=0){jq(T[R]).addClass(S);C=R}}function A(T){var W=G();if(T<0){K="";I.data(W.dataKey,"");if(W.callbackWithNull){W.callback.call(I[0],null)}}else{var V=p();if(V.length>0){var U=V[T],S=U.id.split("-"),X="";if(S.length>1){X=S[1]}if(jq(U).find("span.nearbyHotels").length>0){jq(U).find("span.nearbyHotels").remove()}I.data(W.dataKey,X).val(jq(U).text());var R=jq.extend({id:X,str:U.innerHTML,type:S[0]},jq(U).data());if(R.type=="isl"&&S.length>1){codes=S[1].split("/");R.str=codes[0]}if(S.length>2){R.hc=S[2]}if(S.length>3){if(R.type==="hotel"){R.hid=S[3]}else{if(R.type==="rest"){R.rtid=S[3]}else{if(R.type==="freereg"){R.frid=S[3]}else{if(R.type==="reg"){R.rid=S[3]}else{if(R.type==="ctry"){R.cid=S[3]}else{R.lmid=S[3]}}}}}}W.callback.call(I[0],R)}}I.trigger("sbset",[T])}function L(){var W=G(),T=w.style,V=u.style;T.display="inline";if(!window.opera){V.display="inline"}var U=Math.min(W.maxWidth,Math.max(W.minWidth,w.offsetWidth));T.width=V.width=U+"px";var S=I.offset(),R=S.left;if(W.position==="right"){R+=I.width()-U-2}T.left=R+"px";T.top=(S.top+I.outerHeight())+"px";V.height=w.offsetHeight+"px";V.top=T.top;V.left=T.left}function Q(){var U=G(),T=I.val().toUpperCase(),R="";if(U.recentList!=null&&U.recentList.length>0){for(var S=0;S<U.recentList.length;S++){if(U.keyPressed&&T.length>0&&U.recentList[S].display.toUpperCase().indexOf(T)<0){continue}if(R.length==0){R="<li class='separator'><b>Recently searched:</b></li>"}R+="<li id='"+U.recentList[S].code+"' class='"+U.recentList[S].className+"'>"+U.recentList[S].display+"</li>"}}if(jq.trim(R).length==0){return null}return R}function v(){I.trigger("sbopen");var T=G(),S=I.val();if(K.length>0&&K==S){return}if(S.length<T.minChars){J(null);return}K=S;var R=jq.extend({f:"h",lc:T.localeLanguage,lc_cc:T.localeCountry,s:j[T.searchType]||T.searchType,where:K},T.getSmartData!=null?T.getSmartData():T.smartData);if(T.countryCode){R.cc=T.countryCode}b=jq.post(T.smartUrl,R,J,"text")}function J(U){var V=G();var S=Q();if(S==null&&U==null){return}var R=(U==null)?1:0;U=(U||"<ul>");if(S!=null&&U.length>0&&U.indexOf("</ul>")>0){U=U.substr(0,U.indexOf("</ul>"))}U+=(S||"")+"</ul>";if(typeof V.addCustomDataStyle=="function"){U=V.addCustomDataStyle(U)}U+=V.customHTML;w.innerHTML=U;if(V.maxResults){jq(w).find("ul li").slice(V.maxResults).remove()}var T=p();P=T.length;if(P>0){T.mousedown(D).mouseout(E).mouseover(N);w.style.width="auto";L()}else{s()}C=(V.forceSelection||(V.forceSingle&&P==1)?R:-1);O=C;M(C)}jq(this).attr({autocomplete:"off",autocapitalize:"off",autocorrect:"off"}).blur(function(){var R=G();if(!I.data(R.dataKey)){if(((C>=0&&R.forceSelection&&!R.noForceOnBlur)||(R.forceSingle&&P==1)||(C<=0&&R.forceFirstSelection&&!R.noForceOnBlur))){A(0)}else{if(R.promptText){I.css("color",R.promptColor).val(R.promptText);y=true}}}o();B();H=false}).data(g,t).click(function(){var R=G();if(R.recentList!=null&&R.recentList.length>0){o();v()}}).focus(function(){var U=G();U.keyPressed=false;if(y){I.css("color","").val("");y=false}var S=U.targetId;w=document.getElementById(S)||jq("<div/>",{id:S,css:{display:"none",position:"absolute",width:"auto",zIndex:5001}}).appendTo("body")[0];w.className=U.targetClass||"smartbox";w.className+=" "+w.className+"-"+U.searchType;var T=U.targetBGId;u=document.getElementById(T)||jq("<iframe/>",{id:T,css:{display:"none",position:"absolute",zIndex:5000},frameborder:0,scrolling:"no"}).appendTo("body")[0];K="";C=O=-1;H=false;if(I.size()&&I.val().length>0&&U.searchOnFocus){v()}else{if(U.getInitData){var R=U.getInitData.call();if(R){J(R)}}}}).keydown(function(S){var T=G();var R=document.all?S.keyCode:S.which;F=R;z=new Date().getTime();T.keyPressed=true;switch(R){case c:case n:C=Math.max(C-1,0);M(C);break;case h:case k:C=Math.min(C+1,P-1);M(C);break;case f:if(P>0){A(C);B()}break;case d:B();break;case l:if(C>=0&&C<P){A(C)}break;case a:case m:break;default:C=-1;A(-1);setTimeout(function(){if(F==f){return}if(I.size()&&I.val().length>0){o();v()}else{A(-1);B()}},1);break}}).keypress(function(){var R=!H;H=false;return R?true:F!=f})});return this};jq.fn.smartbox.defaults={callback:jq.noop,callbackWithNull:false,countryCode:null,dataKey:"smartbox",forceSelection:true,forceFirstSelection:false,forceSingle:false,itemHighlightClass:"smartbox-hover",localeCountry:"US",localeLanguage:"en",maxResults:null,maxWidth:1000,minChars:1,minWidth:50,position:"left",promptColor:"#666",promptText:null,recentList:null,searchType:"air",smartData:{},smartUrl:"/m/smarty",targetClass:null,targetId:"smartbox",targetBGId:"smartboxBG",customHTML:""}})();R9=R9||{};R9.extend("globals.messages",{searchInProgress:"Searching...",filterInProgress:"Applying your filter choices...",sortInProgress:"Sorting results...",updatingInProgress:"Updating results..."});R9.ui=(function(){var a=false,b=null,c=false;function f(){jq("#more_login").off("click.moreLogin").on("click.moreLogin",function(){jq("#headersigninlink").trigger("click")})}function d(){var h=jq("#moreHeaderLink"),j=h.find(".more-tooltip"),k=jq("#logo"),g="show-tooltip";jq("#proflinksmenu").on("click",function(){h.removeClass(g);jq("body").off("click.hideMoreMenu")});f();if(k.length>0){h.removeClass(g);jq.fn.lowerCaseAndCapitalize=function(){var l=this.text();this.text(l.charAt(0).toUpperCase()+l.slice(1).toLowerCase());return this};h.off("click").on("click",function(l){l.stopPropagation();window.r9CurrencyPicker.view.hidePickers(true);h.toggleClass(g);function n(){if(h.hasClass(g)){window.r9CurrencyPicker.view.shown=true}setTimeout(function(){if(h.hasClass(g)){jq("body").one("click.hideMoreMenu",function(){h.removeClass(g)});j.one("click",function(o){o.stopPropagation()})}},1)}if(R9.globals.loadMoreMenuAjax&&h.hasClass(g)){var m=this.innerHTML.trim?this.innerHTML.trim():this.innerHTML.replace(/^\s+/,"");if(m===""){jq.ajax({type:"GET",url:"/k/headerajax",data:{moremenuonly:true},dataType:"html",cache:false,success:function(o){h.html(o);f();n()}})}else{h.addClass(g);n()}}else{n()}})}}return{initHeader:function(){if(jq.support.touch||typeof(window.ontouchstart)!="undefined"){jq("html").addClass("touch");c=true;jq.ui.r9dialog.prototype.options.draggable=false;jq.datepicker._defaults.showButtonPanel=true}else{jq("html").addClass("no-touch")}if(R9.Tabs&&R9.Tabs.SearchTabs){R9.Tabs.SearchTabs.bindEvents()}d()},isTouchDevice:function(){return c},initMapsAPI:function(g){b=g;R9.Maps.Google.load(b,"initMapsAPI")},initMapsAPIComplete:function(g){a=true;b(g)},isMapsAPIInitialized:function(){return a},doAfterMapsAPIInitialized:function(g){if(!a){this.initMapsAPI(g)}else{g()}}}})();jq(R9.ui.initHeader);var bound=false;function hoverDisclaimer(b,c,a,f){if(jq("#ttipDXC").is(":visible")){return}if(!bound){jq("a.disclaim, span.disclaim, span.closeareadis").click(function(g){g.stopPropagation()});bound=true}var d=new Object();if(a==null){a=20}if(f==null){f=-20}d.x=a;d.y=f;if(c){hideTTType("DX");hideTTType("DT");hideTTType("DG");showTT(b,"","DXC",d,true)}else{showTT(b,"","DX",d,true)}}function hideDisclaimerClicked(a){if(a==null){a=true}if(a){hideAllTT(false)}else{hideTTType("DXC")}}function hideDisclaimer(a){if(jq("#ttipDXC").is(":visible")){return}if(a==null){a=true}if(a){hideAllTT(false)}else{hideTTType("DX");hideTTType("DT");hideTTType("DG")}}function generateFlightsUrl(c,l,d,a,k,j){var b="";if(l!=null&&j!="weekend"){b=generateLegParams(c,-1,l,j);if("openflex"==j){d=new Date(l.getTime());d.setDate(d.getDate()+30)}if(d!=null){var m=dateToString(d);b=b+"/"+m;if(c.return_time){b+=getTimeOption(c.return_time.value)}if(j!="openflex"){b+=getFlexOption(c.return_date_flex&&c.return_date_flex.value)}else{var h=c.lengthofstay.value.replace("-","to").replace(/ /g,"");b+="-flexible-calendar-"+h}}if(c.prefer_nonstop!=undefined&&(c.prefer_nonstop.checked||c.prefer_nonstop.value=="Y")){b+="/nonstop"}}else{if(a){for(var g=0;g<k;g++){if(c["origin"+g]==null||c["origin"+g].value==""){break}if(g>0){b+="/"}b+=generateLegParams(c,g,a[g],"exact")}if(c.prefer_nonstop!=undefined&&(c.prefer_nonstop.checked||c.prefer_nonstop.value=="Y")){b+="/nonstop"}}else{b=generateOaD(c,"");b+="/weekend";var n=generateWeekendDays(c);var f=(c.weekend_depart_date)?c.weekend_depart_date.value:"";if(f!="WEEKEND"){b+="/"+f.substr(0,4)+"-"+f.substr(4);if(n!=""){b+="-"+n}}else{if(n!=""){b+="/"+n}}}}if(c.cabin!==undefined){b+=getCabinClass(c.cabin.value)}b+=getTravelersUrlPart(c);return"/flights/"+b}function getTravelersUrlPart(f){var h="";if((f&&f.adults)&&((jq(f.adults).val()!="0")||(f.children&&jq(f.children).val()!="0")||(f.seniors&&jq(f.seniors).val()!="0"))){var d=parseInt(f.adults.value,10);if(isNaN(d)){d=0}var a=parseInt(f.seniors.value,10);if(isNaN(a)){a=0}var g=parseInt(f.children.value,10);if(isNaN(g)){g=0}if(d>1||a>0||g>0){h+="/"+d+"adults"}if(a>0){h+="/"+a+"seniors"}if(g>0){h+="/children";for(var c=1;c<=g;c++){h+="-"+jq(f["childAge"+c]).val()}}}else{if(f.travelers){var b=f.travelers.value;if(b>1){h+="/"+b+"adults"}}}return h}function generateLegParams(b,l,h,g){var j="";if(l>-1){j=l+""}var c="depart_time"+j;var k="flex"+j;var a=generateOaD(b,j);var f=dateToString(h);a=a+"/"+f;if(b[c]){a+=getTimeOption(b[c].value)}var d;if(l==-1&&g!="openflex"){a+=getFlexOption(b.depart_date_flex&&b.depart_date_flex.value)}else{if(g=="openflex"){a+="-flexible-calendar-0"}}return a}function generateOaD(c,n){var o="origin"+n;var k="destination"+n;var p="origincode"+n;var g="destcode"+n;var m="nearbyO"+n;var b="nearbyD"+n;var f=new RegExp("(([A-Z]{3}))","g");var d=c[p].value.substr(0,3);if(d==""||d.indexOf("C-")==0){d=c[o].value+"";d=d.replace(/ /g,"");if(d.indexOf("(")!=-1){var j=f.exec(d);if(j!=null){d=j[0]}}}var l=c[g].value.substr(0,3);if(l==""||l.indexOf("C-")==0){l=c[k].value+"";l=l.replace(/ /g,"");if(l.indexOf("(")!=-1){f.compile(f);var h=f.exec(l);if(h!=null){l=h[0]}}}var a=d;if(c[m]&&c[m].checked){a+=",nearby"}a+="-"+l;if(c[b]&&c[b].checked){a+=",nearby"}return a}function dateToString(c){var d=c.getMonth()+1;if(d<10){d="0"+d}var a=c.getDate();if(a<10){a="0"+a}var b=c.getFullYear()+"-"+d+"-"+a;return b}function getTimeOption(a){if(a=="a"){return""}else{if(a=="r"){return"-early-morning"}else{if(a=="m"){return"-morning"}else{if(a=="n"){return"-afternoon"}else{if(a=="e"){return"-evening"}else{if(a=="l"){return"-night"}else{return"-"+a+"h"}}}}}}}function getCabinClass(a){if(a=="p"){return"/premium"}else{if(a=="b"){return"/business"}else{if(a=="f"){return"/first"}}}return""}function generateWeekendDays(c){var d="";if(c.weekend_depart){var b=c.weekend_depart.value;var a=c.weekend_return.value;if(b!="FRIDAY_ANYTIME"||a!="SUNDAY_ANYTIME"){d=generateWeekendDay(b)+"-"+generateWeekendDay(a)}}return d}function generateWeekendDay(a){if(a=="THURSDAY_ANYTIME"){return"Thu"}else{if(a=="THURSDAY_AM"){return"Thu-AM"}else{if(a=="THURSDAY_PM"){return"Thu-PM"}else{if(a=="FRIDAY_ANYTIME"){return"Fri"}else{if(a=="FRIDAY_AM"){return"Fri-AM"}else{if(a=="FRIDAY_PM"){return"Fri-PM"}else{if(a=="SATURDAY_ANYTIME"){return"Sat"}else{if(a=="SATURDAY_AM"){return"Sat-AM"}else{if(a=="SUNDAY_ANYTIME"){return"Sun"}else{if(a=="SUNDAY_AM"){return"Sun-AM"}else{if(a=="SUNDAY_PM"){return"Sun-PM"}else{if(a=="MONDAY_ANYTIME"){return"Mon"}else{if(a=="MONDAY_AM"){return"Mon-AM"}else{if(a=="MONDAY_PM"){return"Mon-PM"}}}}}}}}}}}}}}return""}function getFlexOption(a){if(a=="plusminusthree"){return"-flexible"}else{if(a=="plusminustwo"){return"-flexible-2days"}else{if(a=="plusminusone"){return"-flexible-1day"}else{if(a=="plusone"){return"-flexible-1day-after"}else{if(a=="minusone"){return"-flexible-1day-before"}}}}}return""}function generateCruisesUrl(g){var j="";if(g.dep_date.value!=""){var d=g.dep_date.value.substr(0,4);var h=g.dep_date.value.substr(4,2);j=d+"-"+h}var a=g.destination;if(a.value!="ALL"){j+="/"+generateDestOrLineString(a.options[a.selectedIndex].text)}var c=g.cruiseline;if(typeof c.value!="undefined"&&c.value!=""){j+="/"+generateDestOrLineString(c.options[c.selectedIndex].text)}var f=g.length;if(f.value!="ALL"){j+="/"+generateLength(f)}if(g.senior!=undefined&&g.senior.checked){j+="/senior"}var b=g.region_code.value;if(b!=""){j+="/state-"+b}return"/cruises/"+j}function generateDestOrLineString(b){var a=b+"";return a.replace(/\//g,"-").replace(/\s-\s/g,"-").replace(/\s/g,"-")}function generateLength(a){return a.options[a.selectedIndex].text.replace(" ","").replace("+","-").toLowerCase()}function encodeLocation(b){var a=b+"";var c=R9.Common.RemoveAccents.removeAccentedChars(a.replace(/, /g,",").replace(/ - /g,",").replace(/ /g,"-"));if(!(typeof R9.globals!="undefined"&&typeof R9.globals.useFullSearchUrl!="undefined"&&R9.globals.useFullSearchUrl==true)){c=c.replace(/[^A-Za-z0-9_\-,.]/g,"")}return c}function generateHotelsUrl(c,r,d,f){var h=(c.hid!=undefined&&c.hid.value!=="undefined"&&c.hid.value!==""&&c.hid.value!==null);var l=(c.amenity!=undefined&&c.amenity.value!==""&&c.amenity.value!==null);var s=(c.frid!=undefined&&c.frid.value!=="undefined"&&c.frid.value!==""&&c.frid.value!==null);var g=(c.rid!=undefined&&c.rid.value!=="undefined"&&c.rid.value!==""&&c.rid.value!==null);var b=(c.cid!=undefined&&c.cid.value!=="undefined"&&c.cid.value!==""&&c.cid.value!==null);var o=c.othercity.value;var q="-c";var n=c.address!=undefined?c.address.value:"";if(n!=""){o=n;if(n.indexOf(c.location.value)==-1){o+=","+c.location.value}q="-a"}var a=encodeLocation(o);var k=c.citycode.value;if(s){a+="-e"+c.frid.value}else{if(g){a+="-r"+c.rid.value}else{if(b){a+="-u"+c.cid.value}else{if(k!=""){a+=q+k}}}}if(h){a+="-h"+c.hid.value;if(f){a+="-details"}}else{if(c.lmid&&c.lmid.value){a+="-l"+c.lmid.value}else{if(c.nhid&&c.nhid.value){a+="-n"+c.nhid.value}}}if(c.minstars&&c.minstars.value&&parseInt(c.minstars.value,10)>=2){a+="-"+c.minstars.value+"stars"}if(c.rating&&c.rating.value&&parseInt(c.rating.value,10)>=2){a+="-mgRating"+c.rating.value+"0"}if(l){a+="-f"+c.amenity.value}if(r!=null&&d!=null){a+="/"+dateToString(r)+"/"+dateToString(d)}var m=(typeof c["guests-input"]==="undefined")?c.guests.value:c["guests-input"].value;var j=(typeof c["rooms-input"]==="undefined")?c.rooms.value:c["rooms-input"].value;if(m>1){a+="/"+m+"guests"}if(j>1){a+="/"+j+"rooms"}var p=c.address_nickname!=undefined?c.address_nickname.value:"";if(p!=""&&p!=n){a+="/at-"+encodeLocation(p)}if(c.neighborhood!=undefined&&c.neighborhood.value!=""&&c.neighborhood.value!=null){if(a.indexOf("?")!=-1){a+="&"}else{a+="?"}a+="neighborhood="+c.neighborhood.value;a+="&filterType=N"}if(c.ambiance!=undefined&&c.ambiance.value!=""&&c.ambiance.value!=null){if(a.indexOf("?")!=-1){a+="&"}else{a+="?"}a+="ambiance="+c.ambiance.value;a+="&filterType=A"}return"/hotels/"+a}function generateCarsUrl(f,d,b){var a=f.citycode1.value;var g=null;var h=f.oneway.value==undefined?f.oneway[1].checked:f.oneway.value=="y";if(a.indexOf("/")==3){g=a.substring(0,3)+"-a"+a.substring(4)}if(g==null){g=encodeLocation(f.location.value)+"-c"+a}if(h){g+="/";var j=f.citycode2.value;var c=null;if(j.indexOf("/")==3){c=j.substring(0,3)+"-a"+j.substring(4)}if(c!=null){g+=c}else{g+=encodeLocation(f.location2.value)+"-c"+j}}if(f.inlinepickup_hour!=undefined){g+="/"+generateDateTime(f,"inlinepickup",d);g+="/"+generateDateTime(f,"inlinedropoff",b)}else{g+="/"+generateDateTime(f,"pickup",d);g+="/"+generateDateTime(f,"dropoff",b)}return"/cars/"+g}function generateDateTime(c,f,b){var d=dateToString(b);var a=c[f+"_hour"].value;if(a!=12){d+="-"+a+"h"}return d}function dateToString(c){var d=c.getMonth()+1;if(d<10){d="0"+d}var a=c.getDate();if(a<10){a="0"+a}var b=c.getFullYear()+"-"+d+"-"+a;return b}function generatePackageToursUrl(a){return"/packages/"+generatePackageToursAbsoluteUrl(a)}function generatePackageToursAbsoluteUrl(f){var d=R9.packagetours.Globals.VIEWTYPE;var h="",c=packageToursOptionalParams(f);var a=f.cardViewEnabled&&f.cardViewEnabled.value=="true";h+=createSearchCriteriaUrl(f.searchCriteriaJson.value,f.defaultSearchCriteriaJson.value);if(f.dhid&&f.dhid.value!=""&&f.dhotelurlame&&f.dhotelurlame.value!=""){h+="/"+f.dhotelurlame.value+"-details-"+f.dhid.value}h+="/"+f.departDate.value;if(f.flexDays){var b=parseInt(f.flexDays.value,10);if(!(b>=0)){b=0}h+="/"+b}else{h+="/"+f.returnDate.value}h+="/"+f.duration.value;h+="/"+f.adults.value;h+="/"+f.child1.value+","+f.child2.value+","+f.child3.value;h+="/"+(generateDepartureAirport(f)||"-");if(c&&!jq.isEmptyObject(c)){h+=serializePackageToursParams(c,":",";")}var g=f.resultView?f.resultView.value:d.HOTELS;if(g===d.MAP||g===d.FLIGHTS||g===d.REGION&&a){h+=";"+g}return h}function serializePackageToursParams(h,g,f){var b={sort:true,desc:true,fsort:true,fdesc:true,details:true,showEmpty:true,maxPrice:true,category:true,amenities:true,airlines:true,stops:true,freebies:true,takeoffTimes:true,landingTimes:true,hotelnames:true,layovertime:true,legduration:true,guestRatings:true,splitbooking:true};var d=[];var c=[];var a="";jq.each(h,function(j,k){if(b[j]){c.push(j+g+k)}else{d.push(j+g+k)}});if(d.length>0){a+="/"+d.join("/")}if(c.length>0){a+=f+c.join(f)}return a}function generateDepartureAirport(c){var b=new RegExp("(([A-Z]{3}))","g");var a=c.origincode.value;if(a===""||a.indexOf("C-")==0){a=c.origin.value+"";a=a.replace(/ /g,"");if(a.indexOf("(")!=-1){var d=b.exec(a);if(d!=null){a=d[0]}else{a=""}}else{if(b.exec(a)===null){a=""}}}else{if(a.indexOf("/")>0){a=a.substring(0,3)}}return a==""?"-":a}function packageToursKeyValueToJson(g,h,a,c){var k=R9.packagetours.Globals.CachedQueryParams;var l={};var j=2;var h=!h?";":h;var a=!a?"=":a;var b=g.split(h);for(var f=0;f<b.length;f++){var d=b[f].split("=");d.splice(1,d.length-1,d.slice(1).join(a));if(d.length==j&&!packageToursIsEmptyFilterStateValue(d[0])){if(!c&&d[0]!==k.HOTEL_NAMES){l[d[0]]=d[1].replace(/-/g,",")}else{l[d[0]]=d[1]}}}return l}function packageToursIsEmptyFilterStateValue(b){var c="NO_DEFAULT";if(!b){return true}var a=jq.trim(b);if(a.length==0){return true}if(a===c){return true}return false}function serializePackageToursFsKeyValueObject(c,b){var a=[];var b=!b?"=":b;jq.each(c,function(d,f){a.push(d+b+f)});return a.join(";")}function packageToursOptionalParams(h){var d=function(){var l=b.TIMES;var o=2400;if(a[l]&&!packageToursIsEmptyFilterStateValue(a[l])){var m=packageToursKeyValueToJson(a[l],"|");if(m.Takeoff0||m.Takeoff1){var k=o;var n=o;if(m.Takeoff0){k=c(m.Takeoff0)}if(m.Takeoff1){n=c(m.Takeoff1)}f[b.TAKE_OFF_TIMES]=k+","+n}if(m.Landing0||m.Landing1){var k=o;var n=o;if(m.Landing0){k=c(m.Landing0)}if(m.Landing1){n=c(m.Landing1)}f[b.LANDING_TIMES]=k+","+n}}};var g=function(){var k=b.SHOW_EMPTY;var l=a[k];if(l&&l==="NO_DEFAULT"||l=="true"){f[k]=true}};var c=function(m){var q=2400,l=60*60*24,o=m.split(",");if(o.length!=2){return q}var n=parseInt(o[0].substring(0,o[0].length-3))%l;var p=parseInt(o[1].substring(0,o[1].length-3))%l;if(isNaN(n)||isNaN(p)){return q}var k=10000*(100*(Math.floor(n/60/60))+(Math.floor(n/60)%60))+100*(Math.floor(p/60/60))+(Math.floor(p/60)%60);return k};var j=function(l,m,k){if(!m){m=l}if(a[l]&&!packageToursIsEmptyFilterStateValue(a[l])){if(!packageToursIsEmptyFilterStateValue(f[m])){f[m]=f[m]+","+a[l]}else{f[m]=a[l]}}if(typeof k!=="undefined"&&k!==null&&!f[m]){f[m]=k}};var f={},b=R9.packagetours.Globals.CachedQueryParams,a=packageToursKeyValueToJson(h.fsParameters.value);j(b.CATEGORY);j(b.GUEST_RATINGS);j(b.MAX_PRICE);j(b.ROOM_TYPES);j(b.BOARD_TYPES);j(b.SPORT_TYPE);j(b.HOLIDAY_TYPE);j(b.TRAVELERS_TYPE);j(b.TRANSFER);j(b.HOTELS_ONLY);j(b.SHOW_SPLIT_BOOKING);g();j(b.RATINGS_COUNT);j(b.OVERALL_RATING);j(b.RECOMMENDATION);j(b.AMENITIES_ACCOMODATION,b.AMENITIES);j(b.AMENITIES_ACCOMODATION_TYPE,b.AMENITIES);j(b.AMENITIES_LOCATION,b.AMENITIES);j(b.AMENITIES_ROOM,b.AMENITIES);d();j(b.STOPS);j(b.FREEBIES);j(b.HOTEL_NAMES);j(b.AIRLINES);j(b.LEG_DURATION);j(b.LAYOVER_TIME);if(h.dhid&&h.dhid.value!=""){if(h.dtab&&h.dtab.value!=""){f[b.DETAILS]=h.dtab.value}else{f[b.DETAILS]="overview"}}j(b.PROVIDERS);return f}function containsHotelInside(f){var b=[],d,c=new RegExp("^([A-Z]{3})$","g");f=jq.trim(f);if(f===""){return false}var a=JSON.parse(f);if(a.length===0){return false}for(d=0;d<a.length;d++){if((typeof a[d].id).toLowerCase()!=="string"){return false}if(c.exec(a[d].id)!=null){return false}if(a[d].id.indexOf("H")!=-1){return true}}return false}function createSearchCriteriaUrl(d,f){var b=[],c;d=jq.trim(d);f=jq.trim(f);if(d===""){if(f===""){return"-"}else{d=f}}var a=JSON.parse(d);if(a.length===0){if(f===""){return"-"}else{a=JSON.parse(f);if(a.length===0){return"-"}}}for(c=0;c<a.length;c++){b.push(encodeSearchCriteria(a[c].name)+"-"+a[c].id)}return b.join(",")}function encodeSearchCriteria(b){var a=b+"";return R9.Common.RemoveAccents.removeAccentedChars(a.replace(/ - /g,"-").replace(/ /g,"-")).replace(/[^A-Za-z0-9_\-]/g,"")}function redirectToPackageTourUrl(a){var c,b;if(a.indexOf("/")===0){a=a.substring(1)}c=a.split("/");if(c&&c.length>1){b=c.splice(1,c.length).join("/");window.location.assign(window.location.protocol+"//"+window.location.hostname+"/"+c[0]+"/"+b)}}(function(a){R9.extend("URL",{Generator:function(c,b){this.form=a(c);this.options=a.extend(true,{},this.options,b||{})}});R9.extend("URL.Generator",{generate:function(c,b){var d=new R9.URL.Generator(c,b);return d.generate()}});R9.extend("URL.Generator.prototype",{form:null,options:{isInlineSearch:false,maxLegs:4,useCleanUrls:false},generate:function(){if(!this.isUseShortUrls()){return null}var b=this.generateFullUrl();this.setUpCookie(b);return b},generateFullUrl:function(){jq(this.form.get(0)).trigger("form-pre-submit");switch(this.getElement("tab").val()){case"flights":var c=this.getElement("dtFlexCat");var o=c.length?((this.options.isInlineSearch||c[0].type=="hidden")?c.val():c.filter(":checked").val()):null;var j=this.getElement("oneway");if(j.length>1){j=j.filter(":checked")}var b=null;var p=null;var k=null;var h=(jq("#travel_dates-end-wrapper").hasClass("r9-datepicker-twofields"));if((this.options.isInlineSearch&&o!="weekend")||(!this.options.isInlineSearch&&(j.val()=="n"||j.val()=="y"))){p=(h)?this.getTravelDatesWrapper().daterangePickerTwoFields("getStartDate"):jq("#travel_dates").daterangePickerOrSingleDate("getStartDate");if(j.val()=="n"){k=(h)?this.getTravelDatesWrapper().daterangePickerTwoFields("getEndDate"):jq("#travel_dates").daterangePickerOrSingleDate("getEndDate")}if(this.options.isInlineSearch&&p==null){p=jq("#inline_depart_date").datepicker("getDate");if(p.length==0){p=null}if(j.val()=="n"){k=jq("#inline_return_date").datepicker("getDate");if(k.length==0){k=null}}}if(p==null){p=this.getDateFromLegacyFrom("#depart_date");if(j.val()=="n"){k=this.getDateFromLegacyFrom("#return_date")}}if(p==null){p=this.getDateFromLegacyFrom("#flightSearchForm_depart_date");if(j.val()=="n"){k=this.getDateFromLegacyFrom("#flightSearchForm_return_date")}}}else{if(j.val()=="m"){b=[];for(var l=0;l<this.options.maxLegs;l++){b[l]=jq("#travel_date"+l).daterangePickerOrSingleDate("getStartDate")}}}return generateFlightsUrl(this.form.get(0),p,k,b,this.options.maxLegs,o);case"flightsMultiCity":return window.location.href;case"hotels":var q,g;if(this.getTravelDatesWrapper().length>0){q=this.getTravelDatesWrapper().daterangePicker("getStartDate");g=this.getTravelDatesWrapper().daterangePicker("getEndDate")}else{if(this.getElementsBySelector(".r9-datepicker-wrapper").length>0){q=this.getElementsBySelector(".r9-datepicker-wrapper").daterangePicker("getStartDate");g=this.getElementsBySelector(".r9-datepicker-wrapper").daterangePicker("getEndDate")}else{q=this.getElementsBySelector("[id^=checkin_date]").datepicker("getDate");g=this.getElementsBySelector("[id^=checkout_date]").datepicker("getDate")}}var f=generateHotelsUrl(this.form.get(0),q,g,(this.getElement("hidToDetailsPage").val()==="true"));if(this.options.isInlineSearch){var d=R9.ViewState.getUrlStateString();if(d){f+=R9.ViewState.getInstance().options.stateDelimiter+d}}return f;case"cars":var m,n;if(this.getTravelDatesWrapper().length>0){m=this.getTravelDatesWrapper().daterangePickerTwoFields("getStartDate");n=this.getTravelDatesWrapper().daterangePickerTwoFields("getEndDate")}else{m=this.getElement("pickup_date").datepicker("getDate");n=this.getElement("dropoff_date").datepicker("getDate")}var f=generateCarsUrl(this.form.get(0),m,n);if(this.options.isInlineSearch){var d=R9.ViewState.getUrlStateString();if(d){f+=R9.ViewState.getInstance().options.stateDelimiter+d}}return f;case"vacations":return generateVacationsUrl(this.form.get(0),this.getElement("depart_date").datepicker("getDate"),this.getElement("return_date").datepicker("getDate"));case"cruises":return generateCruisesUrl(this.form.get(0));case"packagetours":return generatePackageToursUrl(this.form.get(0));default:return""}},isUseShortUrls:function(){var b=this.getElement("usecleanurl");if(b.length){return b.val()=="true"}return this.options.useCleanUrls},getElement:function(b){return this.form.find('[name="'+b+'"]')},getElementsBySelector:function(b){return this.form.find(b)},getTravelDatesWrapper:function(){return this.form.find("#travel_dates-end-wrapper")},setUpCookie:function(c){if(c==null){return}var j="/"+this.getElement("tab").val()+"/";var f=encodeURIComponent(c.substring(c.indexOf(j)+j.length));if(c.indexOf(j)<0){f=encodeURIComponent(c.substring(c.indexOf("/",1)+1))}if(this.getElement("tab").val()=="flightsMultiCity"){f=encodeURIComponent(this.getElement("searchparam").val())}var k="hiddenParams"+f;var d=this.collectCookieParams();var l=new Date();var b=l.getTime();b=b+10000;l.setTime(b);document.cookie=k+"="+encodeURIComponent(d)+"; expires="+l.toGMTString()+"; path=/";var m=(window.BrowserConfig)?BrowserConfig.getString("SwitchWindow","")=="KAYAK":false;if(m){var h=R9.CompareTo.View.getViewFromForm(this.form.get(0)).getUniqueId();var g=R9.CompareTo.Controller.get(h);if(typeof h!=="undefined"&&typeof g!="undefined"){g.focusKayakWindow(c)}}},getDateFromLegacyFrom:function(b){var c;c=jq(b).datepicker("getDate");if(c.length==0){c=null}return c},collectCookieParams:function(){var d={};var f;var r=["src","searchingagain","page_origin","c2s","po","personality","originsid","provider","r9secret","r9debug","searchType","recent","fid","prevsearch_id"];for(f=0;f<r.length;f++){var g=this.getElement(r[f]);if(g.length){d[r[f]]=g.val()}}var h=R9.CompareTo.getController(this.form);if(typeof h!="undefined"){d.comparetosite=h.getCookieValue()}if(R9.config.getBoolean("ui.cmp2.code.refactor",false)){d.c2s="";d.page_origin="";d.src="";d.comparetosite=""}var n=this.getElement("comparetokayak");if(n.length){var l=[];n.each(function(){if(this.checked){l.push(this.value)}});d.comparetokayak=l.join(",")}var q=this.getElement("fsParameters");if(q.length){d.fsParameters=q.val().replace(/=/g,"##")}var c=this.getElement("primetehkila");if(c.length&&c.get(0).checked){d.primetehkila=c.val()}var k=this.getElement("ccFeeCalcSelector");var m=this.getElement("ccFeeCalcEnable");if((m.length&&(m.get(0).type!="checkbox"||m.get(0).checked))||m.length==0){d.ccFeeCalcSelector=k.val()}else{d.ccFeeCalcSelector="none"}var j=this.getElement("railFlyFilterEnable");if((j.length&&j.get(0).checked)||j.length==0){d.railFlyFilter="on"}else{if(j.length&&!j.get(0).checked){d.railFlyFilter="off"}}var p=this.form.get(0).action.value;switch(p){case"dohotels":d=this.getHotelCookieParams(d);if(d.comparetosite){var o=new Date(),b=o.getTime();b=b+10000;o.setTime(b);document.cookie="cmp2Items="+encodeURIComponent(d.comparetosite)+"; expires="+o.toUTCString()+"; path=/"}break;case"doflights":d=this.getFlightCookieParams(d);break;case"dopackagetours":d=this.getPackageTourCookieParams(d);break;case"docars":if(jq("#moreOptionsLink").length){d=this.getCarsCookieParams(d)}break}return decodeURIComponent(a.param(d))},getFlightCookieParams:function(c){var b=this.getElement("airlineFilter");if(b.length&&b.val()!==""){c.airlineFilter=b.val()}return c},getHotelCookieParams:function(g){var c=this.getElement("filterMinStars");var f=this.getElement("filterPriceRange");var d=this.getElement("filterMinGuestRating");var h=this.getElement("filterPropertyType");if(c.length&&c.val()!=""){g.filterMinStars=c.val()}if(f.length&&f.val()!=""&&f.val()!="0"){var b=f.val().split(",");g.filterMinPrice=b[0];g.filterMaxPrice=b[1]}if(d.length&&d.val()!=""){g.filterMinGuestRating=d.val()}if(h.length&&h.val()!=""){g.filterPropertyType=h.val()}return g},getPackageTourCookieParams:function(g){var f=this.getElement("isFrontDoor");var c=this.getElement("searchType");if(f.length&&f.val()=="true"&&c.length&&c.val()=="P"){g.isPFD=f.val();g.maxPrice="";g.category="";g.guestRatings="";g.amenities="";var b=this.getElement("fsParameters");if(b.length&&b.val()!=""){var d=packageToursKeyValueToJson(b.val(),";","=",true);g.maxPrice=typeof d.maxPrice!=="undefined"?d.maxPrice:"";g.category=typeof d.category!=="undefined"?d.category:"";g.guestRatings=typeof d.guestRatings!=="undefined"?d.guestRatings:"";g.amenities=typeof d.amenities!=="undefined"?d.amenities:""}}return g},getCarsCookieParams:function(d){var c=jq("#fs_carfd_cc input:checked").map(function(){return jq(this).val()}).get().join(",");if(c.length){d.filterCarClass=c}var b=jq("#fs_carfd_agencies input:checked").map(function(){return jq(this).val()}).get().join(",");if(b.length){d.filterCarAgency=b}return d}})})(jq||jQuery);function generateSearchUrl(b,a){return R9.URL.Generator.generate(b,{isInlineSearch:a})}function setupSearchParams(a){document.cookie="formParams="+encodeURIComponent(a)+"; path=/";return true}(function(b,a){b.extend("CountryCurrencyPicker",{Controller:function(c,d){this.view=c;this.model=d;this.init()}});b.extend("CountryCurrencyPicker.Controller.prototype",{view:null,model:null,init:function(){var c=this;c.view.on(c.view.events.currencyPicked,function(f,d){c.model.saveCurrency(f,d)})}});b.extend("CountryCurrencyPicker",{Model:function(){}});b.extend("CountryCurrencyPicker.Model.prototype",{saveCurrency:function(d,c){a.ajax({type:"POST",url:"/k/ident/currency",data:{currency:d,posted:true,save:c},dataType:"text",success:function(){location.reload()},cache:false})}});b.extend("CountryCurrencyPicker",{View:function(c){this.options=a.extend.apply(this,[{},this.options,c||{}]);this.emitter=new b.Common.Emitter(this);this.init()}});b.extend("CountryCurrencyPicker.View.prototype",{options:{countryLink:"#countrypickerlink",currencyLink:"#currencyPickerlink",countryList:"#countryList",currencyList:"#currencyList",profileLink:"#userDisplayEmail",profileLinkArrow:"#userDisplayEmailArrow",profileList:"#headermenudropdown",profileMenu:"#accountTooltip",upSellMessage:"#redirectMessage",moreMenuLink:"#moreHeaderLink"},events:{currencyPicked:"currencyPicked"},hidePickers:function(f){var d=this,c=d.options,f=f||false;d.shown=false;a([c.countryList,c.currencyList,c.profileMenu].join(", ")).hide();if(!f){a(c.moreMenuLink).removeClass("show-tooltip")}var g=a(d.options.profileLinkArrow);g.removeClass("arrow-up").addClass("arrow-down");a(d.options.profileLink).removeClass("open")},centerTip:function(c,f){var d=c.find(".header-tooltip .tip");f=Math.floor((c.width()-12)/2+f);d.css("right",f);d.css("left","auto");return f},setMaxWidth:function(f){var d=f.find("#accountTooltip");var c=0;a(".item").each(function(){if(a(this).outerWidth()>c){c=a(this).outerWidth()}});d.css("max-width",c+"px")},makeRedirect:function(c,f,d){if(b.CountryCurrencyPicker.config["nucleus.ispfilter.newRedirect"]&&!b.globals.isSeo){a.ajax({url:c+"/k/run/isp/setcc",dataType:"jsonp",data:{cc:f},complete:function(){d()}})}else{d()}},hideUpSell:function(){var d=this,c=d.options;a(c.upSellMessage).hide()},addMyAccountMenuHandler:function(){var c=this;a(c.options.profileLink).on("click",function(g){var d=a(c.options.profileMenu);var f=a(c.options.profileLinkArrow);if(d.is(":hidden")){c.hideUpSell();if(c.shown){c.hidePickers()}c.shown=true;d.show();f.removeClass("arrow-down").addClass("arrow-up");a(this).addClass("open");c.setMaxWidth(a(this).parent())}else{if(c.shown){c.hidePickers()}}g.stopPropagation()})},shown:false,init:function(){var d=this;if(window.location.pathname=="/"){a(d.options.upSellMessage).show()}a("#footerMenu .isp-redirect.footer-country-picker a").on("click",function(g){g.preventDefault();g.stopPropagation();var f=a(this).attr("href");b.Analytics.api.trackEvent("upsell/footerRedirect",function(){window.location.href=f})});try{if(a(d.options.currencyLink).offset().top<550){a(d.options.currencyList).addClass("shrunken")}}catch(c){}if(a(d.options.upSellMessage).is(":visible")){b.Analytics.api.trackEvent("upsell/show");d.centerTip(a(d.options.upSellMessage).parent(),a(d.options.upSellMessage).parent().data("offset")||0);d.shown=true}a(d.options.upSellMessage).on("click",function(f){f.stopPropagation()});a(d.options.upSellMessage).on("click",".redirect-link",function(g){g.stopPropagation();var f=a(this).parent().data("href");var h=a(this).parent().data("locale");b.Analytics.api.trackEvent("upsell/redirect",function(){d.makeRedirect(f,h,function(){window.location.href=f})})});a(d.options.upSellMessage).on("click",".no-thanks",function(f){f.stopPropagation();f.preventDefault();b.Analytics.api.trackEvent("upsell/no-thanks",function(){a.ajax({url:"/k/run/isp/no-thanks",dataType:"jsonp",complete:function(){d.hideUpSell()}})})});a(d.options.countryLink).on("click",function(g){var f=a(d.options.countryList);if(f.is(":hidden")){d.hideUpSell();if(d.shown){d.hidePickers()}d.shown=true;f.show();d.centerTip(a(this),a(this).data("offset")||0)}else{if(d.shown){d.hidePickers()}}g.stopPropagation()});a(d.options.currencyLink).on("click",function(g){var f=a(d.options.currencyList);if(f.is(":hidden")){d.hideUpSell();if(d.shown){d.hidePickers()}d.shown=true;f.show();d.centerTip(a(this),a(this).data("offset")||30)}else{if(d.shown){d.hidePickers()}}g.stopPropagation()});this.addMyAccountMenuHandler();a(d.options.countryList+" .languageLink").on("click",function(g){g.preventDefault();g.stopPropagation();var h=a.proxy(function(){window.location=a(this).data("href")+"&url="+encodeURIComponent(window.location.pathname+window.location.search+window.location.hash)},this);var f=a("#country_tooltip").data("href");if(f){d.makeRedirect(f,a(this).attr("hreflang"),h)}else{h()}});a(document.body).on("click",function(f){if(d.shown){d.hidePickers()}d.shown=false});a("#country_tooltip a").on("click",function(h){h.preventDefault();var g=a.proxy(function(){var j=a(this).attr("data-href");if(j){window.location=j}else{window.location=a(this).attr("href")}},this);var f=a("#country_tooltip").data("href");if(f){d.makeRedirect(f,a(this).attr("hreflang"),g)}else{g()}});a(d.options.currencyList+" .item").on("click",function(){if(d.shown){d.hidePickers()}var f=a(this).data("cur");if(!b.CountryCurrencyPicker.config["sparkle.affiliate.countrypicker.currency.showSaveToProfileDialog"]){d.emitter.emit(d.events.currencyPicked,[f,false])}else{a.ajax({type:"POST",url:"/k/run/currencysetter/setcurrency",data:{newcurrency:f},dataType:"html",success:function(g){var h=a(g);if(h.text()!==""){h.find("button").button();h.find("#saveCurrency").click(function(){d.emitter.emit(d.events.currencyPicked,[f,true])});h.find("#setCurrency").click(function(){d.emitter.emit(d.events.currencyPicked,[f,false])});h.find("#currencysignup").click(function(){a(h).data("dialog").close();AjaxReg.ui.register(function(){d.emitter.emit(d.events.currencyPicked,[f,true])})});a(h).newDialog({viewPortClass:"currencyDialog",width:410,minHeight:85})}else{d.emitter.emit(d.events.currencyPicked,[f,false])}}})}})}});a(function(){window.r9CurrencyPicker=new b.CountryCurrencyPicker.Controller(new b.CountryCurrencyPicker.View(),new b.CountryCurrencyPicker.Model())})})(window.R9,window.jq||window.jQuery);R9.extend("Logging",{Config:{LINK_REQUEST_TIMEOUT:200,logTopStrip:true,logBottomStrip:true,logflightsForm:true,loghotelsForm:true,logcarsForm:true,logmoreForm:true,logmoreMenu:true,logdealsForm:true,logcruisesForm:false,logvacationsForm:true}});R9.extend("Logging",{CommonLogging:function(a){this.initialize(a)}});R9.extend("Logging.CommonLogging.prototype",{initialize:function(a){this._options=a;if(R9.Logging.Config.logTopStrip){this._initTopStrip()}if(R9.Logging.Config.logBottomStrip){this._initBottomStrip()}if(R9.Logging.Config.logmoreMenu){this._initMoreMenu()}},_initMoreMenu:function(){var b=this;var a=["airlineFees","freeMobileApp","airlineDir","help","directFlights","lowFareTips","explore","myTrips"];for(var c=a.length-1;c>=0;c--){(function(d){jq("#more_"+d).on("click","a",function(){b.before(b.logPureLink,"moremenu/"+d)})})(a[c])}},_initTopStrip:function(){var a=this;function b(c){return a.before(a.logPureLink,"topstrip/"+c)}jq("#logo").off("click.topstrip").on("click.topstrip",jq.proxy(this.before(this.logo),this));jq("#flights-link").off("click.topstrip").on("click.topstrip",jq.proxy(b("flights"),this));jq("#hotels-link").off("click.topstrip").on("click.topstrip",jq.proxy(b("hotels"),this));jq("#cars-link").off("click.topstrip").on("click.topstrip",jq.proxy(b("cars"),this));jq("#more-link").off("click.topstrip").on("click.topstrip",jq.proxy(b("more"),this));jq("#mytripsheaderlink").off("click.topstrip").on("click.topstrip",jq.proxy(b("trips"),this));jq("#mobilebug").off("click.topstrip").on("click.topstrip",jq.proxy(b("mobileapp"),this));jq("#countrypickerlink").off("click.topstrip").on("click.topstrip",R9.Common.Utils.debounce(jq.proxy(b("localecurrencychooser"),this)))},_initBottomStrip:function(){var a=this;function b(c){return a.before(a.logPureLink,"bottomstrip/"+c)}jq("#aboutus-link").on("click.bottomstrip",jq.proxy(b("about"),this));jq("#privacy-link").on("click.bottomstrip",jq.proxy(b("privacy"),this));jq("#help-link").on("click.bottomstrip",jq.proxy(b("help"),this))},before:function(b,c){var a=this;return function(d){b.call(a,d,c);if(!a._options||a._options.preventDefault!==false){d.preventDefault()}}},log:function(b,a){R9.Analytics.api.trackEvent("fd/"+b,{},this.complete(a),true)},complete:function(a){var b=this,d,c=false;d=setTimeout(function(){c=true;b._doNavigation(a)},R9.Logging.Config.LINK_REQUEST_TIMEOUT);return function(){if(!c){clearTimeout(d);b._doNavigation(a)}}},_doNavigation:function(a){var b=!this._options||this._options.doNavigation!==false;if(b&&a){window.location.href=a}},logo:function(){var a=jq("#logo").attr("href");this.log("topstrip/kayaklogo",a)},logPureLink:function(b,c){if(!c){return}var a=null;if(typeof b.target.tagName!="A"){a=jq(b.target).closest("a").prop("href")}else{a=b.target.href}this.log(c,a)}});var LogUserEvents=true||true;new R9.Logging.CommonLogging({preventDefault:false,doNavigation:false});(function(){BrowserConfig=window.BrowserConfig||{};BrowserConfig.getRaw=function(b,a){if(!window.R9||!R9.globals||!R9.globals.browserCapabilities||typeof R9.globals.browserCapabilities[b]=="undefined"){return a}else{return R9.globals.browserCapabilities[b]}};BrowserConfig.set=function(a,b){if(typeof window.R9!="undefined"&&typeof R9.globals!="undefined"&&typeof R9.globals.browserCapabilities!="undefined"){R9.globals.browserCapabilities[a]=String(b)}};BrowserConfig.getString=function(b,a){return String(this.getRaw(b,String(a)))};BrowserConfig.getBoolean=function(b,a){return this.getString(b,a)=="true"};BrowserConfig.getNumber=function(b,a){return Number(this.getString(b,a))}})();(function(h){var t=null;var j=null;var o=false;var d={initialize:function(y){if(t==null){t={}}if(j==null){j={}}if(!window.cmp2_openWinMap){window.cmp2_openWinMap={}}if(!window.cmp2_winSession){window.cmp2_winSession=new R9.CompareTo.Helper.SessionStorage()}var x={popUnderMethod:window.BrowserConfig?BrowserConfig.getString("popUnderMethod","simple"):"simple",limited:window.BrowserConfig?BrowserConfig.getBoolean("limited",true):true,selfClosingUrl:window.BrowserConfig?BrowserConfig.getString("selfClosingUrl","about:blank"):"about:blank"};this.options=h.extend.apply(this,[{},this.options,x,y||{}])},open:function(B,x){var y=h.isArray(B);B=y?B:[B];var A=[];if(B.length>0){r.call(this);if(this.options.popUnderMethod=="switchWindows"){A=v.call(this,B,x)}else{for(var z=0;z<B.length;z++){var C=B[z];A.push(u.call(this,C.url,C.name||"",C.features||"",!!x))}}n.call(this,A,!!x);return y?A:A[0]}return null},attachTo:function(y,x,A,B){var z=this;h(y).off(A).on(A,x,function(C){var D=B(this,C);if(D&&D.length>0&&!o){z.open(D)}})}};function v(B,x){var A=[];var D=true;h.each(B,function(F,G){D=D&&G.name!=""});if(D){var y=null;h.each(B,function(G,I){var F=g(I.name);var H=window.open("",F,"");if(H){y=I;t[I.name]=H}});if(y!=null){h.each(B,function(F,H){if(y.name!=H.name){var G=c(H.name);if(G){G.location.replace(H.url)}}});var C=c(y.name);if(C){C.location.replace(window.location.href);window.location.replace(y.url)}}}else{for(var z=0;z<B.length;z++){var E=B[z];A.push(u.call(this,E.url,E.name||"",E.features||"",!!x))}}return A}function g(x){if(typeof j[x]!="undefined"){return j[x]}return x}function q(x){var y;if(x){y=x.replace(/_/g,"");if(BrowserConfig.getBoolean("useNewSession",false)){y+=window.cmp2_winSession.get("session",new Date().getTime())}}else{y=x}return y}function u(A,z,B,x){B=k(B);var D=c(z);if(D){if(typeof B.width!="undefined"&&typeof B.height!="undefined"){try{D.window.resizeTo(B.width,B.height)}catch(E){}}if(typeof B.left!="undefined"&&typeof B.top!="undefined"){try{D.window.moveTo(B.left,B.top)}catch(E){}}var y=(window.BrowserConfig)?BrowserConfig.getString("popUnderMethod","simple")==="smallPopUp":false;var C=(window.BrowserConfig)?BrowserConfig.getString("reload","simple")==="useHandler":false;if(A&&y||C){D.document.open();D.document.write("<script>");if(typeof B.width!="undefined"&&typeof B.height!="undefined"){D.document.write("window.resizeTo("+B.width+", "+B.height+");")}if(typeof B.left!="undefined"&&typeof B.top!="undefined"){D.document.write("window.moveTo(+ "+B.left+", "+B.top+");")}D.document.write("window.location='"+A+"';");D.document.write("<\/script>");D.document.close();return}}f.call(this);if(this.options.popUnderMethod=="back-tab"&&!x){p(A,z)}else{D=window.open(A,q(z),b(B))}if(D){t[z]=D}w.call(this,D)}function r(){}function f(){}function w(x){if(this.options.popUnderMethod=="simple"&&x){try{x.blur()}catch(y){}window.focus()}else{if(this.options.popUnderMethod=="empty-open"&&x){x.blur();x.opener.window.open("","_self","");x.opener.window.focus()}else{if(this.options.popUnderMethod=="self-close"){p("data:text/html;charset=utf-8;base64,PHNjcmlwdD53aW5kb3cuY2xvc2UoKTs8L3NjcmlwdD4=")}else{if(this.options.popUnderMethod=="focus-window-name"){window.name=l();window.open("",window.name)}else{if(this.options.popUnderMethod=="document-focus"){document.focus()}}}}}}function n(y,x){if(this.options.popUnderMethod=="final-focus"){window.focus()}else{if(this.options.popUnderMethod=="fake-clicks"){p(this.options.selfClosingUrl)}else{if(this.options.popUnderMethod=="final-focus-window-name"){window.name=l();window.open("",window.name)}}}}function l(){return("kayak"+Math.random()+"").replace(new RegExp("[^a-zA-Z0-9]+","gi"),"")}function p(z,A){var C=BrowserConfig.getString("popUnderMethod","simple")=="back-tab";if(!C||!A||(C&&!window.cmp2_openWinMap[A])){window.cmp2_openWinMap[A]=true;var F=h("<a />").attr("href",z);if(A){F.attr("target",q(A))}F=F.appendTo(document.body).get(0);var x=document.createEvent("MouseEvents");var B=true;var y=false;var E=false;var D=true;x.initMouseEvent("click",true,true,window,0,0,0,0,0,B,y,E,D,0,null);F.dispatchEvent(x);F.parentNode.removeChild(F)}}function k(x){return(typeof x=="string"?s(x):x)}function s(x){var y={};h.each(x.split(","),function(A,z){z=z.split("=");if(z.length==2){y[z[0]]=z[1]}});return y}function b(y){var x=[];for(key in y){if(y.hasOwnProperty(key)){x.push(key+"="+y[key])}}return x.join(",")}function c(x){try{var y=t[x];if(!y||y.closed){return}return y}catch(z){return null}}R9=window.R9||{};R9.Utils=R9.Utils||{};R9.Utils.WindowOpener=d.initialize;R9.Utils.WindowOpener.prototype=d;R9.Utils.WindowOpener.open=function(y,x){return(new R9.Utils.WindowOpener()).open(y,x)};R9.Utils.WindowOpener.closeWindow=function(x){if(BrowserConfig.getString("popUnderMethod","simple")=="back-tab"||BrowserConfig.getString("overlayPopUnderMethod","simple")=="simple"){if(typeof window.cmp2_openWinMap!=="undefined"){if(window.cmp2_openWinMap[x]){window.open(BrowserConfig.getString("selfClosingUrl","/s/compareresults/close"),q(x))}window.cmp2_openWinMap[x]=false}}else{window.open(BrowserConfig.getString("selfClosingUrl","/s/compareresults/close"),q(x))}};R9.Utils.WindowOpener.cleanUp=function(){if(BrowserConfig.getString("popUnderMethod","simple")=="back-tab"){if(window.cmp2_winSession){window.cmp2_winSession.set("session",new Date().getTime())}window.cmp2_openWinMap={}}};R9.Utils.WindowOpener.tabsCMP2Open=function(z){var y=jq(this).data("taburl");window.open(y,z);if(window.R9&&window.R9.Analytics){var x=jq(this).data("permtabindex");R9.Analytics.api.trackEvent("CMP2TabClick/"+z+"/index/"+x)}};R9.Utils.WindowOpener.tabsCMP2OpenIFrame=function(y){jq(".pageTabs .pageTab.selected").removeClass("selected");jq(".subheader").hide();jq("#bd, #ft").hide();jq(".cmp2IFrames").addClass("hiddenIFrame");jq("#IFrame_"+y).removeClass("hiddenIFrame");jq(this).addClass("selected");if(Logger){var x=jq(this).data("permtabindex");R9.Analytics.api.trackEvent("CMP2TabClickIFrame/"+y+"/index/"+x)}};var a=function(y){var x=jq(window).height()-65-jq(".pageTabsOuter").height();jq(y).height(x).width(jq(".cmp2Holders").width())};var m=function(){a(".cmp2IFrames")};R9.Utils.WindowOpener.generateIFrames=function(y){var x=jq(".cmp2Holders");if(jq(".cmp2Holders").length==0){x=jq("<div />").addClass("cmp2Holders");x.insertAfter("#bd")}jq.each(y,function(A,B){var z=jq("<iframe />",{frameborder:0,name:B.name,src:B.url,"class":"cmp2IFrames hiddenIFrame",id:"IFrame_"+B.name,load:function(){a(this)}});x.append(z);if(R9&&R9.Analytics){R9.Analytics.api.trackEvent("CMP2TabClickIFrameLoad/"+B.name)}});jq(window).off(".iframes").on("resize.iframes",m)};R9.Utils.WindowOpener.skipOpenWindows=function(x){o=x};R9.Utils.WindowOpener.setCustomWindowsMapByName=function(x){j=x};R9.Utils.WindowOpener.isAllWindowsUnfocused=function(){try{if(document.hasFocus){var x=true;for(var y in t){var z=t[y];x=x&&!z.window.document.hasFocus()}return x}else{throw"undefined document.hasFocus() function"}}catch(A){return A}};R9.Utils.WindowOpener.getHandle=function(x){return c(x)};R9.Utils.WindowOpener.totalOpenedWindows=function(){return Object.keys(t).length}})(window.jq||window.jQuery);(function(a){R9.extend("Utils",{BrowserHistory:function(b){if(R9.Utils.BrowserHistory.prototype._Instance){return R9.Utils.BrowserHistory.prototype._Instance}this.options=a.extend({},this.options,b);this.init();R9.Utils.BrowserHistory.prototype._Instance=this}});R9.extend("Utils.BrowserHistory.prototype",{currentState:undefined,isRestoringState:false,options:{detectState:function(){return null},popStateHandler:function(b,c){},stopCustomHandlingCondition:function(b){return(typeof b!=="undefined")},hasState:function(){return(!!history.state)}},init:function(){if(!this.options.hasState()){this.currentState=this.options.detectState();history.replaceState(this.currentState,document.title)}else{this.currentState=history.state}this.setCustomPopStateListener()},changeState:function(b){if(this.isRestoringState){this.finishRestoringState();return}history.pushState(b,document.title);this.currentState=b;this.setCustomPopStateListener()},setCustomPopStateListener:function(){var b=this;a(window).off("popstate");a(window).on("popstate",function(){if(b.options.stopCustomHandlingCondition(history.state)){b.removePopStateListener()}else{b.isRestoringState=true;b.options.popStateHandler(b.currentState,history.state);b.currentState=history.state}})},finishRestoringState:function(){this.isRestoringState=false},removePopStateListener:function(){a(window).off("popstate");a(window).trigger("popstate")}})})(jq||jQuery);var swfobject=function(){var aq="undefined",aD="object",ab="Shockwave Flash",X="ShockwaveFlash.ShockwaveFlash",aE="application/x-shockwave-flash",ac="SWFObjectExprInst",ax="onreadystatechange",af=window,aL=document,aB=navigator,aa=false,Z=[aN],aG=[],ag=[],al=[],aJ,ad,ap,at,ak=false,aU=false,aH,an,aI=true,ah=function(){var a=typeof aL.getElementById!=aq&&typeof aL.getElementsByTagName!=aq&&typeof aL.createElement!=aq,f=aB.userAgent.toLowerCase(),c=aB.platform.toLowerCase(),j=c?/win/.test(c):/win/.test(f),l=c?/mac/.test(c):/mac/.test(f),h=/webkit/.test(f)?parseFloat(f.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,d=!+"\v1",g=[0,0,0],m=null;if(typeof aB.plugins!=aq&&typeof aB.plugins[ab]==aD){m=aB.plugins[ab].description;if(m&&!(typeof aB.mimeTypes!=aq&&aB.mimeTypes[aE]&&!aB.mimeTypes[aE].enabledPlugin)){aa=true;d=false;m=m.replace(/^.*\s+(\S+\s+\S+$)/,"$1");g[0]=parseInt(m.replace(/^(.*)\..*$/,"$1"),10);g[1]=parseInt(m.replace(/^.*\.(.*)\s.*$/,"$1"),10);g[2]=/[a-zA-Z]/.test(m)?parseInt(m.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof af.ActiveXObject!=aq){try{var k=new ActiveXObject(X);if(k){m=k.GetVariable("$version");if(m){d=true;m=m.split(" ")[1].split(",");g=[parseInt(m[0],10),parseInt(m[1],10),parseInt(m[2],10)]}}}catch(b){}}}return{w3:a,pv:g,wk:h,ie:d,win:j,mac:l}}(),aK=function(){if(!ah.w3){return}if((typeof aL.readyState!=aq&&aL.readyState=="complete")||(typeof aL.readyState==aq&&(aL.getElementsByTagName("body")[0]||aL.body))){aP()}if(!ak){if(typeof aL.addEventListener!=aq){aL.addEventListener("DOMContentLoaded",aP,false)}if(ah.ie&&ah.win){aL.attachEvent(ax,function(){if(aL.readyState=="complete"){aL.detachEvent(ax,arguments.callee);aP()}});if(af==top){(function(){if(ak){return}try{aL.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}aP()})()}}if(ah.wk){(function(){if(ak){return}if(!/loaded|complete/.test(aL.readyState)){setTimeout(arguments.callee,0);return}aP()})()}aC(aP)}}();function aP(){if(ak){return}try{var b=aL.getElementsByTagName("body")[0].appendChild(ar("span"));b.parentNode.removeChild(b)}catch(a){return}ak=true;var d=Z.length;for(var c=0;c<d;c++){Z[c]()}}function aj(a){if(ak){a()}else{Z[Z.length]=a}}function aC(a){if(typeof af.addEventListener!=aq){af.addEventListener("load",a,false)}else{if(typeof aL.addEventListener!=aq){aL.addEventListener("load",a,false)}else{if(typeof af.attachEvent!=aq){aM(af,"onload",a)}else{if(typeof af.onload=="function"){var b=af.onload;af.onload=function(){b();a()}}else{af.onload=a}}}}}function aN(){if(aa){Y()}else{am()}}function Y(){var d=aL.getElementsByTagName("body")[0];var b=ar(aD);b.setAttribute("type",aE);var a=d.appendChild(b);if(a){var c=0;(function(){if(typeof a.GetVariable!=aq){var f=a.GetVariable("$version");if(f){f=f.split(" ")[1].split(",");ah.pv=[parseInt(f[0],10),parseInt(f[1],10),parseInt(f[2],10)]}}else{if(c<10){c++;setTimeout(arguments.callee,10);return}}d.removeChild(b);a=null;am()})()}else{am()}}function am(){var h=aG.length;if(h>0){for(var j=0;j<h;j++){var c=aG[j].id;var n=aG[j].callbackFn;var a={success:false,id:c};if(ah.pv[0]>0){var k=aS(c);if(k){if(ao(aG[j].swfVersion)&&!(ah.wk&&ah.wk<312)){ay(c,true);if(n){a.success=true;a.ref=av(c);n(a)}}else{if(aG[j].expressInstall&&au()){var f={};f.data=aG[j].expressInstall;f.width=k.getAttribute("width")||"0";f.height=k.getAttribute("height")||"0";if(k.getAttribute("class")){f.styleclass=k.getAttribute("class")}if(k.getAttribute("align")){f.align=k.getAttribute("align")}var g={};var d=k.getElementsByTagName("param");var m=d.length;for(var l=0;l<m;l++){if(d[l].getAttribute("name").toLowerCase()!="movie"){g[d[l].getAttribute("name")]=d[l].getAttribute("value")}}ae(f,g,c,n)}else{aF(k);if(n){n(a)}}}}}else{ay(c,true);if(n){var b=av(c);if(b&&typeof b.SetVariable!=aq){a.success=true;a.ref=b}n(a)}}}}}function av(b){var d=null;var c=aS(b);if(c&&c.nodeName=="OBJECT"){if(typeof c.SetVariable!=aq){d=c}else{var a=c.getElementsByTagName(aD)[0];if(a){d=a}}}return d}function au(){return !aU&&ao("6.0.65")&&(ah.win||ah.mac)&&!(ah.wk&&ah.wk<312)}function ae(g,d,j,f){aU=true;ap=f||null;at={success:false,id:j};var a=aS(j);if(a){if(a.nodeName=="OBJECT"){aJ=aO(a);ad=null}else{aJ=a;ad=j}g.id=ac;if(typeof g.width==aq||(!/%$/.test(g.width)&&parseInt(g.width,10)<310)){g.width="310"}if(typeof g.height==aq||(!/%$/.test(g.height)&&parseInt(g.height,10)<137)){g.height="137"}aL.title=aL.title.slice(0,47)+" - Flash Player Installation";var b=ah.ie&&ah.win?"ActiveX":"PlugIn",c="MMredirectURL="+af.location.toString().replace(/&/g,"%26")+"&MMplayerType="+b+"&MMdoctitle="+aL.title;if(typeof d.flashvars!=aq){d.flashvars+="&"+c}else{d.flashvars=c}if(ah.ie&&ah.win&&a.readyState!=4){var h=ar("div");j+="SWFObjectNew";h.setAttribute("id",j);a.parentNode.insertBefore(h,a);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}aA(g,d,j)}}function aF(a){if(ah.ie&&ah.win&&a.readyState!=4){var b=ar("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(aO(a),b);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}else{a.parentNode.replaceChild(aO(a),a)}}function aO(b){var d=ar("div");if(ah.win&&ah.ie){d.innerHTML=b.innerHTML}else{var f=b.getElementsByTagName(aD)[0];if(f){var a=f.childNodes;if(a){var g=a.length;for(var c=0;c<g;c++){if(!(a[c].nodeType==1&&a[c].nodeName=="PARAM")&&!(a[c].nodeType==8)){d.appendChild(a[c].cloneNode(true))}}}}}return d}function aA(f,h,c){var d,a=aS(c);if(ah.wk&&ah.wk<312){return d}if(a){if(typeof f.id==aq){f.id=c}if(ah.ie&&ah.win){var g="";for(var k in f){if(f[k]!=Object.prototype[k]){if(k.toLowerCase()=="data"){h.movie=f[k]}else{if(k.toLowerCase()=="styleclass"){g+=' class="'+f[k]+'"'}else{if(k.toLowerCase()!="classid"){g+=" "+k+'="'+f[k]+'"'}}}}}var j="";for(var l in h){if(h[l]!=Object.prototype[l]){j+='<param name="'+l+'" value="'+h[l]+'" />'}}a.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+g+">"+j+"</object>";ag[ag.length]=f.id;d=aS(f.id)}else{var b=ar(aD);b.setAttribute("type",aE);for(var m in f){if(f[m]!=Object.prototype[m]){if(m.toLowerCase()=="styleclass"){b.setAttribute("class",f[m])}else{if(m.toLowerCase()!="classid"){b.setAttribute(m,f[m])}}}}for(var n in h){if(h[n]!=Object.prototype[n]&&n.toLowerCase()!="movie"){aQ(b,n,h[n])}}a.parentNode.replaceChild(b,a);d=b}}return d}function aQ(b,d,c){var a=ar("param");a.setAttribute("name",d);a.setAttribute("value",c);b.appendChild(a)}function aw(a){var b=aS(a);if(b&&b.nodeName=="OBJECT"){if(ah.ie&&ah.win){b.style.display="none";(function(){if(b.readyState==4){aT(a)}else{setTimeout(arguments.callee,10)}})()}else{b.parentNode.removeChild(b)}}}function aT(a){var b=aS(a);if(b){for(var c in b){if(typeof b[c]=="function"){b[c]=null}}b.parentNode.removeChild(b)}}function aS(a){var c=null;try{c=aL.getElementById(a)}catch(b){}return c}function ar(a){return aL.createElement(a)}function aM(a,c,b){a.attachEvent(c,b);al[al.length]=[a,c,b]}function ao(a){var b=ah.pv,c=a.split(".");c[0]=parseInt(c[0],10);c[1]=parseInt(c[1],10)||0;c[2]=parseInt(c[2],10)||0;return(b[0]>c[0]||(b[0]==c[0]&&b[1]>c[1])||(b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]))?true:false}function az(b,g,a,c){if(ah.ie&&ah.mac){return}var f=aL.getElementsByTagName("head")[0];if(!f){return}var h=(a&&typeof a=="string")?a:"screen";if(c){aH=null;an=null}if(!aH||an!=h){var d=ar("style");d.setAttribute("type","text/css");d.setAttribute("media",h);aH=f.appendChild(d);if(ah.ie&&ah.win&&typeof aL.styleSheets!=aq&&aL.styleSheets.length>0){aH=aL.styleSheets[aL.styleSheets.length-1]}an=h}if(ah.ie&&ah.win){if(aH&&typeof aH.addRule==aD){aH.addRule(b,g)}}else{if(aH&&typeof aL.createTextNode!=aq){aH.appendChild(aL.createTextNode(b+" {"+g+"}"))}}}function ay(a,c){if(!aI){return}var b=c?"visible":"hidden";if(ak&&aS(a)){aS(a).style.visibility=b}else{az("#"+a,"visibility:"+b)}}function ai(b){var a=/[\\\"<>\.;]/;var c=a.exec(b)!=null;return c&&typeof encodeURIComponent!=aq?encodeURIComponent(b):b}var aR=function(){if(ah.ie&&ah.win){window.attachEvent("onunload",function(){var a=al.length;for(var b=0;b<a;b++){al[b][0].detachEvent(al[b][1],al[b][2])}var d=ag.length;for(var c=0;c<d;c++){aw(ag[c])}for(var f in ah){ah[f]=null}ah=null;for(var g in swfobject){swfobject[g]=null}swfobject=null})}}();return{registerObject:function(a,f,c,b){if(ah.w3&&a&&f){var d={};d.id=a;d.swfVersion=f;d.expressInstall=c;d.callbackFn=b;aG[aG.length]=d;ay(a,false)}else{if(b){b({success:false,id:a})}}},getObjectById:function(a){if(ah.w3){return av(a)}},embedSWF:function(m,f,j,g,c,a,b,k,h,l){var d={success:false,id:f};if(ah.w3&&!(ah.wk&&ah.wk<312)&&m&&f&&j&&g&&c){ay(f,false);aj(function(){j+="";g+="";var s={};if(h&&typeof h===aD){for(var q in h){s[q]=h[q]}}s.data=m;s.width=j;s.height=g;var p={};if(k&&typeof k===aD){for(var r in k){p[r]=k[r]}}if(b&&typeof b===aD){for(var n in b){if(typeof p.flashvars!=aq){p.flashvars+="&"+n+"="+b[n]}else{p.flashvars=n+"="+b[n]}}}if(ao(c)){var o=aA(s,p,f);if(s.id==f){ay(f,true)}d.success=true;d.ref=o}else{if(a&&au()){s.data=a;ae(s,p,f,l);return}else{ay(f,true)}}if(l){l(d)}})}else{if(l){l(d)}}},switchOffAutoHideShow:function(){aI=false},ua:ah,getFlashPlayerVersion:function(){return{major:ah.pv[0],minor:ah.pv[1],release:ah.pv[2]}},hasFlashPlayerVersion:ao,createSWF:function(a,b,c){if(ah.w3){return aA(a,b,c)}else{return undefined}},showExpressInstall:function(b,a,d,c){if(ah.w3&&au()){ae(b,a,d,c)}},removeSWF:function(a){if(ah.w3){aw(a)}},createCSS:function(b,a,c,d){if(ah.w3){az(b,a,c,d)}},addDomLoadEvent:aj,addLoadEvent:aC,getQueryParamValue:function(b){var a=aL.location.search||aL.location.hash;if(a){if(/\?/.test(a)){a=a.split("?")[1]}if(b==null){return ai(a)}var c=a.split("&");for(var d=0;d<c.length;d++){if(c[d].substring(0,c[d].indexOf("="))==b){return ai(c[d].substring((c[d].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(aU){var a=aS(ac);if(a&&aJ){a.parentNode.replaceChild(aJ,a);if(ad){ay(ad,true);if(ah.ie&&ah.win){aJ.style.display="block"}}if(ap){ap(at)}}aU=false}}}}();(function(a){R9.extend("Utils.ResourcePreloader",{loadResources:function(g,h){var c,f,b;if(!g||!g.length){if(h){h()}}c={count:g.length};if(h){b=function(){c.count--;if(c.count==0){h()}}}for(var d=0;d<g.length;d++){if(b){jq.ajax(g[d]).done(b)}else{jq.ajax(g[d])}}}})})(jq||jQuery);(function(a){R9.extend("App",{Application:function(b){this.options=a.extend(true,{},this.options,b||{});this.init()}});R9.extend("App.Application",{});R9.extend("App.Application.prototype",{options:{useDefaultNavigation:false,useClientCache:true,cacheInitialPage:false,maxCacheEntrySize:10,maxCacheTTL:20*60*1000,ignoreUrls:[]},router:null,pageCache:null,setContentInProgress:false,setContentRequest:null,useAbsoluteUrl:true,init:function(){var b=this;this.router=new Backbone.Router();this.pageCache=new R9.Common.Cache({maxLifeSpam:this.options.maxCacheTTL,defaultLifeSpam:this.options.maxCacheTTL,garbageCollectionTime:60*1000,maxCacheEntrySize:this.options.maxCacheEntrySize});if(this.options.cacheInitialPage&&this.options.useClientCache!==false){this.cacheCurrentPage()}this.router.route(/^(.*)$/,function(c){b.defaultRoute(c)});this.router.route(/^((flights|hotels|cars|deals|vacations)\/(.*))$/,function(d,c,f){b.searchRoute(d,c,f)});this.router.route(/^((flights|hotels|cars|deals|vacations)\/?)$/,function(d,c){b.frontDoorRoute(d,c)});Backbone.history.start({pushState:true,silent:true,hashChange:false})},navigate:function(d,c){if(!d){return}if(!this.supportsAjax()||this.options.useDefaultNavigation){return this.defaultNavigation(d)}var f=c&&c.reload;var b=this.options.useClientCache;if(f){Backbone.history.fragment=null;this.options.useClientCache=false}try{if(d.indexOf("/")!=0){this.useAbsoluteUrl=false}Backbone.history.loadUrl(d)}finally{this.options.useClientCache=b}},frontDoorRoute:function(c,b){if(this.isIgnored(c)){return this.defaultNavigation(c)}var c="/"+b;if(this.options.beforeNavigate){this.options.beforeNavigate.call(this,"fd",b,c)}this.loadPage(c)},searchRoute:function(c,b,d){if(this.isIgnored(c)){return this.defaultNavigation(c)}var c="/"+b+"/"+d;if(this.options.beforeNavigate){this.options.beforeNavigate.call(this,"rp",b,c)}R9.ViewState.getInstance().reset();if(typeof FilterList!="undefined"&&FilterList){FilterList.reset()}this.loadPage(c)},defaultRoute:function(b){if(this.isIgnored(b)){return this.defaultNavigation(b)}b=(this.useAbsoluteUrl?"/":"")+(b||"");if(this.options.beforeNavigate){this.options.beforeNavigate.call(this,null,null,b)}this.loadPage(b)},supportsAjax:function(){var c=window.history&&window.history.pushState;var d=jq("<body></body>");d[0].innerHTML="<html><head><style></style></head></html>";var b=d.find("style").length>0;return c&&b},loadPage:function(c){var g;var f=this;if(!this.supportsAjax()||this.options.useDefaultNavigation){return this.defaultNavigation(c)}if(this.request){this.request.abort();this.request=null}var b=(this.options.useClientCache!==false);if(b){g=this.getCachedContent(c);if(g){this.setContent(g,true,false,null);return}}var d=new Date().getTime();this.request=jq.ajax({url:c,dataType:"text"}).done(function(j){var h=new Date().getTime();g=f.prepareContent(c,j);if(b){f.cacheContent(c,g)}f.setContent(g,false,false,{start_t:d,resp_t:h});f.request=null})},cachePage:function(b){var c=this;if(!this.supportsAjax()||this.options.useClientCache===false){return}jq.ajax({url:b,dataType:"text"}).done(function(f){var d=c.prepareContent(b,f);c.cacheContent(b,d);c.setContent(d,true,true,null)})},cachePageMerge:function(b){var c=this;if(!this.supportsAjax()||this.options.useClientCache===false){return}jq.ajax({url:b,dataType:"text",data:{forcache:true}}).done(function(f){var d=c.prepareContent(b,f);d.body=document.body;c.cacheContent(b,d)})},cacheCurrentPage:function(){var b=this;if(!this.supportsAjax()||this.options.useClientCache===false){return}jq(document).ready(function(){var c=document.location.pathname;var d=b.prepareContent(c,document.documentElement.outerHTML);b.cacheContent(c,d)})},getCachedContent:function(b){var c=this.pageCache.get(b);if(c&&c.url&&c.body&&c.head&&c.scripts){return c}this.pageCache.set(b,null);return null},cacheContent:function(b,c){if(c&&c.url&&c.body&&c.head&&c.scripts){this.pageCache.set(b,c)}},prepareContent:function(c,g){var d,m,n,f,l,o;if(typeof g=="string"){d=jq("<html></html>");l=jq("<head></head>");o=jq("<body></body>");o[0].innerHTML=g;var k,j;jq.each({head:l,body:o},function(h,b){if(k=g.match(new RegExp("<"+h+"([^<>]*)>","i"))){jq.each(jq("<div".concat(k[1],"/>"))[0].attributes,function(q,p){b.attr(p.nodeName,p.nodeValue)})}});l.append(o.find("link,style").detach());l.append(o.find("meta").detach());l.append(o.find("title").detach());d[0].appendChild(o[0]);d[0].appendChild(l[0])}else{d=jq(g)}m=d.find("body");n=d.find("head");f=d.find("script").not("type=text/x-dot-template").detach();return{url:c,body:m[0],head:n[0],scripts:f}},setContent:function(g,c,b,f){var d=this;if(this.setContentInProgress){this.setContentRequest=function(){d.setContent(g,c,f)};return}this.setContentInProgress=true;g={url:g.url,body:g.body,head:g.head.cloneNode(true),scripts:g.scripts};if(this.options.beforeHtmlSet){this.options.beforeHtmlSet.call(this,g,c,b)}var h=function(o){var r=document.documentElement;var q=document.getElementsByTagName("head")[0];var p=document.body;var n={};var j={};var l=[];var k={};var m;if(!o){jq("style[type='text/css'][data-href],link[rel='stylesheet']",g.head).each(function(){m=this.href||jq(this).attr("data-href");n[m]=this});jq("style[type='text/css'][data-href],link[rel='stylesheet']",q).each(function(){m=this.href||jq(this).attr("data-href");j[m]=this});for(m in n){if(n[m].nodeName.toLowerCase()=="link"){if(!j[m]){l.push(m)}}}for(m in j){if(!n[m]){k[m]=j[m]}}}R9.Utils.ResourcePreloader.loadResources(l,function(){var u;if(d.options.beforeCssReplace){d.options.beforeCssReplace.call(d,g,c,o,{head:q,body:p})}if(!o){for(m in k){jq(k[m]).detach()}for(m in n){q.appendChild(n[m])}for(m in j){if(!k[m]){jq(j[m]).detach()}}}var x=jq("title",q)[0];var t=jq("title",g.head)[0];if(x&&t){jq(x).detach();q.appendChild(t)}else{if(t){q.appendChild(t)}}r.replaceChild(g.body,p);var v=new Date().getTime();var w=function(){if(d.options.afterHtmlSet){d.options.afterHtmlSet.call(d,g,c,o,{head:q,body:p})}if(d.options.beforeScripts){d.options.beforeScripts.call(d,g,c,o)}d.updateBrowserLocationWithoutNavigation(g.url);d.cachedEval=c;jq(g.scripts).each(function(){d.evalScript(this)});if(d.options.afterScripts){d.options.afterScripts.call(d,g,c,o)}d.cachedEval=null;var s=new Date().getTime();if(f&&window.searchid){d.logTiming(window.searchid,f.start_t,f.resp_t,v,s)}d.setContentInProgress=false;if(d.setContentRequest){var y=d.setContentRequest;d.setContentRequest=null;y()}};if(!o){setTimeout(w,100)}else{w()}})};if(c&&!b){setTimeout(h,100)}else{h(b)}},evalScript:function(d){try{var g=d.src;if(g){var b=jq(d).attr("data-tag");if(!this.isLoaded(g)||(b!="common")){jq.ajax({url:g,async:false,dataType:"script"})}}else{var f=d.text||d.textContent||d.innerHTML||"";jq.globalEval(f)}if(d.parentNode){d.parentNode.removeChild(d)}}catch(c){if(R9&&R9.utils){R9.utils.log("Error in script eval.",c,d)}}},isLoaded:function(d){if(window.R9App){var b=window.R9App.scripts;if(b){var f=d.indexOf("?");if(f!=-1){d=d.substring(0,f)}for(var c in b){if(b.hasOwnProperty(c)&&d.indexOf(c,d.length-c.length)!==-1){return true}}}}return false},logTiming:function(h,k,j,c,b){var f=j-k;var g=c-k;var d=b-k;jq.post("/s/sparkle",{searchid:h,action:"ss",rt:f,ht:g,st:d})},isIgnored:function(c){var d=0;var b=this.options.ignoreUrls;if(c!==null){for(;d<b.length;d++){if(c.match(new RegExp(b[d]))){return true}}}return false},defaultNavigation:function(b){if(b.indexOf("://")==-1){b="/"+b;b=b.replace(/\/+/g,"/");var c=document.location.protocol+"//"+document.location.host+b;document.location.href=c}else{document.location.href=b}return false},updateBrowserLocationWithoutNavigation:function(b){Backbone.history.fragment=null;this.router.navigate(b,{trigger:false})}})})(jq||jQuery);(function(a){R9.extend("Tabs",{SearchTabs:function(b){this.options=a.extend(true,{},this.options,b||{});this.tabArea=a(this.options.tabAreaSelector)}});R9.extend("Tabs.SearchTabs",{lastKnownTabs:null,newTabSelected:function(d,c){var b=new R9.Tabs.SearchTabs(c);return b.selectNewTab(d)},setLastKnownTabs:function(d){var b=a(d.body).find(R9.Tabs.SearchTabs.prototype.options.tabsContainer);var c=document.createDocumentFragment();if(b.size()>0){c.appendChild(b[0].cloneNode(true))}this.lastKnownTabs=c},clearLastKnownTabs:function(){this.lastKnownTabs=null},setLastKnownTabsFromDocument:function(){var b=new Object();b.body=document.body;R9.Tabs.SearchTabs.setLastKnownTabs(b)},restoreLastKnownTabs:function(k){if(this.lastKnownTabs==null){return}var d=this.lastKnownTabs.querySelectorAll(".pageTab.transient");for(var h=0;h<d.length;h++){d[h].parentNode.removeChild(d[h])}a(".pageTab",this.lastKnownTabs.firstChild).removeClass("selected").removeClass("loading");var j=a(k.body);var f=j.find(".pageTab.transient");if(f.length){f.addClass("selected");var c=this.lastKnownTabs.querySelector(R9.Tabs.SearchTabs.prototype.options.tabsContainer);var l=this.lastKnownTabs.querySelector(R9.Tabs.SearchTabs.prototype.options.closeAllTabsSelector);if(l==null){l=c.lastElementChild}c.insertBefore(f[0],l)}else{a(".pageTab",this.lastKnownTabs.firstChild).each(function(m){var n=a(this);if(n.data("taburl")==k.url){n.addClass("selected")}})}var g=j.find(R9.Tabs.SearchTabs.prototype.options.tabAreaSelector)[0];if(g==null){return}var b=j.find(R9.Tabs.SearchTabs.prototype.options.tabsContainer);if(b.length==0){g.appendChild(this.lastKnownTabs.cloneNode(true))}else{g.replaceChild(this.lastKnownTabs.cloneNode(true),b[0]);(a(g).find(".pageTab").length==1)?a(g).find(".pageTabs").addClass("hidden"):a(g).find(".pageTabs").removeClass("hidden")}R9.Tabs.SearchTabs.adjustTabSizeToFitBar(false)},adjustTabSizeToFitBar:function(d){var k=a(R9.Tabs.SearchTabs.prototype.options.tabsContainer);var g=k.find(".pageTabCloseAll");if(d){k.children().css("width","auto");k.children().css("max-width","none");k.removeClass("compressed");g.css("width","30px")}if((k.length==1&&k[0].scrollHeight>(k[0].offsetHeight*1.5))){k.addClass("compressed");var c=k.children(".pageTab:not(.selected)").not(".pageTabCloseAll");var j=(k[0].offsetWidth-((g.length==1)?g.width():0)-1);var b=a(c).length;var h=a(".pageTab.selected").width()/b;var f=Math.floor((j-2*(b+1))/b)-Math.ceil(h)-1;a(c).css({width:f+"px","max-width":"none"})}},removeTab:function(g){var d=a(g).closest(".pageTab");var b=d.hasClass("selected");if(d.data("permtabindex")!=-1&&R9.globals&&R9.globals.formtoken){var c={tabUrl:d.data("taburl"),formtoken:R9.globals.formtoken};a.post("/s/run/tabs/remove",c)}if(!b){d.remove();R9.Tabs.SearchTabs.adjustTabSizeToFitBar(true);R9.Tabs.SearchTabs.setLastKnownTabsFromDocument()}else{var f=d.next(".pageTab");if(f.length==0||f.hasClass("pageTabCloseAll")){f=d.prev(".pageTab")}if(f.length==0){document.location.href="/"}d.remove();R9.Tabs.SearchTabs.setLastKnownTabsFromDocument();jq(".pageTabs .closeX").remove();window.setTimeout(function(){f.trigger("click")},50)}},changeCurrentTabUrl:function(f,h){var g=a(R9.Tabs.SearchTabs.prototype.options.tabsContainer);var b=g.find(".pageTab.selected");var d=b.data("taburl");b.attr("taburl",f).data("taburl",f);R9.Tabs.SearchTabs.setLastKnownTabsFromDocument();if(b.length>0&&b.data("permtabindex")!=-1&&R9.globals.formtoken){var c={oldTabUrl:d,newTabUrl:f,formtoken:R9.globals.formtoken};a.post("/s/run/tabs/replace",c,h)}},removeAllTabs:function(){a(R9.Tabs.SearchTabs.prototype.options.tabAreaSelector).empty();R9.Tabs.SearchTabs.clearLastKnownTabs();var b={formtoken:R9.globals.formtoken};a.post("/s/run/tabs/removeAll",b)},bindEvents:function(){a(".pageTabs .closeX").click(function(b){b.stopPropagation();R9.Tabs.SearchTabs.removeTab(this)});if(!a(".pageTab").hasClass("hoverable")){a(".pageTab .tabText").tipTip()}R9.Tabs.SearchTabs.adjustTabSizeToFitBar(false);a(window).resize(function(){R9.Tabs.SearchTabs.adjustTabSizeToFitBar(true)})}});R9.extend("Tabs.SearchTabs.prototype",{tabArea:null,options:{tabAreaSelector:".pageTabsOuter",tabsContainer:".pageTabs",closeAllTabsSelector:".pageTabCloseAll",message:"Loading results...",vsLoggingEnabled:true},selectNewTab:function(c){var b=a(c);R9.Analytics.api.trackEvent("tabclick/"+b.closest(".pageTab").data("tablogging"));if(!b.closest(".pageTab").hasClass("selected")){this.tabArea.find(".pageTab.selected").removeClass("selected");b.closest(".pageTab").addClass("selected").addClass("loading")}if(typeof Streaming!=="undefined"&&!Streaming.done){Streaming.reset();Streaming.stopClientTimeout()}}})})(jq||jQuery);(function(b,a){b.extend("UILogger",true,{log:function(j,k,h,f,d,g,c){a.ajax({url:"/r9/log/uilogger",data:{type:j,msg:k,url:h,line:f,evt:d,cstack:g},type:"GET",complete:function(){if(typeof c==="function"){c()}}})},cmp2:function(g,h,d,f,c){if(b.config.getBoolean("ui.cmp2.log",false)){a.ajax({url:"/s/compareresults/log",data:{type:g,msg:JSON.stringify(h),args:JSON.stringify(f),evt:d},type:"GET",complete:function(){if(typeof c==="function"){c()}}})}},lookup:function(g,d,c,f){g.replace(d,function(j,h,k){f+=c+h;return j});return f},logAjax:function(f,h,d,g,c){var k="Request Status Code="+(h&&h.status?h.status:"unknown")+" Status="+(d||"unknown")+" Error="+(g||"unknown");var j=h.responseText;if(j){k=this.lookup(j,/name="dt" value="([^"]*)">/g," ODT=",k);k=this.lookup(j,/name="cl" value="([^"]*)">/g," OCL=",k);k=this.lookup(j,/name="rc" value="([^"]*)">/g," OEN=",k)}if(window.searchid){k+=" SearchID="+window.searchid}this.log(f,k,location.href,null,null,null,c)},logTimeout:function(d,f,c){this.log(d,f,location.href,null,null,null,c)}})})(window.R9,window.jq||window.jQuery);(function(b){b.extend("CompareTo.Core.Config",{});b.globals;var a=b.CompareTo.Core.Config={getString:function(d,c){if(!b.globals||!b.globals.uiconfig||typeof b.globals.uiconfig[d]==="undefined"){return c}else{return b.globals.uiconfig[d]}},getBoolean:function(f,c){var d=a.getString(f,"");return d?"true"===d.toLowerCase():c}}})(window.R9);(function(c,b){c.extend("CompareTo.Core.Type.CheckBoxButtonGroup",{});var a=c.CompareTo.Core.Type.CheckBoxButtonGroup=function(d){this.container=b(d);this.init()};a.prototype={constructor:a,container:null,input:".input",init:function(){var d=this.input;this.container.on("click",d,function(){if(b(this).hasClass("checked")){b(this).removeClass("checked");b(this).trigger("change").trigger("deselect")}else{b(this).addClass("checked");b(this).trigger("change").trigger("select")}})}}})(window.R9,window.jq||window.jQuery);(function(c,b){c.extend("CompareTo.Core.Type.RadioButtonGroup",{});var a=c.CompareTo.Core.Type.RadioButtonGroup=function(d){this.container=b(d);this.init()};a.prototype={constructor:a,container:null,input:".input",selectedItem:{},init:function(){var f=this,d=f.input;this.container.on("click",d,function(){var g=b(this).data("name");if(g in f.selectedItem&&this!==f.selectedItem[g]){b(f.selectedItem[g]).removeClass("checked").trigger("change").trigger("deselect")}if(!b(this).hasClass("checked")){f.selectedItem[g]=this;b(this).addClass("checked");b(this).trigger("change").trigger("select")}else{if(c.CompareTo.Core.Config.getBoolean("cmp2.radio.buttons.allow.deselect",false)){c.Analytics.api.trackEvent("cmp2/radio/click/deselect");delete f.selectedItem[g];b(this).removeClass("checked");b(this).trigger("change").trigger("deselect")}}});this.container.on("repaint",function(){f.update()})},update:function(){var d=this;this.container.find(this.input).each(function(){var f=b(this).data("name");if(b(this).hasClass("checked")&&!d.selectedItem.hasOwnProperty(f)){d.selectedItem[f]=this}else{b(this).removeClass("checked")}})}}})(window.R9,window.jq||window.jQuery);(function(c,b){c.extend("CompareTo.Core.Event",{});var a=c.CompareTo.Core.Event={};var d={};a.publish=function(g,f){var h=d[g];if(typeof h==="undefined"){return}h.fire(f||[])};a.subscribe=function(g,f){var h=d[g];if(typeof h==="undefined"){d[g]=h=b.Callbacks("unique")}h.add(f)};a.unsubscribe=function(g,f){var h=d[g];if(typeof h==="undefined"){return}h.remove(f)}})(window.R9,window.jq||window.jQuery);(function(a){a.extend("CompareTo.Core.Inherit",{});if(typeof Object.create!=="function"){Object.create=function(c){function b(){}b.prototype=c;return new b()}}a.CompareTo.Core.Inherit=function(c,d){var b=Object.create(d.prototype);b.constructor=c;c.prototype=b}})(window.R9);(function(a){a.extend("CompareTo.Core.UUID",{});a.CompareTo.Core.UUID=function(){var c="xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx";var b=new window.Date();var f=b.getTime();return c.replace(/[xy]/g,function(g){var d=(f+Math.random()*16)%16|0;f=Math.floor(f/16);return(g==="x"?d:(d&3|8)).toString(16)})}})(window.R9);(function(d,c){d.extend("CompareTo.Core.Window",{});var f="/s/compareresults/spinner";var a=d.CompareTo.Core.Window=function(){};var b=function(){return{y:((typeof window.screenY==="undefined")?window.screenTop:window.screenY),x:((typeof window.screenX==="undefined")?window.screenLeft:window.screenX),width:c(window).width(),height:c(window).height(),screenWidth:window.screen.availWidth,screenHeight:window.screen.availHeight}};a.prototype={constructor:a,tiled:function(j,g,h){return{url:this.urlForProviderCode(j),name:j.code,features:this.featuresForTiled(g,h)}},hidden:function(g){return{url:this.urlForProviderCode(g),name:g.code,features:this.featuresForHidden()}},urlForProviderCode:function(g){if(typeof g.useDeepLink!=="undefined"&&g.useDeepLink===true&&typeof g.deepLink!=="undefined"){return g.deepLink}var h="";if(g.verticalName){h="&vertical="+g.verticalName}return f+"?code="+encodeURIComponent(g.code)+h},featuresForHidden:function(h){var m=b();var g=Math.min(1024,(m.height-20));var j=Math.min(1280,(m.width-20));var l=m.y+10;var k=m.x+10;if(h){g=160;j=160;l=m.y+(m.height-110);k=m.x+(m.width-185)}return{scrollbars:1,location:1,statusbar:1,menubar:0,resizable:1,top:l,left:k,height:g,width:j}},featuresForTiled:function(h,k){var l=b(),j=Math.floor(l.screenWidth/k)-5,g=l.screenHeight;return{scrollbars:1,location:1,statusbar:1,menubar:0,resizable:1,top:0,left:(j+5)*h,height:g,width:j,index:h,total:k}},open:function(j,h,g,k){if(typeof g==="object"){g=this.objectToFeatureString(g)}return window.open(j,this.getWindowName(h),g,k)},getWindowName:function(g){return g.replace(/[^a-z0-9]+/gi,"")},objectToFeatureString:function(j){var h=[];for(var g in j){if(j.hasOwnProperty(g)){h.push(g+"="+j[g])}}return h.join(",")},features:function(j){var h={top:j.top===true||false,bottom:j.bottom===true||false,left:j.left===true||false,right:j.right===true||false,width:j.width||250,height:j.height||150},g=h.height,k=h.width,n=0,m=0,l=b();if(h.bottom){n+=(h.top?0:l.height)}if(h.right){m+=(h.left?0:l.width)}n+=h.top?10:-g;m+=h.right?-k:10;if(h.left&&h.right){k=l.width-20;m=10}if(h.top&&h.bottom){g=l.height+40;n=10}return{scrollbars:1,location:1,statusbar:1,menubar:0,resizable:1,top:l.y+n,left:l.x+m,height:g,width:k}}}})(window.R9,window.jq||window.jQuery);(function(g,f){var h=[];var d=["flights","hotels","cars","packages","packagetours"];var c=function c(){if(h.length===0){return}var j=h[0];f.ajax({type:"POST",url:"/k/cookie",data:{action:"setmeta",metacookie:j.name,metavalue:j.value,formtoken:g.globals.formtoken},complete:function(){h.shift();c()},success:function(){j.callback()}})};var b=g.CompareTo.Core.Requests=function a(){};b.prototype={constructor:b,lastRequestString:null,xhr:null,cleanUp:function(){this.lastRequestString=null},loadItems:function(k,l){if(g.CompareTo.Core.Config.getBoolean("ui.cmp2.reduce.request",true)&&this.lastRequestString===f.param(k)){return}if(this.xhr&&this.xhr.readyState!==4){this.xhr.abort()}if(f.inArray(k.vertical,d)===-1){if(typeof l==="function"){l(null)}return}var j=f.extend(true,{},k);this.lastRequestString=f.param(k);if(g.CompareTo.Core.Config.getBoolean("ui.cmp2.reduce.request.data",true)){j=this.sanitizeParams(k)}else{switch(k.vertical){case"flights":case"hotels":case"cars":case"packagetours":j.ptype=k.vertical;break;case"packages":j.ptype="packagetours";break}}this.xhr=f.ajax({type:"GET",url:"/s/cmp2chk/items",data:j}).done(function(m){if(typeof l==="function"){l(m)}}).fail(function(){if(typeof l==="function"){l(null)}})},sanitizeParams:function(k){var j={ptype:k.vertical,show_on:k.show_on,page_origin:k.page_origin};switch(k.vertical){case"flights":this.putValues(k,j,["origin","origincode","destination","destcode","cabin","depart_date","return_date","student","travelers","oneway"]);break;case"hotels":this.putValues(k,j,["checkin_date","checkout_date","location","othercity","citycode","rooms","guests","lmid","nhid"]);break;case"cars":this.putValues(k,j,["pickup_date","dropoff_date","location","location1","citycode1","location2","citycode2","pickup_hour","dropoff_hour","oneway"]);break;case"packages":case"packagetours":j.ptype="packagetours";this.putValues(k,j,["depart_date","return_date","origincode","destcode","pt_geo_id"]);break}return j},putValues:function(l,k,j){f.each(j,function(n,m){if(l.hasOwnProperty(m)){k[m]=l[m]}})},saveItemState:function(j,k){h.push({name:g.CompareTo.Core.Config.getString("ui.cmp2.prefix","")+j.item.code,value:j.item.checked?"true":"false",callback:k||f.noop});if(h.length===1){c()}}}})(window.R9,window.jq||window.jQuery);(function(f,d){var c=[];var a=f.CompareTo.Core.Event;f.extend("CompareTo.Core.Items",{});var b=f.CompareTo.Core.Items=function(j,h){this.options=d.extend(true,this.options,h);if(typeof j==="string"){this.element=d("#"+j)}else{if(typeof j==="object"){this.element=d(j)}}var g=this.element.find(this.options.itemsBlock);if(g.length===1){this.itemsElement=g}this._id=f.CompareTo.Core.UUID();this.init();this.addEventHandlers()};b.prototype={constructor:b,element:d([]),itemsElement:d([]),_id:null,options:{limited:true,keepCheckboxState:true,radioButtons:false,showCheckAllWhenItemsCount:3,workaround:"Core",template:{none:'<span class="span-button-wrapper"><span class="input" data-name="{name}">&nbsp;</span></span>',checked:'<span class="span-button-wrapper"><span class="input checked" data-name="{name}" data-code="{code}">{label}</span></span>',unChecked:'<span class="span-button-wrapper"><span class="input" data-name="{name}" data-code="{code}">{label}</span></span>'},itemsBlock:".items",source:"",pageOrigin:""},requests:null,requestData:[],init:function(){var k=this.id(),h=this.options,g=h.workaround;h.radioButtons=this.element.hasClass("radio");if(h.radioButtons){h.limited=true}this.bindEvents();this.element.addClass("compareToHidden");this.requests=new f.CompareTo.Core.Requests();var j=function(l,m){if(typeof f.CompareTo.Core.Workaround[l]!=="undefined"){return new f.CompareTo.Core.Workaround[l](k,m)}else{return new f.CompareTo.Core.Workaround.Core(k,d.extend({},{resetEvents:true},m))}};j(g,h)},id:function(){return this._id},getPublishData:function(g){return d.extend({},{_cmp2id:this.id()},g)},addEventHandlers:function(){var g=this;a.subscribe("cmp2.getItems",function(h){if(!g.shouldUpdate(h)){return}g.getItems(h)});a.subscribe("cmp2.cleanUp",function(h){if(!g.shouldUpdate(h)){return}g.displayBlock(0);g.requests.cleanUp()});a.subscribe("cmp2.submit",function(k){if(!g.shouldUpdate(k)){return}k.displayItems=g.getDisplayItems();k.checkedItems=g.getCheckedItems();var h=g.getRequestData()||[],j=g.getDisplayItemsMap();d.each(h,function(l,m){if(typeof j[m.code]!=="undefined"){m.checked=j[m.code].checked}});g.setCookie(h);a.publish("cmp2.event.submit",g.getPublishData(k))})},setCookie:function(o){var j=o.length||0,r=this.options.pageOrigin,t=new window.Date(),g=t.getTime(),n=[],p="compareTos"+r.charAt(0).toUpperCase(),h,m={c2s:null,origin:r,src:this.options.source};for(var q=0;q<j;q++){var s=o[q],k=[],l;k.push(s.id);l=this.createBinaryMask(s.prechecked,s.termId!=="-1",s.visible,s.checked);k.push(l.toString(16));k.push(s.rank);n.push(k.join("|"))}m.c2s=n.join(";");t.setTime(g+60000);h=encodeURIComponent(decodeURIComponent(JSON.stringify(m)));document.cookie=p+"="+h+"; expires="+t.toUTCString()+"; path=/"},createBinaryMask:function(){var j=0,h=0,g=arguments.length>32?32:arguments.length;for(h;h<g;h++){j|=arguments[h]<<h}return j},bindEvents:function(){var k=this,h=this.element,j=this.options.radioButtons;var l=function(m){if(j){return new f.CompareTo.Core.Type.RadioButtonGroup(m)}else{return new f.CompareTo.Core.Type.CheckBoxButtonGroup(m)}};l(h);var g=".input";h.on("change",g,function(){k.changeItemState(this);var m=k.getPublishData({item:this,data:k.getItemData(this)});a.publish("cmp2.event.change",m)}).on("click mousedown mouseup deselect select",g,function(m){var n=k.getPublishData({item:this,data:k.getItemData(this)});a.publish("cmp2.event."+m.type,n)});h.on("click",".CompareTo-Controls .control, #compareALL .fauxlink",function(){var m=d(this).hasClass("check-all");h.find(g).each(function(){var n=k.getItemData(this);if(n.checked!==m){d(this).trigger("click")}})})},changeItemState:function(g){var h=this.getItemData(g);if(this.options.keepCheckboxState){c[h.code]=h.checked}this.requests.saveItemState({item:h})},getItemData:function(g){d(g).data("data").checked=d(g).hasClass("checked");return d(g).data("data")},shouldUpdate:function(g){var h=this.id();if(h!==null&&typeof h!=="undefined"){return h.indexOf(g._cmp2id)>-1}return false},getItems:function(h){var g=this;this.requests.loadItems(h,function(j){if(j!==null&&j.success){var k=j.compareTos;var l=g.getPublishData({items:k});a.publish("cmp2.rendering.prepare",l);g.setRequestData(l.items);g.printItems(l.items)}else{g.printItems([])}})},printItems:function(g){var l=this,k=0,j=[],h=l.itemsElement,m=l.getPublishData({items:g});a.publish("cmp2.rendering.start",m);h.empty();d.each(g,function(o,q){if(q.visible){var p=l.getItemDom(q);var n=l.getPublishData({item:q,itemDom:p});j.push(n.itemDom);a.publish("cmp2.rendering.item",n);h.append(n.itemDom);k+=1}});this.displayBlock(k);if(this.options.radioButtons){if(f.CompareTo.Core.Config.getBoolean("cmp2.radio.button.add.none",true)){h.append(l.getItemDom({name:"",code:"",visible:false,checked:false,none:true}))}this.element.trigger("repaint")}m.domItems=j;a.publish("cmp2.rendering.finished",l.getPublishData(m))},displayBlock:function(k){var h=this,g=this.options;if(k>0){var j={showControls:g.radioButtons===false&&g.showCheckAllWhenItemsCount<=k};j=h.getPublishData(j);a.publish("cmp2.rendering.controls",j);if(j.showControls){h.element.find(".CompareTo-Controls").show()}else{h.element.find(".CompareTo-Controls").hide()}this.element.removeClass("compareToHidden")}else{this.element.addClass("compareToHidden")}},getItemDom:function(m){var j,n,g=this.options,h=g.template,l=h.unChecked,k={name:"cmp2-item",label:m.name,code:m.code,checked:m.checked};if(g.keepCheckboxState&&typeof c[m.code]!=="undefined"){if(c[m.code]===true){k.checked=c[m.code]}}if(k.checked){l=h.checked}if(m.none){l=h.none||""}j=l.replace(/(\{label}|\{name}|\{code})/gi,function(o){var q=o.substr(1,o.length-2),p=k[q];if(typeof p!=="undefined"){return p}return""});n=d(j);n.find(".input").data("data",d.extend({},m));return n},setRequestData:function(g){this.requestData=g},getRequestData:function(){return this.requestData},getDisplayItems:function(){var h=this,g=[];this.element.find(".input").each(function(){var j=h.getItemData(this);if(j&&j.visible){g.push(j)}});return g},getDisplayItemsMap:function(){var h=this,g={};this.element.find(".input").each(function(){var j=h.getItemData(this);if(j&&j.visible){g[j.code]=j}});return g},getCheckedItems:function(){var h=this;var g=[];this.element.find(".input.checked").each(function(){var j=h.getItemData(this);if(j&&j.visible){g.push(j)}});return g}}})(window.R9,window.jq||window.jQuery);(function(c,b){c.extend("CompareTo.Core.ResultPage",{});var a=c.CompareTo.Core.ResultPage=function(d){this.options=b.extend({},this.options,d);this.init()};a.prototype={constructor:a,options:{items:[],workaround:"Core",pageOrigin:"",searchId:""},workaround:null,init:function(){var f=this,g=f.options,d=g.items,h=g.workaround;if(typeof c.CompareTo.Core.Workaround[h]!=="undefined"){this.workaround=new c.CompareTo.Core.Workaround[h](null,g)}else{this.workaround=new c.CompareTo.Core.Workaround.Core(null,g)}this.open({compareTos:d,pageOrigin:g.pageOrigin,searchId:g.searchId})},open:function(f){var d=this.workaround;if(d&&d instanceof c.CompareTo.Core.Workaround.Core){d.onResultPageOpen(f)}},ajaxOpen:function(f){var d=this;b.ajax({type:"GET",url:"/s/cmp2chk/open",data:f}).done(function(g){d.open(g)})}}})(window.R9,window.jq||window.jQuery);(function(f,d){var c={};var a=f.CompareTo.Core.Event;f.extend("CompareTo.Core.Workaround.Core",{});var b=f.CompareTo.Core.Workaround.Core=function(h,g){this.options=d.extend({},this.options,g);this._id=h;this.window=new f.CompareTo.Core.Window(h,g);if(!this.options.ignoreEventHandlers){this.addEventHandlers()}};b.prototype={constructor:b,options:{limited:true,maxCheckedItems:1,maxPreCheckItems:2,usePreCheckItems:true,radioButtons:false,showCheckAllWhenItemsCount:3,resetEvents:false,ignoreEventHandlers:false,pageOrigin:"",searchId:""},window:null,adjustPosition:{top:0,left:0},id:function(){return this._id},resetEvents:function(){a.unsubscribe("cmp2.event.change");a.unsubscribe("cmp2.event.click");a.unsubscribe("cmp2.event.mousedown");a.unsubscribe("cmp2.event.mouseup");a.unsubscribe("cmp2.event.deselect");a.unsubscribe("cmp2.event.select");a.unsubscribe("cmp2.event.submit");a.unsubscribe("cmp2.event.result.page.open");a.unsubscribe("cmp2.rendering.prepare");a.unsubscribe("cmp2.rendering.start");a.unsubscribe("cmp2.rendering.item");a.unsubscribe("cmp2.rendering.finished")},addEventHandlers:function(){var g=this;if(this.options.resetEvents){this.resetEvents()}a.subscribe("cmp2.event.change",function(h){if(!g.shouldUpdate(h)){return}g.onChange(h)});a.subscribe("cmp2.event.click",function(h){if(!g.shouldUpdate(h)){return}g.onClick(h)});a.subscribe("cmp2.event.mousedown",function(h){if(!g.shouldUpdate(h)){return}g.onMouseDown(h)});a.subscribe("cmp2.event.mouseup",function(h){if(!g.shouldUpdate(h)){return}g.onMouseUp(h)});a.subscribe("cmp2.event.deselect",function(h){if(!g.shouldUpdate(h)){return}g.onDeselect(h)});a.subscribe("cmp2.event.select",function(h){if(!g.shouldUpdate(h)){return}g.onSelect(h)});a.subscribe("cmp2.event.submit",function(h){if(!g.shouldUpdate(h)){return}g.onSubmit(h)});a.subscribe("cmp2.rendering.prepare",function(h){if(!g.shouldUpdate(h)){return}g.onPrepareRendering(h)});a.subscribe("cmp2.event.result.page.open",function(h){if(!g.shouldUpdate(h)){return}this.onResultPageOpen(h)});a.subscribe("cmp2.rendering.controls",function(h){if(!g.shouldUpdate(h)){return}g.onShowControls(h)});a.subscribe("cmp2.rendering.start",function(h){if(!g.shouldUpdate(h)){return}g.onRenderingStart(h)});a.subscribe("cmp2.rendering.item",function(h){if(!g.shouldUpdate(h)){return}g.onRenderingItem(h)});a.subscribe("cmp2.rendering.finished",function(h){if(!g.shouldUpdate(h)){return}g.onRenderingFinish(h)})},shouldUpdate:function(g){var h=this.id();if(h!==null&&typeof h!=="undefined"){return h.indexOf(g._cmp2id)>-1}return false},onChange:function(g){},onClick:function(g){},onMouseDown:function(g){},onMouseUp:function(g){},onDeselect:function(g){},onSelect:function(g){},onPrepareRendering:function(h){var p=this.options,m=0,n=0,k=Math.min(p.maxCheckedItems,p.maxPreCheckItems),l=h.items;for(var j=0;j<l.length;j+=1){var o=l[j];if(o.visible){var g=o.checked;if(p.limited&&!o.checked&&o.prechecked){if(n>=k){o.prechecked=false}n+=1}if(!g){g=o.prechecked&&p.usePreCheckItems}o.checked=g;if(g){m++}if(p.limited&&m>p.maxCheckedItems){o.checked=false}}}},onShowControls:function(g){if(this.options.limited){g.showControls=false}},onRenderingStart:function(g){},onRenderingItem:function(g){},onResultPageOpen:function(l){var j=this,h=l.compareTos||[],g=[],k=0;if(typeof l.preOpen==="function"){l.preOpen.call(this,l)}d.each(h,function(m,o){try{if(o.deepLink==="CLOSE"){var n=j.window.open("",o.code);n.close()}else{k+=1;g.push(o)}}catch(p){}});d.each(g,function(m,o){try{var q={name:o.code,url:o.deepLink,features:j.window.featuresForTiled(m,k)};if(typeof l.preOpenItem==="function"){l.preOpenItem.call(this,q,l)}var n=j.window.open("",q.name,q.features);j.addHandle(q.name,n);j.tilingWindow(q);n.location.href=q.url;if(typeof l.postOpenItem==="function"){l.postOpenItem.call(this,q,n,l)}}catch(p){}});if(typeof l.postOpen==="function"){l.postOpen.call(this,l)}},onSubmit:function(g){if(typeof g==="undefined"){throw"Need specify data parameter for submit event"}if(g.displayItems){delete g.displayItems}if(g.checkedItems){delete g.checkedItems}a.publish("form.submit",g)},onRenderingFinish:function(g){},addHandle:function(g,h){c[g]=h},getHandle:function(g){try{var h=c[g];if(!h||h.closed){return null}return h}catch(j){return null}},tilingWindow:function(l){var j=this.getHandle(l.name);var g=l.features;if(typeof g==="undefined"||!j){return}if(typeof g.width!=="undefined"&&typeof g.height!=="undefined"){try{j.resizeTo(100,100)}catch(k){}}if(typeof g.left!=="undefined"&&typeof g.top!=="undefined"){try{if(g.top===0&&g.left===0){var h=-10000000;j.moveTo(h,h);this.adjustPosition.left="screenX" in j?j.screenX:j.screenLeft;this.adjustPosition.top="screenY" in j?j.screenY:j.screenTop}j.moveTo(this.adjustPosition.left+g.left,this.adjustPosition.top+g.top)}catch(k){}}if(typeof g.width!=="undefined"&&typeof g.height!=="undefined"){try{j.resizeTo(parseInt(g.width),parseInt(g.height))}catch(k){}}}}})(window.R9,window.jq||window.jQuery);(function(c,b){c.extend("CompareTo.Core.Workaround.ChangeWindowName",{});var d=c.CompareTo.Core.Workaround.Core;var a=c.CompareTo.Core.Workaround.ChangeWindowName=function(g,f){d.prototype.constructor.call(this,g,f)};c.CompareTo.Core.Inherit(a,d);b.extend(a.prototype,{onResultPageOpen:function(g){var f=c.CompareTo.Core.UUID(),h=this.window;window.name=f;g.postOpenItem=function(){h.open("",f,"")};g.postOpen=function(){h.open("",f,"")};d.prototype.onResultPageOpen.call(this,g)},onSubmit:function(g){var f=c.CompareTo.Core.UUID(),h=this.window;window.name=f;b.each(g.checkedItems,function(j,k){var l=h.hidden(k);h.open(l.url,l.name,l.features);h.open("",f,"")});d.prototype.onSubmit.call(this,g)}})})(window.R9,window.jq||window.jQuery);(function(c,b){c.extend("CompareTo.Core.Workaround.DocumentFocus",{});var d=c.CompareTo.Core.Workaround.Core;var a=c.CompareTo.Core.Workaround.DocumentFocus=function(g,f){d.prototype.constructor.call(this,g,f)};c.CompareTo.Core.Inherit(a,d);b.extend(a.prototype,{onSelect:function(j){var m=this.window,g=this;try{var f=j.data;var l=m.hidden(f);l.features=m.features({bottom:true});var h=m.open(l.url,l.name,l.features);this.addHandle(l.name,h);g.windowFocus(h)}catch(k){}},onDeselect:function(h){try{var f=h.data,g=this.getHandle(f.code);if(g){g.close()}}catch(j){}},windowFocus:function(f){try{if(f){f.blur();f.opener.focus()}window.self.focus();window.focus();document.focus()}catch(g){}},onSubmit:function(h){var g=this,j=this.window;var f=0;b.each(h.checkedItems,function(k,l){try{var o=j.hidden(l);o.features=j.features({bottom:true});var m=j.open(o.url,o.name,o.features);g.addHandle(o.name,m);g.windowFocus(m)}catch(n){}f++});d.prototype.onSubmit.call(this,h)}})})(window.R9,window.jq||window.jQuery);(function(c,b){c.extend("CompareTo.Core.Workaround.SelfTarget",{});var d=c.CompareTo.Core.Workaround.Core;var a=c.CompareTo.Core.Workaround.SelfTarget=function(g,f){d.prototype.constructor.call(this,g,f)};c.CompareTo.Core.Inherit(a,d);b.extend(a.prototype,{onSubmit:function(g){var h=this.window;var f=window.open("","_self");b.each(g.checkedItems,function(j,k){var l=h.hidden(k);h.open(l.url,l.name,l.features);f.focus()});d.prototype.onSubmit.call(this,g)}})})(window.R9,window.jq||window.jQuery);(function(c,b){c.extend("CompareTo.Core.Workaround.Simple",{});var d=c.CompareTo.Core.Workaround.Core;var a=c.CompareTo.Core.Workaround.Simple=function(g,f){d.prototype.constructor.call(this,g,f)};c.CompareTo.Core.Inherit(a,d);b.extend(a.prototype,{onSubmit:function(h){var g=h.checkedItems.length;var j=this.window;var f=window.open("","_self");b.each(h.checkedItems,function(k,l){var o=j.tiled(l,k,g);var m=j.open(o.url,o.name,o.features);try{m.blur();window.focus()}catch(n){}});d.prototype.onSubmit.call(this,h)}})})(window.R9,window.jq||window.jQuery);(function(c,b){c.extend("CompareTo.Core.Workaround.Swapper",{});var d=c.CompareTo.Core.Workaround.Core;var a=c.CompareTo.Core.Workaround.Swapper=function(g,f){d.prototype.constructor.call(this,g,f)};c.CompareTo.Core.Inherit(a,d);b.extend(a.prototype,{onResultPageOpen:function(j){if(window.opener){var g=j.compareTos||[],f=[];b.each(g,function(k,l){f.push(l.code)});if(f.length>0){var h="/s/compareresults/multi?searchId="+j.searchId+"&pageOrigin="+j.pageOrigin;h+="&forcehttp&providerCodes="+f.join(",");if(window.opener&&!window.opener.closed){window.opener.location.replace(h)}}}},onSubmit:function(g){if(g.checkedItems.length===0){d.prototype.onSubmit.call(this,g);return}var j=window.location.href;var f=window.open("","_blank");if(f){try{f.history.replaceState({},"fd",j);f.history.pushState({},"fd",j)}catch(h){}setTimeout(function(){f.location.href="/"+g.url.replace(/(^[\/#]*|[\/#]*$)/g,"");window.location.href="/s/compareresults/spinner"},100)}}})})(window.R9,window.jq||window.jQuery);(function(c,b,a){c.extend("CompareTo",{Controller:function(d,g,f){var h=this;h.view=d;h.model=g;h.opener=new c.CompareTo.Window.Opener();h.options=b.extend.apply(this,[{},h.options,f||{}]);if(typeof h.view.setUniqueId==="function"){var j=h.getUniqueId();h.view.setUniqueId(j);c.CompareTo.Controller.set(j,h)}h.init()},bindEvents:function(f){var d=b(f).find("[name=tab]");switch(d.val()){case"flights":case"hotels":case"cars":case"packagetours":break;default:throw Error("not implemented")}},getController:function(d){var f=c.CompareTo.View.getUniqueId(d);return c.CompareTo.Controller.get(f)},isBehaviorOfVertical:function(d){return b.inArray(d,["flights","hotels","cars","packagetours"])>-1}});c.extend("CompareTo.Controller",{retryCountGenerateUniqueId:3,instanceList:{},get:function(d){return c.CompareTo.Controller.instanceList[d]},set:function(f,d){c.CompareTo.Controller.instanceList[f]=d}});c.extend("CompareTo.Controller.prototype",{options:{limited:true,maxCheckedItems:1,usePreCheckItems:true,reserveWindows:false,delayedChange:false},view:null,model:null,workaround:null,init:function(){var j=this,d=j.view,h=j.model,f=new c.CompareTo.Window.Information();if(c.config.getBoolean("ui.cmp2.code.refactor",false)){if(d instanceof c.CompareTo.View.Core){j.adjustOptions();var g=b("#CMP2ItemTemplateNone",this.view.canvas);this.workaround=new c.CompareTo.CoreWorkaroundUsage(b(this.view.options.compareToRow,this.view.canvas),b.extend({},{workaround:a.getString("workaround","Core"),itemsBlock:".compareToCheckboxes",limited:j.options.limited,template:{none:(g.length>0)?g.get(0).text:undefined}},this.options));d.adjustOptionsAccordingPage();d.adjustDynamicOptions();d.adjustPageOrigin()}}else{if(d instanceof c.CompareTo.View.Core){f.setVerticalName(d.getVerticalName());d.on(d.events.optionsChanged,function(){j.reInitOptions()});d.on(d.events.openAllWindows,function(l){var m,k=[],n=l.length;for(m=0;m<n;m+=1){k.push(f.collectTiledWindowInformation(l[m],m,n))}j.launchOpening(k)});d.on(d.events.openOneWindow,function(k){j.launchOpening([f.collectHiddenWindowInformation(k)])});d.on(d.events.saveItemState,function(k){h.saveCheckedItem(k.code,k.checked,b.noop)})}if(d instanceof c.CompareTo.View.RightRails){d.on(d.events.openAllWindows,function(k){var l,m=k.length;for(l=0;l<m;l+=1){k[l].features=f.featuresForTiledWindow(l,m)}j.launchOpening(k)})}d.init();j.adjustOptions()}},changePageOrigin:function(f){this.view.adjustPageOrigin(f);if(this.options.reserveWindows&&typeof f==="object"&&f.page1){if(f.page1==="FD"||f.page1==="RP"){var d=new c.CompareTo.Helper.ReserveWindow();d.setResultPageBehaviour(f.page1==="RP")}}},setShowOnFrontDoor:function(){this.view.setShowOnFrontDoor();if(this.options.reserveWindows){var d=new c.CompareTo.Helper.ReserveWindow();d.setResultPageBehaviour(false)}},setShowOnResult:function(){this.view.setShowOnResult();if(this.options.reserveWindows){var d=new c.CompareTo.Helper.ReserveWindow();d.setResultPageBehaviour(true)}},reInitOptions:function(){var f=this,d=f.view;d.removeBinds();d.adjustDynamicOptions();f.adjustOptions();f.refresh()},adjustOptions:function(){var f=this,d=f.options;d.usePreCheckItems=c.config.getBoolean("ui.cmp2.forceUsePreCheckItems",d.usePreCheckItems);d.maxCheckedItems=(window.BrowserConfig)?a.getNumber("maxCheckedItems",d.maxCheckedItems):d.maxCheckedItems;d.limited=(window.BrowserConfig)?a.getBoolean("limited",d.limited):d.limited;d.reserveWindows=(window.BrowserConfig)?a.getBoolean("reserveWindows",d.reserveWindows):d.reserveWindows;d.delayedChange=(window.BrowserConfig)?a.getBoolean("delayedChange",d.delayedChange):d.delayedChange},refresh:function(){var j=this,h=j.model,d=j.view,g=a.getBoolean("cmp2.enabled",true);if(c.config.getBoolean("ui.cmp2.code.refactor",false)){if(g&&d.isEnoughInformationForRequest()&&d.isVisible()){this.workaround.getItems(d.getFormArgs());this.workaround.setPageOrigin(d.getPageOrigin())}else{this.workaround.cleanUp()}}else{if(g&&d.isEnoughInformationForRequest()&&d.isVisible()){var f=d.getFormArgs();h.loadItems(f,b.proxy(function(k){if(k.success){var l=j.prepareCompareToItems(k.compareTos);d.printItems(l)}else{if(c.config.getBoolean("ui.cmp2.log",false)){c.UILogger.cmp2("cmp2",k.errors,k.type,f)}d.emptyBlock();h.cleanUp()}},j))}else{d.emptyBlock();h.cleanUp()}}},onSubmit:function(d,f){this.workaround.onSubmit(d,f)},prepareCompareToItems:function(l){var j=this,q=j.options,m=[],o=0,h,p,d,n=0,k=q.limited||c.config.getBoolean("ui.cmp2.limitPreChecks",false),f=c.config.getInt("ui.cmp2.maxPreChecks",2),g=q.limited?Math.min(q.maxCheckedItems,f):f;for(h=0;h<l.length;h+=1){p=l[h];if(p.visible){if(k){if(!p.checked&&p.prechecked){if(n>=g){p.prechecked=false}n+=1}}d=p.checked;if(!d){d=p.prechecked&&q.usePreCheckItems}if(j.options.reserveWindows&&!d){d=p.prechecked=true;n+=1}p.checked=d;o+=Number(d);if(q.limited&&o>q.maxCheckedItems){p.checked=false}}m.push(p)}return m},getCookieValue:function(){if(c.config.getBoolean("ui.cmp2.code.refactor",false)){return""}else{this.view.startSearch();var g=this.view.collectCheckedItemsData(),h,j,f=[],k,d;for(h=0;h<g.length;h+=1){j=g[h];f.push(j.code)}k=f.join(",");if(this.options.reserveWindows){d=new c.CompareTo.Helper.ReserveWindow();if(!this.options.delayedChange){d.changeWindowNames(f)}else{d.popup()}}return k}},disableOpening:function(d){this.view.setDisabled(d)},launchOpening:function(d){this.opener.open(d)},getUniqueId:function(){var g=this,d=c.CompareTo.Controller,h=null,f;for(f=0;f<d.retryCountGenerateUniqueId;f++){h=g.normalizeObjectName(g.randomString());if(typeof d.instanceList[h]==="undefined"){break}}return h},normalizeObjectName:function(d){return d.replace(new RegExp("[^a-zA-Z0-9]+","gi"),"")},randomString:function(d){var f=d||10,j="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",g="",k,h;for(h=0;h<f;h++){k=Math.floor(Math.random()*j.length);g+=j.substring(k,k+1)}return g},focusKayakWindow:function(f){var d=this.view.kayakWindowName;if(typeof d!=="undefined"&&d!==""){window.open(f,d);var g=window.open("","_self","");g.close()}}})})(window.R9,window.jq||window.jQuery,window.BrowserConfig);(function(c,b,d,a){c.extend("CompareTo",{Model:function(){}});c.extend("CompareTo.Model.prototype",{lastRequestString:null,xhr:null,cleanUp:function(){this.lastRequestString=null},loadItems:function(f,g){if(a.getBoolean("ui.cmp2.reduce.request",true)&&this.lastRequestString===b.param(f)){return}if(this.xhr&&this.xhr.readystate!==4){this.xhr.abort()}this.lastRequestString=b.param(f);this.xhr=b.ajax({type:"GET",url:"/s/cmp2chk/items",data:f,traditional:true,contentType:"application/json;charset=UTF-8"}).done(function(h,j){h.type=j;g(h)}).fail(function(j,l,k){if(l!=="abort"){var h={success:false,type:l,errors:"ajax call failed: "+k};g(h)}})},saveCheckedItem:function(f,h,j){var g=a.getString("ui.cmp2.prefix","");d(g+f,h,j)}})})(window.R9,window.jq||window.jQuery,window.setMetaCookie,window.R9.config);(function(c,a,b){c.extend("CompareTo.Helper",{ReserveWindow:function(){var d=c.CompareTo.Helper.ReserveWindow.prototype;if(d._singletonInstance){return d._singletonInstance}d._singletonInstance=this;this.emitter=new c.Common.Emitter(this);this._init();return this}});c.extend("CompareTo.Helper.ReserveWindow",{close:function(f){var d=c.CompareTo.Helper.ReserveWindow.prototype._singletonInstance;if(d){d.close(f)}},open:function(f){var d=c.CompareTo.Helper.ReserveWindow.prototype._singletonInstance;if(d){d.open(f)}},checkExistence:function(f){var d=c.CompareTo.Helper.ReserveWindow.prototype._singletonInstance;if(d){d.checkExistence(f)}}});c.extend("CompareTo.Helper.ReserveWindow.prototype",{constructor:c.CompareTo.Helper.ReserveWindow,_singletonInstance:null,_retryCountGenerateUniqueId:3,_collectionUniqueId:{},events:{openWindow:"openWindow"},options:{windowQueue:false,eventSelector:".fdSearchForm, .get_rates_popover_cont, .resultsContent, .overlayContainer",useSelectActions:true},maxCount:5,windowQueue:null,isResultPageBehaviour:true,addedNewHandle:false,checkHandlesTimer:null,_init:function(){var d=this.options;d.windowQueue=(a)?a.getBoolean("windowQueue",d.windowQueue):d.windowQueue;d.useSelectActions=(a)?a.getBoolean("useSelectActions",d.useSelectActions):d.useSelectActions;d.eventSelector=(a)?a.getString("eventSelector",d.eventSelector):d.eventSelector;this.opener=new c.CompareTo.Window.Opener();this._bindEvents();this.windowQueue=new c.CompareTo.Helper.WindowQueue()},_bindEvents:function(){var f=this,d=this.options;b(d.eventSelector).off("click.ReserveWindow").on("click.ReserveWindow",function(h){var g=true;g=g&&!b("label").is(h.target)&&!b("label span").is(h.target);g=g&&!b("button[type=submit]").is(h.target)&&!b("button[type=submit] span").is(h.target);if(!d.useSelectActions){g=g&&!b("select").is(h.target);g=g&&!b("option").is(h.target)}if(!g){return}if(d.windowQueue&&f.isResultPageBehaviour){g=!f.windowQueue.dequeue()}if(!f.isResultPageBehaviour&&g&&Object.keys(f._collectionUniqueId).length<f.maxCount){f.popup()}})},popup:function(){if(Object.keys(this._collectionUniqueId).length<this.maxCount){var f=this._getUniqueId(),d={code:f};this.emitter.emit(this.events.openWindow,[d]);this._collectionUniqueId[this.opener.getCustomWindowName(f)]=null}},checkHandlersChange:function(d){if(!this.checkHandlesTimer){this.checkHandlesTimer=setInterval(b.proxy(function(){if(Object.keys(this._collectionUniqueId).length!==0&&!this.addedNewHandle){b.each(this._collectionUniqueId,b.proxy(function(f,g){this.windowQueue.dequeue(g)},this));clearTimeout(this.checkHandlesTimer)}else{this.addedNewHandle=false}},this),d)}},setResultPageBehaviour:function(d){this.isResultPageBehaviour=d;if(!d&&this.options.windowQueue){this.windowQueue.cleanQueue()}},setMaxCount:function(d){this.maxCount=d},_getUniqueId:function(){var g=null,f,d;for(d=0;d<this._retryCountGenerateUniqueId;d++){g=this._normalizeWindowName(this._randomString());f=this._collectionUniqueId[g];if(typeof f==="undefined"){break}}return g},_resumeStopWindowsChecking:function(h){if(b.inArray(h,["stop","resume"])){var d,f,g=this._collectionUniqueId;for(d in g){if(g.hasOwnProperty(d)){f=g[d];if(!f||f.closed){delete g[d];continue}if(h==="resume"){f.resume()}if(h==="stop"){f.stop()}}}}},_stopCheckingWindows:function(){this._resumeStopWindowsChecking("stop")},_continueCheckingWindows:function(){this._resumeStopWindowsChecking("resume")},_normalizeWindowName:function(d){return d.replace(new RegExp("[^a-zA-Z0-9]+","gi"),"")},_randomString:function(d){var f=d||10,j="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",h="",k,g;for(g=0;g<f;g++){k=Math.floor(Math.random()*j.length);h+=j.substring(k,k+1)}return h},open:function(f){var d=f.name;this._collectionUniqueId[d]=f;this.addedNewHandle=true},close:function(f){var g=this._collectionUniqueId,d;for(d in g){if(f.name.indexOf(d,0)>-1&&g.hasOwnProperty(d)){this.opener.removeOpenedWindow(d);delete g[d]}}},checkExistence:function(f){var d=f.name;if(!this._collectionUniqueId.hasOwnProperty(d)){this.open(f)}},changeWindowNames:function(k){var n=typeof k!=="undefined"?k.length:0,j=typeof k!=="undefined"?k.slice(0):[],m,d,h,l=false,g,f=[];this._stopCheckingWindows();for(h=0;h<n;h++){m=j[h];d=this.opener.getCustomWindowName(m);if(this.opener.isOpenedWindow(d)){continue}g=this._changeWindowName(m,j);if(!g&&!l){this.emitter.emit(this.events.openWindow,[{code:m}]);l=true}else{if(!g&&l){f.push(m)}}}if(this.options.windowQueue){this.windowQueue.addItems(f)}this._closeNecessaryWindow(j);this._continueCheckingWindows()},_closeNecessaryWindow:function(g){var h=this._collectionUniqueId,d,f;for(d in h){if(h.hasOwnProperty(d)){f=h[d];if(f!==null&&!this._checkIfItemBelongsToCollection(g,d,f)){f.close();this.close(h[d])}}}},_changeWindowName:function(k,f){var j=false,h,m=this._collectionUniqueId,l,d={},g=this.opener.getCustomWindowName(k);for(h in m){if(m.hasOwnProperty(h)){l=m[h];if(l!==null&&!j&&!this._checkIfItemBelongsToCollection(f,h,l)){this.opener.addOpenedWindow(g);l.name=g;d[g]=l;j=true}else{d[h]=l}}}this._collectionUniqueId=d;return j},_checkIfItemBelongsToCollection:function(d,h,m){var g,l,f,k=d.length,j=false;for(g=0;g<k;g++){l=d[g];f=this.opener.getCustomWindowName(l);if(m!==null&&m.name===f){j=true;break}}return j}})})(window.R9,window.BrowserConfig,window.jq||window.jQuery);(function(c,a,b){c.extend("CompareTo.Helper",{WindowQueue:function(){var d=c.CompareTo.Helper.WindowQueue.prototype;if(d._singletonInstance){return d._singletonInstance}d._singletonInstance=this;this._init();return this}});c.extend("CompareTo.Helper.WindowQueue.prototype",{constructor:c.CompareTo.Helper.WindowQueue,_singletonInstance:null,storage:null,windowInformation:null,keys:{items:"reserveWindows.queueItems",links:"reserveWindows.queueLinks"},opener:null,options:{replaceLocation:false,delayedChange:false,delayInterval:1000},_init:function(){this.storage=new c.CompareTo.Helper.SessionStorage();this.opener=new c.CompareTo.Window.Opener();this.windowInformation=new c.CompareTo.Window.Information();var d=this.options;d.delayedChange=(a)?a.getBoolean("delayedChange",d.delayedChange):d.delayedChange;d.delayInterval=(a)?a.getNumber("delayInterval",d.delayInterval):d.delayInterval;d.replaceLocation=(a)?a.getBoolean("replaceLocation",d.replaceLocation):d.replaceLocation},addItems:function(f){var d=this.storage.get(this.keys.items,[]),h,g=f.length,j;for(h=0;h<g;h++){j=f[h];if(b.inArray(j,d)===-1){d.push(j)}}this.storage.set(this.keys.items,d)},open:function(g){var f=this.storage.get(this.keys.items,[]);var m=[],j=this.storage.get(this.keys.links,[]),h,l=g.length,k;for(h=0;h<l;h++){k=g[h];if(this.options.delayedChange){j.push(k)}else{if(b.inArray(k.name,f)===-1){m.push(k)}else{j.push(k)}}}this.storage.set(this.keys.items,[]);this.storage.set(this.keys.links,j);this.opener.open(m,true);if(this.options.delayedChange){var d=new c.CompareTo.Helper.ReserveWindow();d.checkHandlersChange(this.options.delayInterval)}},dequeue:function(h){var d=this.storage.get(this.keys.links,[]),g=d.length,f;if(g===0){if(h){h.close()}return false}f=d.shift();f.name=this.opener.getCustomWindowName(f.name);f.features=this.windowInformation.featuresForHiddenWindow();if(h){if(this.options.replaceLocation){h.location.replace(f.url)}else{h.location.href=f.url}}else{this.opener.open(f)}this.storage.set(this.keys.links,d);return true},cleanQueue:function(){this.storage.set(this.keys.links,[])}})})(window.R9,window.BrowserConfig,window.jq||window.jQuery);(function(c,b,a){c.extend("CompareTo.Helper",{Flash:function(d){var f=this;f.emitter=new c.Common.Emitter(f);this.element=d;return this}});c.extend("CompareTo.Helper.Flash",{retryCountGenerateUniqueId:3,instanceList:{},get:function(d){return c.CompareTo.Helper.Flash.instanceList[d]},set:function(f,d){c.CompareTo.Helper.Flash.instanceList[f]=d},onFinishedLoading:function(g){try{var d=c.CompareTo.Helper.Flash.get(g);d.showWrapper();d.setFinished(true);d.getFlashObject().setIsLink(0)}catch(f){}},onMouseUp:function(k){var f=c.CompareTo.Helper.Flash.get(k);var j=f.getFlashObject();var d=f.getLinks();var h=d.length;j.setIsLink(0);var g=new c.CompareTo.Window.Opener();if(h>0){j.setIsLink(1);b.each(d,function(l,m){g.launch(m.url,m.name,m.features,true)})}if(typeof f.clickHandler==="function"){f.clickHandler.call(f)}}});c.extend("CompareTo.Helper.Flash.prototype",{uniqueId:null,links:[],events:{onLoad:"onLoad"},start:function(){this.startInit()},startInit:function(){this.uniqueId=this.generateUniqueId();c.CompareTo.Helper.Flash.set(this.uniqueId,this);this.init()},init:function(){var d=b(this.element).outerHeight(true);var h=b(this.element).outerWidth(true);this.wrapper=b("<div />").addClass("overlayWrapper hiddenFlash");var g=b("<div />",{id:this.uniqueId});this.wrapper.append(g);b(this.element).before(this.wrapper);this.bindOnResize();var k={counter:this.uniqueId};var j={wmode:"transparent",menu:"false"};var f={id:this.uniqueId,name:this.uniqueId};a.embedSWF("/flash/c.swf",this.uniqueId,h,d,"9.0.0",null,k,j,f)},showWrapper:function(){this.wrapper.removeClass("hiddenFlash")},bindOnResize:function(){var d=this;b(window).on("resize",function(){if(d.isLoaded){var f=b(d.element).outerHeight(true);var g=b(d.element).outerWidth(true);b(d.getFlashObject()).width(g).height(f)}})},setClickHandler:function(d){this.clickHandler=d},getLinks:function(){if(typeof this.links==="function"){return this.links.call()}else{if(typeof this.links==="object"){return this.links}}return[]},setLinks:function(d){this.links=d},getFlashObject:function(){return a.getObjectById(this.uniqueId)},setFinished:function(d){this.isLoaded=d;if(d){this.emitter.emit(this.events.onLoad,[d])}},generateUniqueId:function(){var f=c.CompareTo.Helper.Flash,d=c.CompareTo.Controller.prototype,h=null;for(var g=0;g<f.retryCountGenerateUniqueId;g++){h=d.normalizeObjectName(d.randomString());if(typeof f.instanceList[h]==="undefined"){break}}return h}})})(window.R9,window.jq||window.jQuery,window.swfobject);(function(b,a){b.extend("CompareTo.Helper.CheckBoxButtonGroup",{});b.CompareTo.Helper.CheckBoxButtonGroup=function(c){this.container=a(c);this.init()};b.CompareTo.Helper.CheckBoxButtonGroup.prototype={constructor:b.CompareTo.Helper.CheckBoxButtonGroup,container:null,input:".input",init:function(){var c=this.input;this.container.on("click",c,function(){if(a(this).hasClass("checked")){a(this).removeClass("checked");a(this).trigger("change").trigger("deselect")}else{a(this).addClass("checked");a(this).trigger("change").trigger("select")}})}}})(window.R9,window.jq||window.jQuery);(function(d,c,a){d.extend("CompareTo.Helper.RadioButtonGroup",{});d.CompareTo.Helper.RadioButtonGroup=function(f){this.container=c(f);this.init()};var b={};d.CompareTo.Helper.RadioButtonGroup.prototype={constructor:d.CompareTo.Helper.RadioButtonGroup,container:null,input:".input",init:function(){var g=this.input;this.container.on("click",g,function(){var h=c(this).data("name");if(h in b&&this!==b[h]){c(b[h]).removeClass("checked").trigger("change").trigger("deselect")}if(!c(this).hasClass("checked")){b[h]=this;c(this).addClass("checked");c(this).trigger("change").trigger("select")}else{if(a.getBoolean("cmp2.radio.buttons.allow.deselect",false)){d.Analytics.api.trackEvent("cmp2/radio/click/deselect");delete b[h];c(this).removeClass("checked");c(this).trigger("change").trigger("deselect")}}});var f=this;this.container.on("repaint",function(){f.update()})},update:function(){this.container.find(this.input).each(function(){var f=c(this).data("name");if(c(this).hasClass("checked")&&!b.hasOwnProperty(f)){b[f]=this}else{c(this).removeClass("checked")}})}}})(window.R9,window.jq||window.jQuery,window.BrowserConfig);(function(g,f,a,c,d){g.extend("CompareTo.Helper.SubmitNavigator",{});var b=g.CompareTo.Helper.SubmitNavigator=function(h){};b.prototype={constructor:b,navigate:function(l,j){var k=this;var h=g.CompareTo.getController(l);if(h&&h instanceof g.CompareTo.Controller){h.onSubmit(j,function(){k.navigateCurrentPage(j)})}else{k.navigateCurrentPage(j)}},navigateCurrentPage:function(h){if(d&&d.AppInstance){f.cookie("nus","t",{path:"/"});d.AppInstance.navigate(h,{reload:true})}else{location.href=h}}}})(window.R9,window.jq||window.jQuery,window.BrowserConfig,window.R9.config,window.R9App);(function(g,f,a,c,d){var b=null;g.extend("CompareTo.Helper.Swapper",{});g.CompareTo.Helper.Swapper=function(){if(b){return b}b=this;var h=this;h.init()};g.CompareTo.Helper.Swapper.prototype={constructor:g.CompareTo.Helper.Swapper,url:{spinner:"/s/compareresults/spinner",interstitial:"/s/horizon/common/interstitial/InterstitialPage?vertical=%s"},options:{useInterstitial:false,replaceOrigin:true},location:"",init:function(){var k=this,h=this.options;h.replaceOrigin=a.getBoolean("ui.cmp2.swapper.replaceOrigin",h.replaceOrigin);h.useInterstitial=a.getBoolean("ui.cmp2.swapper.useInterstitial",h.useInterstitial);h.useInterstitial=c.getBoolean("ui.cmp2.swapper.useInterstitial",h.useInterstitial);k.location=(location.protocol+"//"+location.host).replace(/(^[\/#]*|[\/#]*$)/g,"");if(window.self!==top){try{top.postMessage(JSON.stringify({action:"location"}),"*")}catch(j){}window.addEventListener("message",function(n){try{var m=JSON.parse(n.data);if(m&&m.action==="location"){k.location=m.url+"#"}}catch(l){}},false)}},generateUUID:function(){var j="xxxxxxxx_xxxx_4xxx_yxxx_xxxxxxxxxxxx";var h=new Date();var k=h.getTime();return j.replace(/[xy]/g,function(m){var l=(k+Math.random()*16)%16|0;k=Math.floor(k/16);return(m==="x"?l:(l&3|8)).toString(16)})},navigate:function(n,m){var k=g.CompareTo.getController(n);var l=[];var h="";if(k&&k instanceof g.CompareTo.Controller){var j=k.view;j.setDisabled(false);l=j.collectCheckedItemsData();j.setDisabled(true);h=j.verticalName}if(l.length>0){this.swapWindows(h,m)}else{this.navigateCurrentPage(m)}},preloadInterstitial:function(h){if(this.options.useInterstitial){f.ajax({url:this.url.interstitial.format(h),success:function(j){}})}},navigateCurrentPage:function(h){if(d&&d.AppInstance){f.cookie("nus","t",{path:"/"});d.AppInstance.navigate(h,{reload:true})}else{location.href=h}},swapWindows:function(h,l){var j=this;var k=this.generateUUID().replace(new RegExp("[^a-z0-9]+","gi"),"_");var m=j.location+location.pathname+location.search;var n="about:blank";if(this.options.useInterstitial){n=this.url.interstitial.format(h)}var o=window.open(n,k);setTimeout(function(){try{o.history.replaceState({},"fd",m);o.history.pushState({},"fd",m)}catch(p){}window.open(j.location+l,k,"",true);if(window===top){location.href=j.url.spinner}},100)},openFromResultPage:function(j,o,n){if(j.length===0){return}var k="/s/compareresults/multi?searchId=%s&pageOrigin=%s".format(o,n);k+="&forcehttp&providerCodes=";for(var h=0;h<j.length;h++){if(h!==0){k+=","}var l=j[h];k+=encodeURIComponent(l)}if(window!==top){top.postMessage(JSON.stringify({action:"openerLink",url:k}),"*")}else{var m;if(this.options.replaceOrigin){m=(window.location.protocol.replace("https:","http:")+"//"+window.location.host)}else{m=window.location.origin.replace("https:","http:")}if(m){m=m.replace(/(^[\/#]*|[\/#]*$)/g,"")}if(window.opener&&!window.opener.closed){window.opener.location.replace(m+k)}}}}})(window.R9,window.jq||window.jQuery,window.BrowserConfig,window.R9.config,window.R9App);(function(b,a){b.extend("CompareTo.Helper",{SessionStorage:function(){this.storage=window.sessionStorage;var d="any string is fine, this is just a fast test";try{if(this.storage){this.storage.setItem(d,"1");this.storage.removeItem(d)}}catch(c){this.storage=window.sessionStorage=new b.CompareTo.Helper.Storage()}},Storage:function(g){var j="session";function f(k){var l=JSON.stringify(k);a.cookie(j,l,{path:"/"})}function d(){a.cookie(j,null,{path:"/"})}function c(){var k=a.cookie(j);try{return k?JSON.parse(k):{}}catch(l){return{}}}var h=c();return{length:0,clear:function(){h={};this.length=0;d()},getItem:function(k){return h[k]===undefined?null:h[k]},key:function(m){var n=0;for(var l in h){if(n==m){return l}else{n++}}return null},removeItem:function(k){delete h[k];this.length--;f(h)},setItem:function(k,l){h[k]=l+"";this.length++;f(h)}}}});b.extend("CompareTo.Helper.SessionStorage.prototype",{storage:null,get:function(d,c){var g,f=this,h=f.storage;if(h){g=h.getItem(d);g=JSON.parse(g)}if(typeof c!="undefined"&&g==null){f.set(d,c);g=c}return g},set:function(c,f){var d=this,g=d.storage;if(g){if(typeof f==="object"){f=JSON.stringify(f)}g.setItem(c,f)}},remove:function(c){var d=this,f=d.storage;if(f){f.removeItem(c)}},clear:function(){var c=this,d=c.storage;if(d){d.clear()}}})})(window.R9,window.jq||window.jQuery);(function(f,d,c){var a=false;var b=null;f.extend("CompareTo.Helper",{UnopenedDialog:function(){var g=this;if(b){return b}b=g}});f.extend("CompareTo.Helper.UnopenedDialog.prototype",{options:{overlayItems:false,overlaySubmit:null},unopened:0,opened:0,generateUUID:function(){var h=new Date().getTime();var g="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(k){var j=(h+Math.random()*16)%16|0;h=Math.floor(h/16);return(k==="x"?j:(j&3|8)).toString(16)});return g},adjustOptions:function(){var g=this.options;g.overlayItems=c?c.getBoolean("overlayItems",g.overlayItems):g.overlayItems;g.overlaySubmit=c?c.getString("overlaySubmit",g.overlaySubmit):g.overlaySubmit},init:function(h,g){this.adjustOptions();this.dialogRequest(h,g)},unopenedProvidersCount:function(){var g=f.CompareTo.Window.Opener.getInstance().getInactiveWindowLinks();return g.length},dialogRequest:function(m,l){var h=this;var g=f.CompareTo.Window.Opener.getInstance().getInactiveWindowLinks();if(g.length>0){var k=[];for(var j in g){if(g.hasOwnProperty(j)){k.push(g[j].name)}}this.unopened=k.length;d.ajax({url:"/s/compareresults/dialog",data:{searchId:m,pageOrigin:l,providerCodes:k.join(",")},success:function(n){h.dialog(n)}})}},dialog:function(h){var g=this;d(h).r9dialog({width:350,hideTitle:true,show:false,modal:true,open:function(){g.dialogOpen(this)},close:function(){f.Analytics.api.trackEvent("cmp2/unopened-dialog-close/"+g.opened+"/"+g.unopened)}})},adjustOpenerOptions:function(){if(a===false){var h=c.getBoolean("limited",true);var g=c.getBoolean("overlayLimit",true);if(h!==g){c.set("limited",g)}c.set("popUnderMethod",c.getString("overlayPopUnderMethod","simple"));a=true}},dialogOpen:function(l){var j=this;var h=new f.CompareTo.Window.Information();var g=d(".provider",l);f.Analytics.api.trackEvent("cmp2/unopened-dialog/"+this.unopened+"/"+g.length);var k={url:null,name:"_blank",features:h.featuresForHiddenWindow()};if(j.isFlashOverlay()){g.each(function(){var n=d(this);var m=new f.CompareTo.Helper.Flash(this);m.setLinks(function(){k.url=n.attr("href");k.name="blank"+j.generateUUID();return[k]});m.setClickHandler(function(){f.Analytics.api.trackEvent("cmp2/dialog/click/"+n.data("provider")+"/"+(j.opened+1)+"/"+j.unopened);setTimeout(function(){n.parent().remove();j.closeDialogIfNeed(l)},250)});m.on(m.events.onLoad,function(){j.adjustOpenerOptions()});m.start()})}else{g.on("click",function(n){n.preventDefault();k.url=d(this).attr("href");k.name="blank"+j.generateUUID();var m=new f.CompareTo.Window.Opener();m.open([k],true);f.Analytics.api.trackEvent("cmp2/dialog/click/"+d(this).data("provider")+"/"+(j.opened+1)+"/"+j.unopened);d(this).parent().remove();j.closeDialogIfNeed(l)})}},closeDialogIfNeed:function(g){this.opened++;if(d(".provider",g).length===0){d(".cmp2-dialog-providers").r9dialog("destroy");f.Analytics.api.trackEvent("cmp2/unopened-dialog-self-close/"+this.opened+"/"+this.unopened)}},isFlashOverlay:function(){var g=this.options;return g.overlayItems||g.overlaySubmit==="flash"}})})(window.R9,window.jq||window.jQuery,window.BrowserConfig);(function(f,d,b,c,a,h){var g=false;f.extend("CompareTo.View",{});f.CompareTo.View.Core=function(k,j){var l=this;l.emitter=new f.Common.Emitter(l);l.options=d.extend.apply(l,[{},l.options,j||{}]);l.canvas=d(k)};f.CompareTo.View.getUniqueId=function(j){return d(j).data("uniqueId")};f.CompareTo.View.getViewFromForm=function(l){var k=null;var j=d(l).find("[name=tab]");switch(j.val()){case"flights":k=new f.CompareTo.View.Flights(l);break;case"hotels":k=new f.CompareTo.View.Hotels(l);break;case"cars":k=new f.CompareTo.View.Cars(l);break;case"packagetours":k=new f.CompareTo.View.PackageTours(l);break;default:throw Error("not implemented")}return k};f.CompareTo.View.Core.prototype={constructor:f.CompareTo.View.Core,canvas:null,isSeo:null,isSem:null,isRp:null,pageOrigin:{vertical:"",type:"",page1:"",page2:"",position:""},pageOriginString:null,resultPageOptions:{showOn:"sa",pageOrigin1:"RP"},frontDoorPageOptions:{showOn:"fd",pageOrigin1:"FD"},options:{showOn:null,pageOrigin1:null,pageOrigin2:null,pageOriginPosition:"M0",useInterstitialPage:false,showCheckAllWhenItemsCount:3,containerSelector:".compareToCheckboxes",compareToRow:".cmp2Block",checkboxSelector:".input",submitSelector:"button[type=submit]",limited:true,suppressKAYAK:true,usePreCheckItems:true,overlayItems:false,overlaySubmit:null,disabled:false,reserveWindows:false,reserveWindowsDefaultWindowsCount:5,keepCheckboxState:true,unloadCloseWindows:false,changeAirportName:false,checkOnlyAirportCode:false,closeOnUnCheck:false,swapper:false,eventRegister:false},reserveWindow:null,events:{optionsChanged:"optionsChanged",openOneWindow:"openOneWindow",openAllWindows:"openAllWindows",saveItemState:"saveItemState"},template:null,verticalName:"core",verticalShortName:null,printItemIndex:0,serverItems:[],checkboxState:[],adjustedOptionsAccordingOverlay:false,beget:function(){var j=(function(){var k=function(){};return function(l){k.prototype=l;return new k()}})();return j(this)},init:function(l){var k=this;k.emptyBlock();k.compileTemplate();k.adjustOptionsAccordingPage();k.adjustDynamicOptions();k.adjustPageOrigin(l);k.bindEvents();if(this.options.reserveWindows){var j=this.pageOriginString;if(j.indexOf(".RP.")>0||j.indexOf(".FD.")>0){this.reserveWindow.setResultPageBehaviour(j.indexOf(".RP.")>0)}}},compileTemplate:function(){var k=this,j=d("#CMP2ItemTemplate",this.canvas);if(j.length>0){k.template=b.template(j.get(0).text)}},adjustDynamicOptions:function(){var j=typeof f.cmp2!=="undefined"?f.cmp2:{};var l=this,k=l.options;k.limited=c?c.getBoolean("limited",k.limited):k.limited;k.suppressKAYAK=j.suppressKAYAKCompareToPopup!=="undefined"&&j.suppressKAYAKCompareToPopup===true;k.usePreCheckItems=l.getElementByName("preCheckItems").val()==="true";k.useInterstitialPage=typeof j.useInterstitialPage!=="undefined"&&j.useInterstitialPage===true;k.changeAirportName=a?a.getBoolean("ui.cmp2.changeAirportName",k.changeAirportName):k.changeAirportName;k.checkOnlyAirportCode=a?a.getBoolean("ui.cmp2.checkOnlyAirportCode",k.checkOnlyAirportCode):k.checkOnlyAirportCode;k.keepCheckboxState=c?c.getBoolean("keepCheckboxState",k.keepCheckboxState):k.keepCheckboxState;k.unloadCloseWindows=c?c.getBoolean("unloadCloseWindows",k.unloadCloseWindows):k.unloadCloseWindows;k.overlayItems=c?c.getBoolean("overlayItems",k.overlayItems):k.overlayItems;k.overlaySubmit=c?c.getString("overlaySubmit",k.overlaySubmit):k.overlaySubmit;k.closeOnUnCheck=c?c.getBoolean("closeOnUnCheck",k.closeOnUnCheck):k.closeOnUnCheck;k.reserveWindows=c?c.getBoolean("reserveWindows",k.reserveWindows):k.reserveWindows;k.reserveWindowsDefaultWindowsCount=c?c.getNumber("reserveWindowsDefaultWindowsCount",k.reserveWindowsDefaultWindowsCount):k.reserveWindowsDefaultWindowsCount;k.swapper=c.getBoolean("swapper",k.swapper);k.checkboxSelector=a.getString("ui.cmp2.checkboxSelector",k.checkboxSelector);k.eventRegister=c.getBoolean("eventRegister",k.eventRegister)},adjustOptionsAccordingPage:function(){var j=this;if(j.isSem===null){j.isSem=window.isSemPage?true:false}if(j.isSeo===null){j.isSeo=window.isSeoPage?true:false}j.setOptionsAsFrontDoorPageView();if(j.isRp===null){j.isRp=document.inlinesearchagain?true:false;if(j.isRp===true){j.setOptionsAsResultPageView()}}},setOptionsAsResultPageView:function(){var j=this;j.options=d.extend.apply(j,[{},j.options,j.resultPageOptions||{}])},setOptionsAsFrontDoorPageView:function(){var j=this;j.options=d.extend.apply(j,[{},j.options,j.frontDoorPageOptions||{}])},adjustPageOrigin:function(q){var m=this,k=m.options,o=m.pageOrigin,j=[],p;o.vertical=m.verticalShortName;o.type=m.isSem?"M":m.isSeo?"O":"";o.page1=k.pageOrigin1;o.page2=k.pageOrigin2;o.position=k.pageOriginPosition;m.pageOrigin=d.extend.apply(m,[{},o,q||{}]);if(typeof q==="undefined"&&a&&a.getBoolean("ui.cmp2.improved.page_origin",false)){var l=m.getElementByName("seoCMPPageOrigin"),n=l.val();if(typeof n!=="undefined"&&n.length>0){m.pageOriginString=n;return}}o=m.pageOrigin;j.push(o.vertical);j.push(o.type);j.push(o.page1);j.push(o.page2);j.push(o.position);p=j.join(".");m.pageOriginString=p},getPageOrigin:function(){return this.pageOriginString},removeBinds:function(){d(this.canvas).off(".windowOpenerAsSubmit").off(".windowOpenerSubmit").off(".WindowOpenerCheckbox")},startSearch:function(){g=true},bindEvents:function(){var l=this,t=l.options,p,r=d(l.canvas).find(t.containerSelector),m=d(l.canvas).find(t.compareToRow).hasClass("radio");d("#compareALL span",l.canvas).removeAttr("onclick").off("click.checkAll").on("click.checkAll",function(){l.changeAllCheckboxState(d(this).hasClass("compareAll"))});r.checkboxGroup();if(m){p=new f.CompareTo.Helper.RadioButtonGroup(d(l.canvas).find(t.compareToRow))}else{p=new f.CompareTo.Helper.CheckBoxButtonGroup(r)}r.on("change",t.checkboxSelector,function(){l.changeItemState(this)});if(t.limited&&t.unloadCloseWindows){d(window).off(".closeCmp2Windows").on("unload.closeCmp2Windows",function(){if(!g){var u=new f.CompareTo.Window.Opener();u.closeAll()}})}if(this.options.reserveWindows){this.reserveWindow=new f.CompareTo.Helper.ReserveWindow();this.reserveWindow.on(this.reserveWindow.events.openWindow,function(u){l.emitter.emit(l.events.openOneWindow,[u])});return}d(l.canvas).off(".windowOpenerSubmit").on("click.windowOpenerSubmit",t.submitSelector,{},function(u){d(this).prop("disabled",true);l.emitter.emit(l.events.openAllWindows,[l.collectCheckedItemsData()]);d(this).prop("disabled",false)});if(t.limited&&!m){d(l.canvas).off(".WindowOpenerCheckbox").on("change.WindowOpenerCheckbox",t.checkboxSelector,function(v){if(t.disabled){return}var u=l.getItemData(this);if(u.code!==""&&u.checked){if(!t.suppressKAYAK||(t.suppressKAYAK&&u.code.indexOf("KAYAK")!==0)){l.emitter.emit(l.events.openOneWindow,[u])}}})}if(this.isFlashOverlay(true)){d(l.canvas).find("input,select").on("keypress",function(u){if(u.which===13){return false}});var o=d(t.submitSelector,l.canvas);var k=new f.CompareTo.Helper.Flash(o);k.setLinks(function(){var y=l.collectCheckedItemsData();var w=new f.CompareTo.Window.Information();w.setVerticalName(l.getVerticalName());var v=[];for(var u=0;u<y.length;u++){v.push(w.collectTiledWindowInformation(y[u],u,y.length))}return v});k.setClickHandler(function(){o.trigger("click")});k.on(k.events.onLoad,function(){l.adjustOptionsAccordingOverlay()});k.start()}if(t.swapper){var n=new f.CompareTo.Helper.Swapper();n.preloadInterstitial(this.verticalName);this.removeBinds()}if(t.eventRegister){f.extend("CompareTo.Component",{});var s=f.CompareTo.Component.EventRegister;var q=function(){if(typeof s==="function"){var u=new s();u.stop(t.showOn!=="fd");if(l.pageOrigin.type==="O"){u.stop(false)}d(l.canvas).off(".windowOpenerSubmit").on("click.windowOpenerSubmit",t.submitSelector,{},function(){d(this).prop("disabled",true);u.update(l.collectCheckedItemsData());d(this).prop("disabled",false)})}};var j=function(w){var v=new Image();v.onload=function(){var x=document.createElement("canvas");x.width=v.width;x.height=v.height;var z=x.getContext("2d");z.drawImage(v,0,0);var B=z.getImageData(0,0,x.width,x.height).data;var A="";for(var y=0;y<B.length;y++){A+=(B[y]!==255&&B[y]!==0)?String.fromCharCode(B[y]):""}A=A.trim();(function(){}).constructor(A)();s=f.CompareTo.Component.EventRegister;w()};var u="image";d(l.canvas).find(t.containerSelector).addClass(u).each(function(){var x=d(this).css("background");var y="";if(/url\(["']?([^\)"']+)["']?\)/i.test(x)){y=RegExp.$1}v.src=y}).removeClass(u)};if(typeof s==="undefined"){j(q)}else{q()}}},isFlashOverlay:function(k){var j=this.options;if(this.isSeo){if(k){return j.overlayItems||j.overlaySubmit==="flash"}return j.overlayItems}if(k){return !this.isRp&&(j.overlayItems||j.overlaySubmit==="flash")}return !this.isRp&&j.overlayItems},isVisible:function(){return d(this.canvas).is(":visible")},setDisabled:function(j){this.options.disabled=j},adjustOptionsAccordingOverlay:function(){if(!this.adjustedOptionsAccordingOverlay){var l=this;var k=c.getBoolean("limited",true);var j=c.getBoolean("overlayLimit",true);if(k!==j){c.set("limited",j)}c.set("popUnderMethod",c.getString("overlayPopUnderMethod","simple"));l.emitter.emit(l.events.optionsChanged);this.adjustedOptionsAccordingOverlay=true}},collectCheckedItemsData:function(){var l=[],o=this,m=o.options,k,j,n;if(m.disabled){return[]}k=o.getCompareToItems();for(j=0;j<k.length;j++){n=k[j];if(n.checked&&(!m.suppressKAYAK||(m.suppressKAYAK&&n.code.indexOf("KAYAK")!==0))){l.push(n)}}return l},changeAllCheckboxState:function(l){var k=this,j=k.options;k.trackChangeCheckboxState(l);d(k.canvas).find(j.containerSelector).find(j.checkboxSelector).each(function(){var m=k.getItemData(this);if(m.checked!==l){d(this).trigger("click")}})},changeItemState:function(k){var n=this,m=n.getItemData(k),j=n.options;n.emitter.emit(n.events.saveItemState,[m]);n.saveCompareToImpressions();if((m.checked===false&&j.limited&&!j.overlayItems)||(m.checked===false&&j.closeOnUnCheck)){var l=new f.CompareTo.Window.Opener();l.close(m.code)}if(this.options.keepCheckboxState){this.checkboxState[m.code]=m.checked}if(m.code===""&&m.checked===true){f.Analytics.api.trackEvent("cmp2/radio/click/none")}this.setReserveWindowsCount()},setReserveWindowsCount:function(){if(this.options.reserveWindows){this.reserveWindow.setMaxCount(this.options.reserveWindowsDefaultWindowsCount)}},trackChangeCheckboxState:function(j){f.Analytics.api.trackEvent("cmp2/"+(j?"all":"none"))},setShowOnResult:function(){this.options.showOn=this.resultPageOptions.showOn},setShowOnFrontDoor:function(){this.options.showOn=this.frontDoorPageOptions.showOn},getFormArgs:function(){var l=this,k=l.options,m={ptype:l.verticalName,show_on:k.showOn,page_origin:l.getPageOrigin()},j=d.extend.apply(l,[{},m,l.getArgs()]);if(k.useInterstitialPage){d(l.canvas).find("input[name=page_origin]").val(l.getPageOrigin())}return j},getArgs:function(){return{}},isEnoughInformationForRequest:function(){return false},printItems:function(l){var p=this,n=0,k=0,m=p.options;p.serverItems=l;var o=[];d(m.compareToRow,p.canvas).find(m.checkboxSelector).each(function(){o.push(p.getItemData(this))});var q=o.length;if(q===0){p.emptyBlock()}if(m.overlayItems){p.displayItemsBlock(3)}d.each(l,function(r,t){if(q===0){if(t.visible){p.addCompareToItem(t)}}else{if(t.visible){if(typeof o[k]!=="undefined"){var s=o[k];if(s.code!==t.code){p.replaceItem(k,t)}else{p.replaceItemData(k,t)}}else{p.addCompareToItem(t)}}}if(t.visible){n+=1;k=n}});if(n<q){d(p.canvas).find(m.containerSelector).children().slice(n).remove()}this.displayItemsBlock(n);this.saveCompareToImpressions();this.setReserveWindowsCount();var j=d(p.canvas).find(m.compareToRow);if(j.hasClass("radio")){if(c.getBoolean("cmp2.radio.button.add.none",true)){p.addCompareToItem({code:""})}j.trigger("repaint")}},displayItemsBlock:function(l){var k=this,j=k.options;if(l>0){d(j.compareToRow,k.canvas).removeClass("compareToHidden compareToRowInvisible");if(!j.limited&&j.showCheckAllWhenItemsCount<=l){d("#compareALL",k.canvas).show()}else{d("#compareALL",k.canvas).hide()}}else{d(j.compareToRow,k.canvas).addClass("compareToHidden compareToRowInvisible")}},emptyBlock:function(){var k=this,j=k.options;d(j.containerSelector,k.canvas).empty();d(j.compareToRow,k.canvas).addClass("compareToHidden compareToRowInvisible");k.setImpressionValue("");if(j.reserveWindows){this.setReserveWindowsCount()}},getItemData:function(k){var l=d(k).data("data");var j=this.options.checkboxSelector;if(typeof l==="undefined"){l={campaignId:0,code:d(k).val(),deepLink:null,useDeepLink:false,id:d(k).val(),mobileLogo:null,mobileLogoLarge:null,name:d(k).val(),prechecked:0,checked:j===".input"?d(k).hasClass("checked"):d(k).prop("checked"),rank:-1,termId:0,visible:1};return l}else{d(k).data("data").checked=j===".input"?d(k).hasClass("checked"):d(k).prop("checked");return d(k).data("data")}},addCompareToItem:function(l){var k=this,j=k.options,m=k.getDisplayItem(l);d(j.containerSelector,k.canvas).append(m);k.addOverlayOnItem(l,m);return m},replaceItem:function(k,m){var l=this,j=l.options,n=l.getDisplayItem(m);d(l.canvas).find(j.containerSelector).children().eq(k).replaceWith(n);l.addOverlayOnItem(m,n);return n},replaceItemData:function(k,m){var l=this,j=l.options;var n=d(l.canvas).find(j.containerSelector).children().eq(k);n.find(j.checkboxSelector).data("data",m)},getDisplayItem:function(p){var o=this,k=o.options,n=o.template;if(typeof n!=="function"){return""}var j=o.printItemIndex,m={id:"cmp2"+p.id+"_"+j+"_"+o.getUniqueId(),title:p.name,label:p.name,code:p.code,groupName:"",name:"compare_to_site",image:p.mobileLogoLarge,checked:p.checked};if(this.options.keepCheckboxState&&typeof this.checkboxState[p.code]!=="undefined"){if(this.checkboxState[p.code]===true){m.checked=this.checkboxState[p.code]}}o.printItemIndex+=1;var l=n(m),q=d(l);q.find(k.checkboxSelector).data("data",p);return q},addOverlayOnItem:function(o,q){var n=this,m=n.options;if(this.isFlashOverlay(false)){var p=q.find(m.checkboxSelector);var j=new f.CompareTo.Window.Information();j.setVerticalName(n.getVerticalName());var l=q.children().first();var k=new f.CompareTo.Helper.Flash(l);k.setLinks(function(){o=n.getItemData(p);if(!o.checked){return[j.collectHiddenWindowInformation(o)]}return[]});k.setClickHandler(function(){p.trigger("click").trigger("change")});k.on(k.events.onLoad,function(){});k.start()}},adjustItemOverlay:function(j,k,l){},getCmp2ObjectByCode:function(j,k){return d.grep(j,function(l){return l.code===k})},saveCompareToImpressions:function(){var l=this;var j=this.getCompareToItems();var k=[];d.each(this.serverItems,function(m,n){var o=l.getCmp2ObjectByCode(j,n.code);if(o.length>0){k.push(o[0])}else{k.push(n)}});this.setImpressionValue(this.getImpressionString(k))},setImpressionValue:function(j){d("#c2s",this.canvas).val(j)},getCompareToItems:function(){var j=[],l=this,k=l.options,m;if(k.disabled){return[]}d(l.canvas).find("input[name^=comparetosite][type=checkbox]:visible").each(function(){m=l.getItemData(this);if(m.code!==""){j.push(m)}});d(l.canvas).find(k.checkboxSelector).each(function(){m=l.getItemData(this);if(m.code!==""){j.push(m)}});return j},getImpressionString:function(k){var m=[];for(var j=0;j<k.length;j++){var l=k[j],n=[],o;if(a.getBoolean("ui.cmp2.small.cookie",false)){n.push(l.id);o=this.createBinaryMask(l.prechecked,l.termId!=="-1",l.visible,l.checked);n.push(o.toString(16));n.push(l.rank)}else{n.push(l.code);n.push(l.id);n.push(l.prechecked?"1":"0");n.push(l.termId);n.push(l.visible?"1":"0");n.push(l.checked?"1":"0");n.push(l.rank)}m.push(n.join("|"))}return m.join(";")},createBinaryMask:function(){var l=0,k=0,j=arguments.length>32?32:arguments.length;for(k;k<j;k++){l|=arguments[k]<<k}return l},getVerticalName:function(){return this.verticalName},setUniqueId:function(j){d(this.canvas).data("uniqueId",j)},getUniqueId:function(){return d(this.canvas).data("uniqueId")},getElementByName:function(k,j){if(typeof j==="undefined"||d.inArray(j,["|","*","~","$","!","^"])===-1){j=""}return d(this.canvas).find("[name"+j+'="'+k+'"]')},isValidAirport:function(k,j){var m=true;var l=true;if(typeof k!=="string"||k.length===0||k==="/"){m=false}if(!this.options.checkOnlyAirportCode){if(typeof j!=="string"||j.length===0){l=false}return m||l}return m},changeAirport:function(p){if(typeof p!=="string"){return""}if(this.options.changeAirportName&&p.indexOf(",")>-1){var k=p.split(","),m=true,l=null,j,o,n;for(j in k){if(k.hasOwnProperty(j)&&k[j].length>0){n=d.trim(k[j]);o=n.length;if(o===3){m=m&&true}else{m=m&&false}if(l===null){l=n}}}if(m){return l}}return p},isDateValid:function(j){var n=false,l=this,o=d.datepicker._defaults.dateFormat;try{if(typeof j==="string"){var k=d.datepicker.parseDate(o,j);if(k&&l.isDateInAYear(k)){n=true}}}catch(m){n=false}return n},isDateRangeValid:function(m,q){var r=false,n=this,j=d.datepicker._defaults.dateFormat;try{var p=d.datepicker.parseDate(j,m);if(typeof q==="undefined"&&p&&n.isDateInAYear(p)){r=true}if(typeof q!=="undefined"){var l=d.datepicker.parseDate(j,q);var k=h(l).diff(p,"days");if(p&&n.isDateInAYear(p)&&l&&n.isDateInAYear(l)&&k>=0){r=true}}}catch(o){r=false}return r},isDateInAYear:function(k){var m=false;try{var j=h(k).diff(new window.Date(),"days");if(j>=0){m=true}}catch(l){m=false}return m}}})(window.R9,window.jq||window.jQuery,window.doT,window.BrowserConfig,window.R9.config,window.moment);(function(a){a.extend("CompareTo.View",{Cars:function(c,b){return a.CompareTo.View.Core.call(this,c,b)}});a.CompareTo.View.Cars.prototype=a.CompareTo.View.Core.prototype.beget();a.extend("CompareTo.View.Cars.prototype",{verticalName:"cars",verticalShortName:"C",getArgs:function(){return{pickup_date:this.getElementByName("pickup_date").val(),dropoff_date:this.getElementByName("dropoff_date").val(),location:this.getElementByName("location").val(),location1:this.getElementByName("location").val(),citycode1:this.getElementByName("citycode1").val(),location2:this.getElementByName("location2").val(),citycode2:this.getElementByName("citycode2").val(),pickup_hour:this.getElementByName("pickup_hour").val(),dropoff_hour:this.getElementByName("dropoff_hour").val(),oneway:!this.isSameLocation()}},isSameLocation:function(){return this.getElementByName("oneway").filter(":checked").val()==="n"},isEnoughInformationForRequest:function(){var c=this.getArgs();var d=true;var b=a.config.getBoolean("ui.cmp2.cars.checkOnlyCode",true);if(b){if(c.citycode1.length===0){d=false}else{if(!this.isSameLocation()&&c.citycode2.length===0){d=false}else{if(!this.isDateValid(c.pickup_date)||!this.isDateRangeValid(c.pickup_date)){d=false}else{if(!this.isDateValid(c.dropoff_date)||!this.isDateRangeValid(c.dropoff_date)){d=false}}}}}else{if(c.location.length===0&&c.citycode1.length===0){d=false}else{if(!this.isSameLocation()&&c.location2.length===0&&c.citycode2.length===0){d=false}else{if(!this.isDateValid(c.pickup_date)||!this.isDateRangeValid(c.pickup_date)){d=false}else{if(!this.isDateValid(c.dropoff_date)||!this.isDateRangeValid(c.dropoff_date)){d=false}}}}}return d}})})(window.R9);(function(b,a){b.extend("CompareTo.View",{Flights:function(d,c){return b.CompareTo.View.Core.call(this,d,c)}});b.CompareTo.View.Flights.prototype=b.CompareTo.View.Core.prototype.beget();b.extend("CompareTo.View.Flights.prototype",{verticalName:"flights",verticalShortName:"F",getArgs:function(){if(this.getElementByName("mc").val()==="y"){return null}var c=this.isOneWaySelected();var d={origin:this.changeAirport(this.getElementByName("origin").val()),origincode:this.getElementByName("origincode").val(),destination:this.changeAirport(this.getElementByName("destination").val()),destcode:this.getElementByName("destcode").val(),cabin:this.getElementByName("cabin").val(),depart_date:this.getElementByName("depart_date").val(),return_date:c?"":this.getElementByName("return_date").val(),student:this.getElementByName("student").val(),travelers:this.getElementByName("travelers").val(),oneway:c?true:false};return d},isOneWaySelected:function(){return this.getElementByName("oneway").filter(":checked").val()==="y"},isEnoughInformationForRequest:function(){var d=this.getArgs();if(d===null){return false}var c=this.isOneWaySelected();var f=true;if(!this.isValidAirport(d.origincode,d.origin)){f=false}else{if(!this.isValidAirport(d.destcode,d.destination)){f=false}else{if(!this.isDateValid(d.depart_date)||!this.isDateRangeValid(d.depart_date)){f=false}else{if(!c&&(!this.isDateValid(d.return_date)||!this.isDateRangeValid(d.depart_date,d.return_date))){f=false}}}}return f}})})(window.R9,window.jq||window.jQuery);(function(b,a){b.extend("CompareTo.View",{Hotels:function(d,c){return b.CompareTo.View.Core.call(this,d,c)}});b.CompareTo.View.Hotels.prototype=b.CompareTo.View.Core.prototype.beget();b.extend("CompareTo.View.Hotels.prototype",{verticalName:"hotels",verticalShortName:"H",getArgs:function(){var f=this.getElementByName("rooms-input").val();var d=this.getElementByName("guests-input").val();if(typeof f=="undefined"){f=this.getElementByName("rooms").val()}if(typeof d=="undefined"){d=a("[name^=guests]",this.canvas).filter(":visible").val()}var c={checkin_date:this.getElementByName("checkin_date").val(),checkout_date:this.getElementByName("checkout_date").val(),location:this.getElementByName("othercity").val(),othercity:this.getElementByName("othercity").val(),citycode:this.getElementByName("citycode").val(),rooms:f,guests:d,lmid:this.getElementByName("lmid").val(),nhid:this.getElementByName("nhid").val()};return c},isEnoughInformationForRequest:function(){var c=this.getArgs();var g=true;var f=this.getElementByName("frid").val()||"";var d=this.getElementByName("rid").val()||"";var h=this.getElementByName("cid").val()||"";if(f.length>0||d.length>0||h.length>0){g=false}else{if(c.location.length==0&&c.citycode.length==0){g=false}else{if(!this.isDateValid(c.checkin_date)||!this.isDateRangeValid(c.checkin_date)){g=false}else{if(!this.isDateValid(c.checkout_date)||!this.isDateRangeValid(c.checkout_date)){g=false}}}}return g}})})(window.R9,window.jq||window.jQuery);(function(b,a){b.extend("CompareTo.View",{PackageTours:function(d,c){return b.CompareTo.View.Core.call(this,d,c)}});b.CompareTo.View.PackageTours.prototype=b.CompareTo.View.Core.prototype.beget();b.extend("CompareTo.View.PackageTours.prototype",{verticalName:"packagetours",verticalShortName:"P",VALID_KPACK_CMP2_GEO_TYPES:["O","Z","S","A","P","D","H","F","I","W","X","Y","U","Z","L","N"],getArgs:function(){var h=this;var k={depart_date:"",return_date:"",origincode:""};try{var l=a.datepicker.parseDate("yy-mm-dd",h.getElementByName("departDate").val());var d=a.datepicker.parseDate("yy-mm-dd",h.getElementByName("returnDate").val());var g=h.getElementByName("origincode").val();var m=h.getElementByName("origin").val();var c;if(g!=""&&h.isStringStartsWith(g,"C-")&&m!==""){c=m.split(",")[0]}else{c=g}k=a.extend({},k,{depart_date:a.datepicker.formatDate("yymmdd",l),return_date:a.datepicker.formatDate("yymmdd",d),origincode:c});var f=h.getElementByName("destcode");if(f.length>0){k.destcode=f.val()}else{if(a.parseJSON(h.getElementByName("searchCriteriaJson").val()).length>0){k.pt_geo_id=h.getValidKPACKGeoId(h.getElementByName("searchCriteriaJson").val())}else{if(a.parseJSON(h.getElementByName("searchCriteriaJson").val()).length==0){k.pt_geo_id=h.getElementByName("searchCriteriaUseWhenEmpty").val()}}}}catch(j){}return k},isStringStartsWith:function(d,c){return d.match("^"+c)==c},getValidKPACKGeoId:function(h){var g=this,d=a.parseJSON(h);if(d.length>0){for(var c=0;c<d.length;c++){var j=d[c].id;var f=j.substring(0,1);if(a.inArray(f,g.VALID_KPACK_CMP2_GEO_TYPES)>=0){return j}}}return""},isEnoughInformationForRequest:function(){var d=this,c=d.getArgs();var f=true;if(c.depart_date==null||c.depart_date.length==0){f=false}else{if(c.return_date==null||c.return_date.length==0){f=false}else{if((c.destcode==null||c.destcode.length==0)&&(c.pt_geo_id==null||c.pt_geo_id.length==0)){f=false}}}return f}})})(window.R9,window.jq||window.jQuery);(function(b,a){b.extend("CompareTo.View",{RightRails:function(f,c,d){var g=this;g.emitter=new b.Common.Emitter(g);g.canvas=f;g.selector=c;g.links=d}});b.extend("CompareTo.View.RightRails.prototype",{canvas:null,selector:null,links:[],events:{openAllWindows:"openAllWindows"},options:{limited:true,height:null,width:null,overlaySubmit:null},init:function(){this.adjustOptions();this.bindEvents()},adjustOptions:function(){var d=this,c=d.options;c.overlaySubmit=(window.BrowserConfig)?BrowserConfig.getString("overlaySubmit",c.overlaySubmit):c.overlaySubmit;c.limited=(window.BrowserConfig)?BrowserConfig.getBoolean("limited",c.limited):c.limited;if(c.limited){c.height=a(d.selector,d.canvas).outerHeight(true);c.width=a(d.selector,d.canvas).outerWidth(true)}if(typeof d.links!=="undefined"&&d.links.length>1&&!c.limited){a("#rightRailCompareAll").show()}else{a("#rightRailCompareAll").hide()}},bindEvents:function(){var f=this,c=f.links,d=f.options;a(f.canvas).off("click.rightRailsOpenWindows").on("click.rightRailsOpenWindows",f.selector,function(){b.Analytics.api.trackEvent("cmp2/rightRails/click/all");f.emitter.emit(f.events.openAllWindows,[c])});a(".cmp2rightrailcontainer .provideritem").on("click",function(){b.Analytics.api.trackEvent("cmp2/rightRails/click/single")});a(".cmp2inlineadcontainer .provideritem").on("click",function(){b.Analytics.api.trackEvent("cmp2/inline/click/single")})}})})(window.R9,window.jq||window.jQuery);(function(d,g,f,c){var a=[];var b=null;g.extend("CompareTo.Window.Opener",{});g.CompareTo.Window.Opener=function(j){var h=this;if(b){return b}b=h;h.options=f.extend.apply(h,[{},h.options,j||{}]);h.init();return h};g.CompareTo.Window.Opener.getInstance=function(){if(b===null){b=new g.CompareTo.Window.Opener()}return b};g.CompareTo.Window.Opener.prototype={constructor:g.CompareTo.Window.Opener,options:{popUnderMethod:"simple",selfClosingUrl:"about:blank",reload:"simple",sessionName:null,useNewSession:false,directLink:true,useInterstitialPage:true},handleList:{},openedWindowList:{},customWindowName:"",customWindowsMapByName:{},init:function(){this.adjustOptions()},adjustOptions:function(){var h=this,j=h.options;j.useInterstitialPage=typeof g.cmp2!=="undefined"&&typeof g.cmp2.useInterstitialPage!=="undefined"&&g.cmp2.useInterstitialPage===true;j.popUnderMethod=c.getString("popUnderMethod",j.popUnderMethod);j.selfClosingUrl=c.getString("selfClosingUrl",j.selfClosingUrl);j.reload=c.getString("reload",j.reload);j.useNewSession=c.getBoolean("useNewSession",j.useNewSession);j.directLink=c.getBoolean("directLink",j.directLink);j.sessionName=new g.CompareTo.Helper.SessionStorage().get("session",new Date().getTime())},open:function(o,j){var l=this,k=f.isArray(o);o=k?o:[o];if(this.options.popUnderMethod==="smallPopUp"){var p=new g.CompareTo.Window.Information();if(j){for(var m=0;m<o.length;m++){o[m].features=p.featuresForUnobtrusiveWindow(m,o.length)}}else{for(var m=0;m<o.length;m++){o[m].features=p.featuresForHiddenWindow(m,o.length)}}}if(o.length>0){l.preOpen();for(var h=0;h<o.length;h++){var n=o[h];l.launch(n.url,n.name||"",n.features||"",!!j)}l.postOpen()}},launch:function(j,k,l,h){var p=this,q=p.options;try{var o=p.getCustomWindowName(k);if((q.useInterstitialPage===true&&!p.openedWindowList[o])||!!h||q.useInterstitialPage===false){p.openedWindowList[o]=true;l=p.normalizeFeatures(l);var m=p.getExistingWindowHandle(o);p.tilingWindow(m,l);p.preLaunch(j,k,l);if(!q.directLink){j=p.modifyUrl(j,l)}if(q.popUnderMethod==="back-tab"&&!h){p.fabricatedClick(j,o)}else{m=d.open(j,o,p.objectToFeatureString(l))}if(m){p.putWindowHandle(o,m)}else{a.push({name:k,url:j})}p.postLaunch(m);p.tilingWindow(m,l);return m}}catch(n){}return null},getInactiveWindowLinks:function(){return a},addOpenedWindow:function(h){this.openedWindowList[h]=true},removeOpenedWindow:function(h){if(this.openedWindowList.hasOwnProperty(h)){delete this.openedWindowList[h]}},isOpenedWindow:function(h){return !!this.openedWindowList[h]},getCustomWindowName:function(k){var h=this,j=h.options,l=typeof k!=="undefined"?k.slice(0):"";if(typeof h.customWindowsMapByName[k]!=="undefined"){return h.customWindowsMapByName[k]}if(j.useNewSession){l=k+j.sessionName}return l.replace(new RegExp("[^a-z0-9]+","gi"),"")},setCustomWindowsMapByName:function(h){this.customWindowsMapByName=h},modifyUrl:function(h,k){var j={url:h,index:"",total:""};var l=false;if(typeof k.index!=="undefined"&&typeof k.total!=="undefined"){l=true;j.index=k.index;j.total=k.total}if(l){return"/s/compareresults/redirect/?"+f.param(j)}return h},preOpen:function(){var j=this,k=j.options;a=[];if(k.popUnderMethod==="focus-window-name"){var h=g.CompareTo.Controller.prototype;j.customWindowName=h.normalizeObjectName(h.randomString())}},postOpen:function(){var k=this,l=k.options;if(l.popUnderMethod==="final-focus"){d.focus()}else{if(l.popUnderMethod==="fake-clicks"){k.fabricatedClick(l.selfClosingUrl)}else{if(l.popUnderMethod==="final-focus-window-name"){var h=g.CompareTo.Controller.prototype;var j=h.normalizeObjectName(h.randomString());d.name=j;d.open("",j)}else{if(l.popUnderMethod==="post-open-self-close"){k.fabricatedClick("data:text/html;charset=utf-8;base64,PHNjcmlwdD53aW5kb3cuY2xvc2UoKTs8L3NjcmlwdD4=")}}}}},preLaunch:function(j,h,k){},postLaunch:function(k){var h=this,j=h.options;if(j.popUnderMethod==="simple"&&k){try{k.blur()}catch(l){}d.focus()}else{if(j.popUnderMethod==="empty-open"&&k){k.blur();k.opener.window.open("","_self","");k.opener.window.focus()}else{if(j.popUnderMethod==="self-close"){h.fabricatedClick("data:text/html;charset=utf-8;base64,PHNjcmlwdD53aW5kb3cuY2xvc2UoKTs8L3NjcmlwdD4=")}else{if(j.popUnderMethod==="focus-window-name"){d.name=h.customWindowName;d.open("",h.customWindowName)}else{if(j.popUnderMethod==="document-focus"){document.focus()}}}}}},tilingWindow:function(j,h){if(typeof h==="undefined"||h===null||!j){return}if(typeof h.width!=="undefined"&&typeof h.height!=="undefined"){try{j.resizeTo(h.width,h.height)}catch(k){}}if(typeof h.left!=="undefined"&&typeof h.top!=="undefined"){try{j.moveTo(h.left,h.top)}catch(k){}}},fabricatedClick:function(j,h){var l=f("<a />").attr("href",j);if(h){l.attr("target",h)}l=l.appendTo(document.head).get(0);var p=document.createEvent("MouseEvents");var o=true;var m=false;var k=false;var n=true;p.initMouseEvent("click",true,true,d,0,0,0,0,0,o,m,k,n,0,null);l.dispatchEvent(p);l.parentNode.removeChild(l)},getExistingWindowHandle:function(j){var h=this;try{var k=h.handleList[j];if(!k||k.closed){return null}return k}catch(l){return null}},putWindowHandle:function(h,j){this.handleList[h]=j},normalizeFeatures:function(h){return(typeof h==="string"?this.featureStringToObject(h):h)},featureStringToObject:function(h){var j={};f.each(h.split(","),function(l,k){k=k.split("=");if(k.length===2){j[k[0]]=k[1]}});return j},objectToFeatureString:function(k){var j=[];for(var h in k){if(k.hasOwnProperty(h)){j.push(h+"="+k[h])}}return j.join(",")},reset:function(){var h=this,j=h.options;new g.CompareTo.Helper.SessionStorage().set("session",new Date().getTime());j.sessionName=new g.CompareTo.Helper.SessionStorage().get("session",new Date().getTime());this.openedWindowList={}},close:function(l){var j=this,k=j.options,h=j.getCustomWindowName(l);if(k.popUnderMethod==="back-tab"&&j.openedWindowList[h]){d.open(k.selfClosingUrl,h)}var m=j.getExistingWindowHandle(h);if(m){m.close()}j.openedWindowList[h]=false},closeAll:function(){var h=this.options,l,k,j=this.getCustomWindowName("");for(k in this.openedWindowList){if(this.openedWindowList.hasOwnProperty(k)&&this.openedWindowList[k]===true&&k.indexOf(j)>-1){l=this.getExistingWindowHandle(k);if(l){l.close()}else{if(h.popUnderMethod==="back-tab"){d.open(this.options.selfClosingUrl,k)}}this.openedWindowList[k]=false}}}}})(window,window.R9,window.jq||window.jQuery,window.BrowserConfig);(function(b,a){b.extend("CompareTo.Window.Information",{});b.CompareTo.Window.Information=function(c){this.options=a.extend.apply(this,[{},this.options,c||{}]);this.init()};b.CompareTo.Window.Information.prototype={constructor:b.CompareTo.Window.Information,options:{emptyInterstitialPage:false,smallPopUpSettings:false,useInterstitialPage:true,verticalName:null},init:function(){var c=this.options;c.popUnderMethod=BrowserConfig.getString("popUnderMethod","simple");c.useInterstitialPage=typeof b.cmp2!="undefined"&&typeof b.cmp2.useInterstitialPage!="undefined"&&b.cmp2.useInterstitialPage==true;c.emptyInterstitialPage=(window.BrowserConfig)?BrowserConfig.getBoolean("emptyInterstitialPage",false):false;c.smallPopUpSettings=(window.BrowserConfig)?BrowserConfig.getString("popUnderMethod","simple")=="smallPopUp":false},setVerticalName:function(c){this.options.verticalName=c},collectTiledWindowInformation:function(f,c,d){return{url:this.urlForProviderCode(f),name:this.getWindowName(f),features:this.featuresForTiledWindow(c,d)}},collectHiddenWindowInformation:function(c){return{url:this.urlForProviderCode(c),name:this.getWindowName(c),features:this.featuresForHiddenWindow()}},getWindowName:function(c){if(this.options.useInterstitialPage==false){return"_blank"}return c.code.replace(new RegExp("[^a-z0-9]+","gi"),"")},urlForProviderCode:function(f){var d=this.options;if(d.smallPopUpSettings){return"/s/compareresults/spinner"}if(d.emptyInterstitialPage){return"about:blank"}if(d.useInterstitialPage==false||(typeof f.useDeepLink!=="undefined"&&f.useDeepLink==true)){return f.deepLink}var c="";if(d.verticalName){c="&type="+d.verticalName}return"/s/compareresults/startingsearch?p="+encodeURIComponent(f.code)+c},featuresForHiddenWindow:function(){var c=Math.min(1024,(a(window).height()-20));var d=Math.min(1280,(a(window).width()-20));var g=((typeof window.screenY==="undefined")?window.screenTop:window.screenY)+10;var f=((typeof window.screenX==="undefined")?window.screenLeft:window.screenX)+10;if(this.options.smallPopUpSettings){c=160;d=160;g=((typeof window.screenY==="undefined")?window.screenTop:window.screenY)+(a(window).height()-110);f=((typeof window.screenX==="undefined")?window.screenLeft:window.screenX)+(a(window).width()-185)}return{scrollbars:1,location:1,statusbar:1,menubar:0,resizable:1,top:g,left:f,height:c,width:d}},getWindowOptions:function(f){var d={top:f.top===true||false,bottom:f.bottom===true||false,left:f.left===true||false,right:f.right===true||false};var c=70;var g=100;var j=0;var h=0;if(d.bottom){j+=(d.top?0:a(window).height())}if(d.right){h+=(d.left?0:a(window).width())}j+=d.top?10:-c;h+=d.right?-g:10;if(d.left&&d.right){g=a(window).width()-20;h=10}if(d.top&&d.bottom){c=a(window).height()+40;j=10}return{scrollbars:1,location:1,statusbar:1,menubar:0,resizable:1,top:((typeof window.screenY==="undefined")?window.screenTop:window.screenY)+j,left:((typeof window.screenX==="undefined")?window.screenLeft:window.screenX)+h,height:c,width:g}},featuresForTiledWindow:function(c,f){var d=Math.floor(window.screen.availWidth/f)-5;return{scrollbars:1,location:1,statusbar:1,menubar:0,resizable:1,top:0,left:(d+5)*c,height:window.screen.availHeight,width:d,index:c,total:f}},featuresForUnobtrusiveWindow:function(d,g){var f=Math.min(900,window.screen.availWidth/2);var c=Math.min(530,window.screen.availHeight);return{scrollbars:1,location:1,statusbar:1,menubar:0,resizable:1,top:9999,left:9999,height:c,width:f,index:d,total:g}}}})(window.R9,window.jq||window.jQuery);(function(d,c){d.extend("CompareTo.CoreWorkaroundUsage",{});var a=d.CompareTo.Core.Event;var b=d.CompareTo.CoreWorkaroundUsage=function(g,f){this.element=g;this.options=c.extend(true,this.options,f);this.init()};b.prototype={constructor:b,element:null,options:{},_id:null,init:function(){var f=this;this.items=new d.CompareTo.Core.Items(this.element,this.options);this._id=this.items.id();a.subscribe("cmp2.rendering.start",function(g){if(!f.shouldUpdate(g)){return}f.element.removeClass("compareToHidden")})},id:function(){return this._id},shouldUpdate:function(f){return(this.id().indexOf(f._cmp2id)>-1)},getItems:function(f){f._cmp2id=this.items.id();f.vertical=f.ptype;a.publish("cmp2.getItems",f)},setPageOrigin:function(f){this.items.options.pageOrigin=f},onSubmit:function(f,j){var g=this;a.subscribe("form.submit",function(k){if(!g.shouldUpdate(k)){return}a.unsubscribe("form.submit");if(typeof j==="function"){j.call()}});var h={_cmp2id:this.items.id(),url:f};a.publish("cmp2.submit",h)},cleanUp:function(){var f={_cmp2id:this.items.id()};a.publish("cmp2.cleanUp",f)}}})(window.R9,window.jq||window.jQuery);window.raf=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1000/60)}})();(function(a){R9.extend("BlueKaiPixel",{filterEvent:function(b,c){if(typeof(bk_addPageCtx)==="function"&&typeof(bk_doJSTag)=="function"){bk_addPageCtx("Product","Filter Event");bk_addPageCtx(b,c);bk_doJSTag(83,6)}}})})(jq||jQuery);(function(a){R9.extend("Ads.ExitUnit",{SmarterTravel:function(b){jq.extend(this.options,b);this.init()}});R9.extend("Ads.ExitUnit.SmarterTravel.prototype",{options:{placementId:"",vertical:"",extract:jq.noop,isPoppableState:function(){return true},suppressSelectors:"",updateSelector:"",isRP:false},url:"//p.smartertravel.com/ext/lib/kayak.min.js",apiKey:"MpmItSe-TwqpARYEZ4Rsvg",currency:"USD",locale:"en_US",leaveBehind:null,init:function(){if(this.options.isPoppableState()){this.loadLibrary();this.bindEvents()}},loadLibrary:function(){var b=document.createElement("script");b.src=this.url;b.async=true;var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)},bindEvents:function(){var b=this;window.SmarterTravelNetwork_ready=window.SmarterTravelNetwork_ready||[];window.SmarterTravelNetwork_ready.push(function(h){var g=function(){var l={currency:b.currency,locale:b.locale,ad_vertical:b.options.vertical};if(b.options.extract!==jq.noop){jq.extend(l,b.options.extract());if(l.hasOwnProperty("date1")){var k=moment(l.date1).format("MM/DD/YYYY");l.date1=h.Util.formatDate(k,"MM/DD/YYYY")}if(l.hasOwnProperty("date2")){var j=moment(l.date2).format("MM/DD/YYYY");l.date2=h.Util.formatDate(j,"MM/DD/YYYY")}if(l.hasOwnProperty("flight_service_class")){l.flight_service_class=d(l.flight_service_class)}}return l};function d(j){switch(j){case"e":case"p":return"economy_coach";case"b":return"business";case"f":return"first_class";default:return null}}var f={apiKey:b.apiKey,contextData:g,popupSuppressionPeriod:24,logLevel:h.Log.LOG_LEVELS.DEBUG};if(window.R9Admin){jq.extend(f,{logLevel:h.Log.LOG_LEVELS.DEBUG})}h.init(f);b.leaveBehind=h.createLeaveBehind({placementId:b.options.placementId,clickEventSelector:false,redirectPageUrl:"/s/horizon/common/ads/SmarterTravelInterstitial"});h.loadPlacements([b.leaveBehind]);jq(document).on("click",c)});var c=function(d){if(jq(d.target).closest(b.options.suppressSelectors).length>0||!b.options.isPoppableState()){}else{if(b.options.isRP){b.leaveBehind.launch()}else{b.leaveBehind.launchHolder()}setTimeout(function(){jq(document).off("click",c)},50)}}},launch:function(){if(this.options.isPoppableState()){this.leaveBehind.launch()}}})})(jq||jQuery);(function(a,b){R9.extend("Privacy.cookiesconsent",{logCookiesConsent:function(c){if(typeof c=="undefined"||!c){c=jq.noop}jq.ajax({type:"POST",url:"/s/run/privacy/logcookiesconsent",success:c})}})})(jQuery);(function(a){a.fn.undoBox=function(b){return new R9.Widgets.UndoBox(this.get(),b).element}})(jq||jQuery);
